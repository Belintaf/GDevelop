{"version":3,"file":"static/js/local-app.45842fdb.chunk.js","mappings":"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","sources":["JsExtensionsLoader/LocalJsExtensionsFinder.js","JsExtensionsLoader/LocalJsExtensionsLoader.js","ResourcesList/LocalEmbeddedResourceSources.js","ResourcesList/LocalResourceSources.js","ResourcesList/LocalResourceExternalEditors.js","Utils/LocalUserInfo.js","ExportAndShare/LocalExporters/LocalFileSystem.js","ExportAndShare/LocalExporters/LocalPreviewLauncher/LocalNetworkPreviewDialog.js","ExportAndShare/LocalExporters/LocalPreviewLauncher/LocalPreviewDebuggerServer.js","ExportAndShare/LocalExporters/LocalPreviewLauncher/index.js","ExportAndShare/LocalExporters/LocalCordovaExport.js","ExportAndShare/LocalExporters/LocalElectronExport.js","ExportAndShare/LocalExporters/LocalHTML5Export.js","UI/LocalFilePicker/index.js","Utils/OptionalLazyRequire.js","Utils/LocalArchiver.js","ExportAndShare/LocalExporters/LocalFacebookInstantGamesExport.js","ExportAndShare/LocalExporters/LocalFileUploader.js","ExportAndShare/LocalExporters/LocalOnlineCordovaExport.js","ExportAndShare/LocalExporters/LocalOnlineCordovaIosExport.js","ExportAndShare/LocalExporters/LocalOnlineElectronExport.js","ExportAndShare/LocalExporters/LocalOnlineWebExport.js","ExportAndShare/LocalExporters/index.js","MainFrame/ElectronMainMenu.js","EventsFunctionsExtensionsLoader/CodeWriters/LocalEventsFunctionCodeWriter.js","EventsFunctionsExtensionsLoader/Storage/LocalEventsFunctionsExtensionWriter.js","EventsFunctionsExtensionsLoader/Storage/LocalEventsFunctionsExtensionOpener.js","Utils/ObjectSplitter.js","ProjectsStorage/LocalFileStorageProvider/LocalProjectOpener.js","ProjectsStorage/LocalFileStorageProvider/LocalProjectWriter.js","ProjectsStorage/LocalFileStorageProvider/LocalProjectResourcesHandler.js","ProjectsStorage/LocalFileStorageProvider/LocalFileResourcesWatcher.js","ProjectsStorage/LocalFileStorageProvider/index.js","GameEngineFinder/LocalGDJSDevelopmentWatcher.js","ProjectsStorage/LocalFileStorageProvider/LocalFileResourceMover.js","Utils/ProcessByChunk.js","Utils/LocalFileUploader.js","ProjectsStorage/ResourceMover/LocalResourceMover.js","ProjectsStorage/ResourceFetcher/LocalResourceFetcher.js","LoginProvider/LocalLoginProvider.js","LocalApp.js"],"sourcesContent":["// Note: this file does not use export/imports nor Flow to allow its usage from Node.js\n\nconst { findGDJS } = require('../GameEngineFinder/LocalGDJSFinder');\nconst optionalRequire = require('../Utils/OptionalRequire');\nconst path = optionalRequire('path');\nconst fs = optionalRequire('fs');\n\nconst checkIfPathHasJsExtensionModule = extensionFolderPath => {\n  return new Promise(resolve => {\n    const jsExtensionModulePath = path.join(\n      extensionFolderPath,\n      'JsExtension.js'\n    );\n    fs.stat(jsExtensionModulePath, (err, stats) => {\n      if (err) {\n        return resolve(null);\n      }\n\n      return resolve(stats.isFile() ? jsExtensionModulePath : null);\n    });\n  });\n};\n\nconst findJsExtensionModules = ({ filterExamples, onFindGDJS }) => {\n  return (onFindGDJS ? onFindGDJS() : findGDJS()).then(({ gdjsRoot }) => {\n    const extensionsRoot = path.join(gdjsRoot, 'Runtime', 'Extensions');\n    console.info(\n      `Searching for JS extensions (file called JsExtension.js) in ${extensionsRoot}...`\n    );\n    return new Promise((resolve, reject) => {\n      fs.readdir(extensionsRoot, (error, extensionFolders) => {\n        if (error) {\n          return reject(error);\n        }\n\n        const filteredExtensionFolders = extensionFolders.filter(folder => {\n          if (!filterExamples) return true;\n\n          return folder.indexOf('Example') === -1;\n        });\n\n        Promise.all(\n          filteredExtensionFolders.map(extensionFolder =>\n            checkIfPathHasJsExtensionModule(\n              path.join(extensionsRoot, extensionFolder)\n            )\n          )\n        ).then(modulePaths => {\n          resolve(modulePaths.filter(modulePath => !!modulePath));\n        }, reject);\n      });\n    });\n  });\n};\n\nmodule.exports = {\n  findJsExtensionModules,\n};\n","// @flow\n// Note: this file does not use export/imports and use Flow comments to allow its usage from Node.js\n\nconst { loadExtension } = require('.');\nconst optionalRequire = require('../Utils/OptionalRequire');\nconst { findJsExtensionModules } = require('./LocalJsExtensionsFinder');\n\n/*flow-include\nimport type {JsExtensionsLoader, TranslationFunction} from '.';\nimport ObjectsEditorService from '../ObjectEditor/ObjectsEditorService';\nimport ObjectsRenderingService from '../ObjectsRendering/ObjectsRenderingService';\n\ntype MakeExtensionsLoaderArguments = {|\n  gd: any,\n  objectsEditorService: typeof ObjectsEditorService,\n  objectsRenderingService: typeof ObjectsRenderingService,\n  filterExamples: boolean,\n  onFindGDJS?: ?() => Promise<{gdjsRoot: string}>\n|};\n\ntype GetExpectedNumberOfJSExtensionModulesArguments = {|\n  filterExamples: boolean,\n|};\n*/\n\n// This value is hardcoded to allow raising an error if the number of JS extensions\n// loaded is different from the expected one, which may lead\n// to projects corruption in the future if the app is still used.\n// If a new extension is added, update this value.\n// Also remember to add the extension in the list of extensions in BrowserJsExtensionsLoader.js\nfunction getExpectedNumberOfJSExtensionModules(\n  { filterExamples } /*: GetExpectedNumberOfJSExtensionModulesArguments*/\n) /*:number*/ {\n  return 29 + (filterExamples ? 0 : 1);\n}\n\n/**\n * Loader that will find all JS extensions declared in GDJS/Runtime/Extensions/xxx/JsExtension.js.\n * If you add a new extension and also want it to be available for the web-app version, add it in\n * BrowserJsExtensionsLoader.js\n */\nmodule.exports = function makeExtensionsLoader(\n  {\n    gd,\n    objectsEditorService,\n    objectsRenderingService,\n    filterExamples,\n    onFindGDJS,\n  } /*: MakeExtensionsLoaderArguments*/\n) /*: JsExtensionsLoader*/ {\n  return {\n    loadAllExtensions: (_ /*: TranslationFunction */) => {\n      return findJsExtensionModules({ filterExamples, onFindGDJS }).then(\n        extensionModulePaths => {\n          return Promise.all(\n            extensionModulePaths.map(extensionModulePath => {\n              let extensionModule = null;\n              try {\n                extensionModule = optionalRequire(extensionModulePath, {\n                  rethrowException: true,\n                });\n              } catch (ex) {\n                return {\n                  extensionModulePath,\n                  result: {\n                    message:\n                      'Unable to import extension. Please check for any syntax error or error that would prevent it from being run.',\n                    error: true,\n                    rawError: ex,\n                  },\n                };\n              }\n\n              if (!extensionModule) {\n                return {\n                  extensionModulePath,\n                  result: {\n                    error: true,\n                    message:\n                      'Unknown error. Please check for any syntax error or error that would prevent it from being run.',\n                  },\n                };\n              }\n\n              if (\n                objectsEditorService &&\n                extensionModule.registerEditorConfigurations\n              ) {\n                extensionModule.registerEditorConfigurations(\n                  objectsEditorService\n                );\n              }\n\n              if (objectsRenderingService) {\n                if (extensionModule.registerInstanceRenderers) {\n                  extensionModule.registerInstanceRenderers(\n                    objectsRenderingService\n                  );\n                }\n                if (extensionModule.registerClearCache) {\n                  extensionModule.registerClearCache(objectsRenderingService);\n                }\n              }\n\n              return {\n                extensionModulePath,\n                result: loadExtension(\n                  _,\n                  gd,\n                  gd.JsPlatform.get(),\n                  extensionModule\n                ),\n              };\n            })\n          ).then(results => {\n            return {\n              results,\n              expectedNumberOfJSExtensionModulesLoaded: getExpectedNumberOfJSExtensionModules(\n                { filterExamples }\n              ),\n            };\n          });\n        },\n        err => {\n          console.error(`Unable to find JS extensions modules`);\n          throw err;\n        }\n      );\n    },\n  };\n};\n","// @flow\nimport optionalRequire from '../Utils/OptionalRequire';\nimport newNameGenerator from '../Utils/NewNameGenerator';\nimport { isPathInProjectFolder } from './ResourceUtils';\nimport { createNewResource } from './ResourceSource';\nconst fs = optionalRequire('fs');\nconst path = optionalRequire('path');\n\nexport type EmbeddedResource = {|\n  resourceKind: string,\n  resourceName?: string,\n\n  /** The \"path\" to the embedded resource (e.g: a tileset) as stored in the parent resource (e.g: a tilemap). */\n  relPath: string,\n\n  /** The full path to the file of the embedded resource. */\n  fullPath: string,\n\n  /** True if the embedded resource file is outside the project folder. */\n  isOutsideProjectFolder: boolean,\n|};\n\nexport type EmbeddedResources = {|\n  hasAnyEmbeddedResourceOutsideProjectFolder: boolean,\n  embeddedResources: Map<string, EmbeddedResource>,\n|};\n\nexport type MappedResources = {|\n  mapping: { [key: string]: string },\n|};\n\ntype ParseEmbeddedFiles = (\n  project: gdProject,\n  filePath: string\n) => Promise<?EmbeddedResources>;\n\n/**\n * Copy the embedded resources inside the project folder\n */\nexport async function copyAllEmbeddedResourcesToProjectFolder(\n  project: gdProject,\n  filesWithEmbeddedResources: Map<string, EmbeddedResources>\n) {\n  if (!fs || !path) {\n    return;\n  }\n\n  const projectPath = path.dirname(project.getProjectFile());\n  const copies = [];\n\n  for (const {\n    hasAnyEmbeddedResourceOutsideProjectFolder,\n    embeddedResources,\n  } of filesWithEmbeddedResources.values()) {\n    if (!hasAnyEmbeddedResourceOutsideProjectFolder) continue;\n\n    for (const embedded of embeddedResources.values()) {\n      if (!embedded.isOutsideProjectFolder) continue;\n\n      const resourceBasename = path.basename(embedded.fullPath);\n      const fileExtension = path.extname(resourceBasename);\n      const fileNameWithoutExtension = path.basename(\n        resourceBasename,\n        fileExtension\n      );\n\n      const newFileNameWithoutExtension = newNameGenerator(\n        fileNameWithoutExtension,\n        tentativeFileName => {\n          const tentativePath =\n            path.join(projectPath, tentativeFileName) + fileExtension;\n          return fs.existsSync(tentativePath);\n        }\n      );\n\n      const resourceNewPath = path.join(\n        projectPath,\n        newFileNameWithoutExtension + fileExtension\n      );\n\n      embedded.resourceName = newFileNameWithoutExtension + fileExtension;\n\n      copies.push(fs.promises.copyFile(embedded.fullPath, resourceNewPath));\n    }\n  }\n\n  return Promise.all(copies);\n}\n\n/**\n * Create the mapping between embedded resource path (e.g: path to a tileset) to its resource name (i.e: the name of\n * the resource containing the tileset).\n */\nexport function createAndMapEmbeddedResources(\n  project: gdProject,\n  filesWithEmbeddedResources: Map<string, EmbeddedResources>\n): Map<string, MappedResources> {\n  const projectPath = path.dirname(project.getProjectFile());\n\n  const filesWithMappedResources = new Map<string, MappedResources>();\n  for (const [filePath, { embeddedResources }] of filesWithEmbeddedResources) {\n    const mapping = {};\n    for (let {\n      resourceKind,\n      resourceName,\n      relPath,\n      fullPath,\n    } of embeddedResources.values()) {\n      if (!resourceName) {\n        resourceName = path.relative(projectPath, fullPath);\n      }\n\n      const theEmbeddedResource = createNewResource(resourceKind);\n      if (theEmbeddedResource) {\n        theEmbeddedResource.setName(resourceName);\n        theEmbeddedResource.setFile(resourceName);\n\n        mapping[relPath] = resourceName;\n\n        // embedded resources can have mappings too\n        if (filesWithMappedResources.has(fullPath)) {\n          const mappedResources = filesWithMappedResources.get(fullPath);\n\n          if (mappedResources && mappedResources.mapping) {\n            theEmbeddedResource.setMetadata(\n              JSON.stringify({\n                embeddedResourcesMapping: mappedResources.mapping,\n              })\n            );\n\n            filesWithMappedResources.delete(fullPath);\n          }\n        }\n\n        project.getResourcesManager().addResource(theEmbeddedResource);\n      }\n    }\n\n    filesWithMappedResources.set(filePath, {\n      mapping,\n    });\n  }\n\n  return filesWithMappedResources;\n}\n\n/**\n * List the embedded resources of a Tilemap (or JSON) resource.\n * Supports LDtk tilemaps.\n *\n * @param project The project\n * @param filePath The file path of a resource\n * @returns\n */\nexport async function listTileMapEmbeddedResources(\n  project: gdProject,\n  filePath: string\n): Promise<?EmbeddedResources> {\n  if (!fs || !path) {\n    return null;\n  }\n\n  const data = await fs.promises.readFile(filePath, 'utf8');\n  try {\n    const tileMap = JSON.parse(data);\n\n    // For LDtk tilemaps, read the tilesets.\n    if (tileMap && tileMap.__header__ && tileMap.__header__.app === 'LDtk') {\n      const dir = path.dirname(filePath);\n      const embeddedResources = new Map<string, EmbeddedResource>();\n      let hasAnyEmbeddedResourceOutsideProjectFolder = false;\n\n      for (const tileset of tileMap.defs.tilesets) {\n        if (tileset.relPath) {\n          const relPath = tileset.relPath;\n          const fullPath = path.resolve(dir, relPath);\n          const isOutsideProjectFolder = !isPathInProjectFolder(\n            project,\n            fullPath\n          );\n          const resource: EmbeddedResource = {\n            resourceKind: 'image',\n            relPath,\n            fullPath,\n            isOutsideProjectFolder,\n          };\n\n          embeddedResources.set(relPath, resource);\n\n          if (isOutsideProjectFolder)\n            hasAnyEmbeddedResourceOutsideProjectFolder = true;\n        }\n      }\n\n      for (const level of tileMap.levels) {\n        if (level.bgRelPath) {\n          const relPath = level.bgRelPath;\n          const fullPath = path.resolve(dir, relPath);\n          const isOutsideProjectFolder = !isPathInProjectFolder(\n            project,\n            fullPath\n          );\n          const resource: EmbeddedResource = {\n            resourceKind: 'image',\n            relPath,\n            fullPath,\n            isOutsideProjectFolder,\n          };\n\n          embeddedResources.set(level.bgRelPath, resource);\n\n          if (isOutsideProjectFolder)\n            hasAnyEmbeddedResourceOutsideProjectFolder = true;\n        }\n      }\n\n      return {\n        hasAnyEmbeddedResourceOutsideProjectFolder,\n        embeddedResources,\n      };\n    }\n  } catch (error) {\n    console.error(\n      `Unable to read properly the data from file ${filePath} for use as a tilemap - ignoring any potentially embedded resources.`\n    );\n    return null;\n  }\n}\n\nexport async function listSpineEmbeddedResources(\n  project: gdProject,\n  filePath: string\n): Promise<?EmbeddedResources> {\n  if (!fs || !path) return null;\n\n  const atlasPath = filePath.replace('.json', '.atlas');\n  const hasAtlasWithSameBasename = await new Promise<boolean>(resolve => {\n    fs.promises\n      .access(atlasPath, fs.constants.F_OK)\n      .then(() => resolve(true))\n      .catch(() => resolve(false));\n  });\n\n  // Spine resources usually have the same base names:\n  // e.g. skeleton.json, skeleton.atlas and skeleton.png.\n  if (!hasAtlasWithSameBasename) {\n    console.error(`Could not find an atlas file for Spine file ${filePath}.`);\n    return null;\n  }\n\n  const atlasFileName = path.basename(atlasPath);\n  const embeddedResources = new Map<string, EmbeddedResource>();\n  const isOutsideProjectFolder = !isPathInProjectFolder(project, atlasPath);\n  const resource: EmbeddedResource = {\n    resourceKind: 'atlas',\n    relPath: atlasFileName,\n    fullPath: atlasPath,\n    isOutsideProjectFolder,\n  };\n\n  embeddedResources.set(atlasFileName, resource);\n\n  return {\n    embeddedResources,\n    hasAnyEmbeddedResourceOutsideProjectFolder: isOutsideProjectFolder,\n  };\n}\n\nexport async function listSpineTextureAtlasEmbeddedResources(\n  project: gdProject,\n  filePath: string\n): Promise<?EmbeddedResources> {\n  if (!fs || !path) return null;\n\n  let atlasContent: ?string = null;\n  try {\n    atlasContent = await fs.promises.readFile(filePath, 'utf8');\n  } catch (error) {\n    console.error(\n      `Unable to read Spine Atlas file at path ${filePath}:`,\n      error\n    );\n  }\n\n  if (!atlasContent) return null;\n\n  const atlasImageRegex = /.*\\.(png|jpeg|jpg)$/gm;\n  const imageDependencies = atlasContent.match(atlasImageRegex);\n  if (!imageDependencies) return null;\n\n  const dir = path.dirname(filePath);\n  const embeddedResources = new Map<string, EmbeddedResource>();\n  let hasAnyEmbeddedResourceOutsideProjectFolder = false;\n\n  for (const relatedImagePath of imageDependencies) {\n    const fullPath = path.resolve(dir, relatedImagePath);\n    const isOutsideProjectFolder = !isPathInProjectFolder(project, fullPath);\n    const resource: EmbeddedResource = {\n      resourceKind: 'image',\n      relPath: relatedImagePath,\n      fullPath,\n      isOutsideProjectFolder,\n    };\n\n    embeddedResources.set(relatedImagePath, resource);\n\n    if (isOutsideProjectFolder)\n      hasAnyEmbeddedResourceOutsideProjectFolder = true;\n  }\n\n  return {\n    embeddedResources,\n    hasAnyEmbeddedResourceOutsideProjectFolder,\n  };\n}\n\nexport const embeddedResourcesParsers: { [string]: ParseEmbeddedFiles } = {\n  tilemap: listTileMapEmbeddedResources,\n  json: listTileMapEmbeddedResources,\n  spine: listSpineEmbeddedResources,\n  atlas: listSpineTextureAtlasEmbeddedResources,\n};\n","// @flow\nimport { t, Trans } from '@lingui/macro';\nimport * as React from 'react';\nimport {\n  type ChooseResourceProps,\n  type ResourceSourceComponentProps,\n  type ResourceSourceComponentPrimaryActionProps,\n  type ResourceSource,\n  type ResourceStoreChooserProps,\n  allResourceKindsAndMetadata,\n  resourcesKindSupportedByResourceStore,\n} from './ResourceSource';\nimport {} from '../Utils/GDevelopServices/Asset';\nimport { ResourceStore } from '../AssetStore/ResourceStore';\nimport { isPathInProjectFolder, copyAllToProjectFolder } from './ResourceUtils';\nimport optionalRequire from '../Utils/OptionalRequire';\nimport Window from '../Utils/Window';\nimport {\n  copyAllEmbeddedResourcesToProjectFolder,\n  embeddedResourcesParsers,\n  createAndMapEmbeddedResources,\n  type EmbeddedResources,\n  type MappedResources,\n} from './LocalEmbeddedResourceSources';\nimport { Line } from '../UI/Grid';\nimport RaisedButton from '../UI/RaisedButton';\nimport { FileToCloudProjectResourceUploader } from './FileToCloudProjectResourceUploader';\nimport { DialogPrimaryButton } from '../UI/Dialog';\nimport ProjectResourcesChooser from './ProjectResources/ProjectResourcesChooser';\n\nconst remote = optionalRequire('@electron/remote');\nconst dialog = remote ? remote.dialog : null;\nconst path = optionalRequire('path');\n\nconst ResourceStoreChooser = ({\n  options,\n  selectedResourceIndex,\n  onSelectResource,\n}: ResourceStoreChooserProps) => {\n  if (!onSelectResource) return null;\n  const { resourceKind } = options;\n  if (!resourcesKindSupportedByResourceStore.includes(resourceKind)) {\n    return null;\n  }\n  return (\n    <ResourceStore\n      selectedResourceIndex={selectedResourceIndex}\n      onSelectResource={onSelectResource}\n      resourceKind={\n        // $FlowIgnore - Flow does not understand the check above restricts the resource kind.\n        resourceKind\n      }\n    />\n  );\n};\n\nconst localResourceSources: Array<ResourceSource> = [\n  // Have the local resource sources first, so they are used by default/shown first when\n  // the project is saved locally.\n  ...allResourceKindsAndMetadata.map(\n    ({ kind, displayName, fileExtensions, createNewResource }) => {\n      const selectLocalFileResources = async ({\n        i18n,\n        getLastUsedPath,\n        setLastUsedPath,\n        project,\n        options,\n        resourcesImporationBehavior,\n      }: ChooseResourceProps) => {\n        if (!dialog)\n          throw new Error('Electron dialog not supported in this environment.');\n\n        const properties = ['openFile'];\n        if (options.multiSelection) properties.push('multiSelections');\n\n        const projectPath = path.dirname(project.getProjectFile());\n        const latestPath = getLastUsedPath(project, kind) || projectPath;\n\n        const browserWindow = remote.getCurrentWindow();\n        let { filePaths } = await dialog.showOpenDialog(browserWindow, {\n          title: i18n._(t`Choose a file`),\n          properties,\n          filters: [\n            { name: i18n._(t`Supported files`), extensions: fileExtensions },\n          ],\n          defaultPath: latestPath,\n        });\n        if (!filePaths || !filePaths.length) return [];\n\n        const lastUsedPath = path.parse(filePaths[0]).dir;\n        setLastUsedPath(project, kind, lastUsedPath);\n\n        let hasFilesOutsideProjectFolder = filePaths.some(\n          path => !isPathInProjectFolder(project, path)\n        );\n\n        // Some resources, like tilemaps, can have references to other files.\n        // We parse these files, optionally copy them, then create a mapping from the previous file name\n        // as written inside the tilemap to the name of the resource that is representing this file.\n        const filesWithEmbeddedResources = new Map<string, EmbeddedResources>();\n        const parseEmbeddedResources = embeddedResourcesParsers[kind];\n        const recursivelyParseEmbeddedResources = async (\n          initialEmbeddedResources: EmbeddedResources\n        ) => {\n          for (const initialEmbeddedResource of initialEmbeddedResources.embeddedResources.values()) {\n            const embeddedResourseParser =\n              embeddedResourcesParsers[initialEmbeddedResource.resourceKind];\n\n            if (!embeddedResourseParser) continue;\n\n            const { fullPath } = initialEmbeddedResource;\n            const newDependentResources = await embeddedResourseParser(\n              project,\n              fullPath\n            );\n\n            if (newDependentResources) {\n              filesWithEmbeddedResources.set(fullPath, newDependentResources);\n\n              await recursivelyParseEmbeddedResources(newDependentResources);\n            }\n          }\n        };\n        if (parseEmbeddedResources) {\n          for (const filePath of filePaths) {\n            const embeddedResources = await parseEmbeddedResources(\n              project,\n              filePath\n            );\n\n            if (embeddedResources) {\n              await recursivelyParseEmbeddedResources(embeddedResources);\n\n              filesWithEmbeddedResources.set(filePath, embeddedResources);\n\n              if (embeddedResources.hasAnyEmbeddedResourceOutsideProjectFolder)\n                hasFilesOutsideProjectFolder = true;\n            }\n          }\n        }\n\n        // Check if files should be copied in the project folder.\n        const newToOldFilePaths = new Map<string, string>();\n        let filesWithMappedResources = new Map<string, MappedResources>();\n        if (hasFilesOutsideProjectFolder) {\n          let answer: boolean;\n\n          if (resourcesImporationBehavior === 'relative') {\n            answer = false;\n          } else if (resourcesImporationBehavior === 'import') {\n            answer = true;\n          } else {\n            answer = Window.showConfirmDialog(\n              i18n._(\n                t`This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?`\n              )\n            );\n          }\n\n          if (answer) {\n            filePaths = await copyAllToProjectFolder(\n              project,\n              filePaths,\n              newToOldFilePaths\n            );\n\n            await copyAllEmbeddedResourcesToProjectFolder(\n              project,\n              filesWithEmbeddedResources\n            );\n          }\n        }\n\n        // In case of resources embedded inside others,\n        // create a mapping from the file name\n        // as written inside the resource (e.g: the tilemap)\n        // to the name of the resource that was created to\n        // represent this file.\n        filesWithMappedResources = createAndMapEmbeddedResources(\n          project,\n          filesWithEmbeddedResources\n        );\n\n        return filePaths.map(filePath => {\n          const newResource = createNewResource();\n          newResource.setFile(path.relative(projectPath, filePath));\n          newResource.setName(path.relative(projectPath, filePath));\n\n          const filePathWithMapping = newToOldFilePaths.has(filePath)\n            ? newToOldFilePaths.get(filePath)\n            : filePath;\n          if (filePathWithMapping) {\n            const mappedResources = filesWithMappedResources.get(\n              filePathWithMapping\n            );\n\n            if (mappedResources && mappedResources.mapping) {\n              newResource.setMetadata(\n                JSON.stringify({\n                  embeddedResourcesMapping: mappedResources.mapping,\n                })\n              );\n            }\n          }\n\n          return newResource;\n        });\n      };\n\n      const sourceName = 'local-file-opener-' + kind;\n\n      return {\n        name: sourceName,\n        displayName: t`File(s) from your device`,\n        displayTab: 'import',\n        onlyForStorageProvider: 'LocalFile',\n        shouldCreateResource: true,\n        shouldGuessAnimationsFromName: true,\n        kind,\n        selectResourcesHeadless: selectLocalFileResources,\n        renderComponent: (props: ResourceSourceComponentProps) => (\n          <Line justifyContent=\"center\">\n            <RaisedButton\n              primary\n              label={\n                props.options.multiSelection ? (\n                  <Trans>Choose one or more files</Trans>\n                ) : (\n                  <Trans>Choose a file</Trans>\n                )\n              }\n              onClick={async () => {\n                const selectedResources = await selectLocalFileResources({\n                  i18n: props.i18n,\n                  project: props.project,\n                  fileMetadata: props.fileMetadata,\n                  getStorageProvider: props.getStorageProvider,\n                  getLastUsedPath: props.getLastUsedPath,\n                  setLastUsedPath: props.setLastUsedPath,\n                  options: props.options,\n                  resourcesImporationBehavior:\n                    props.resourcesImporationBehavior,\n                });\n\n                props.onChooseResources({\n                  selectedResources,\n                  selectedSourceName: sourceName,\n                });\n              }}\n            />\n          </Line>\n        ),\n      };\n    }\n  ),\n  ...allResourceKindsAndMetadata.map(({ kind, createNewResource }) => {\n    const sourceName = `upload-${kind}`;\n    return {\n      name: sourceName,\n      displayName: t`File(s) from your device`,\n      shouldCreateResource: true,\n      shouldGuessAnimationsFromName: true,\n      displayTab: 'import',\n      onlyForStorageProvider: 'Cloud',\n      kind,\n      renderComponent: (props: ResourceSourceComponentProps) => (\n        <FileToCloudProjectResourceUploader\n          createNewResource={createNewResource}\n          onChooseResources={(resources: Array<gdResource>) =>\n            props.onChooseResources({\n              selectedResources: resources,\n              selectedSourceName: sourceName,\n            })\n          }\n          options={props.options}\n          fileMetadata={props.fileMetadata}\n          getStorageProvider={props.getStorageProvider}\n          key={`url-chooser-${kind}`}\n          automaticallyOpenInput={!!props.automaticallyOpenIfPossible}\n        />\n      ),\n    };\n  }),\n  ...resourcesKindSupportedByResourceStore\n    .map(kind => {\n      const source = allResourceKindsAndMetadata.find(\n        resourceSource => resourceSource.kind === kind\n      );\n      if (!source) return null;\n      const sourceName = 'resource-store-' + kind;\n      return {\n        name: sourceName,\n        displayName: t`Choose from asset store`,\n        displayTab: 'standalone',\n        kind,\n        shouldCreateResource: true,\n        shouldGuessAnimationsFromName: false,\n        renderComponent: (props: ResourceSourceComponentProps) => (\n          <ResourceStoreChooser\n            selectedResourceIndex={props.selectedResourceIndex}\n            onSelectResource={props.onSelectResource}\n            options={props.options}\n            key={`resource-store-${kind}`}\n          />\n        ),\n        renderPrimaryAction: ({\n          resource,\n          onChooseResources,\n        }: ResourceSourceComponentPrimaryActionProps) => (\n          <DialogPrimaryButton\n            primary\n            key=\"add-resource\"\n            label={\n              kind === 'font' ? (\n                <Trans>Install font</Trans>\n              ) : (\n                <Trans>Add to project</Trans>\n              )\n            }\n            disabled={!resource}\n            onClick={() => {\n              if (!resource) return;\n              const chosenResourceUrl = resource.url;\n              const newResource = source.createNewResource();\n              newResource.setFile(chosenResourceUrl);\n              newResource.setName(path.basename(chosenResourceUrl));\n              newResource.setOrigin('gdevelop-asset-store', chosenResourceUrl);\n\n              onChooseResources({\n                selectedResources: [newResource],\n                selectedSourceName: sourceName,\n              });\n            }}\n          />\n        ),\n      };\n    })\n    .filter(Boolean),\n  ...allResourceKindsAndMetadata.map(({ kind, createNewResource }) => {\n    const sourceName = `project-resources-${kind}`;\n    return {\n      name: sourceName,\n      displayName: t`Project resources`,\n      displayTab: 'standalone',\n      shouldCreateResource: false,\n      shouldGuessAnimationsFromName: false,\n      hideInResourceEditor: true,\n      kind,\n      renderComponent: (props: ResourceSourceComponentProps) => (\n        <ProjectResourcesChooser\n          project={props.project}\n          onResourcesSelected={props.onResourcesSelected}\n          resourceKind={kind}\n          key={`project-resources-${kind}`}\n          multiSelection={props.options.multiSelection}\n        />\n      ),\n      renderPrimaryAction: ({\n        selectedResources,\n        onChooseResources,\n      }: ResourceSourceComponentPrimaryActionProps) => (\n        <DialogPrimaryButton\n          primary\n          key=\"select-resources\"\n          label={\n            !selectedResources ||\n            !selectedResources.length ||\n            selectedResources.length === 1 ? (\n              <Trans>Select resource</Trans>\n            ) : (\n              <Trans>Select {selectedResources.length} resources</Trans>\n            )\n          }\n          disabled={!selectedResources || !selectedResources.length}\n          onClick={() => {\n            if (!selectedResources || !selectedResources.length) return;\n            onChooseResources({\n              selectedResources,\n              selectedSourceName: sourceName,\n            });\n          }}\n        />\n      ),\n    };\n  }),\n];\n\nexport default localResourceSources;\n","// @flow\nimport {\n  type ResourceExternalEditor,\n  type ExternalEditorInput,\n  type ExternalEditorOutput,\n  type ExternalEditorBase64Resource,\n  type EditWithExternalEditorOptions,\n  readMetadata,\n  saveBlobUrlsFromExternalEditorBase64Resources,\n  freeBlobsAndUpdateMetadata,\n  patchExternalEditorMetadataWithResourcesNamesIfNecessary,\n} from './ResourceExternalEditor';\nimport { sendExternalEditorOpened } from '../Utils/Analytics/EventSender';\nimport { t } from '@lingui/macro';\nimport optionalRequire from '../Utils/OptionalRequire';\nimport { isBlobURL, isURL } from './ResourceUtils';\nimport {\n  convertBlobToDataURL,\n  downloadUrlsToBlobs,\n  type ItemResult,\n} from '../Utils/BlobDownloader';\nimport { type ResourceKind } from './ResourceSource';\n\nconst path = optionalRequire('path');\nconst fs = optionalRequire('fs');\nconst electron = optionalRequire('electron');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\n\n/**\n * Ask Electron main process to open a window for the specified editor,\n * then wait for the editor to be closed and pass the results.\n */\nconst openAndWaitForExternalEditorWindow = async (\n  editorName: 'piskel' | 'yarn' | 'jfxr',\n  externalEditorInput: ExternalEditorInput\n): Promise<?ExternalEditorOutput> => {\n  if (!ipcRenderer) throw new Error('Not supported.');\n\n  const externalEditorOutput = await ipcRenderer.invoke(\n    `${editorName}-load`,\n    externalEditorInput\n  );\n  return externalEditorOutput;\n};\n\n/**\n * Download (or read locally) resources and prepare them to be edited\n * by an external editor.\n */\nexport const downloadAndPrepareExternalEditorBase64Resources = async ({\n  project,\n  resourceNames,\n}: {|\n  project: gdProject,\n  resourceNames: Array<string>,\n|}): Promise<Array<ExternalEditorBase64Resource>> => {\n  type ResourceToDownload = {|\n    resourceName: string,\n    url: string,\n  |};\n\n  type ResourceToReadLocally = {|\n    resourceName: string,\n    localFilePath: string,\n  |};\n\n  const projectPath = path.dirname(project.getProjectFile());\n  const urlsToDownload: Array<ResourceToDownload> = [];\n  const filesToRead: Array<ResourceToReadLocally> = [];\n  const resourcesManager = project.getResourcesManager();\n  resourceNames.forEach(resourceName => {\n    if (!resourcesManager.hasResource(resourceName)) return;\n\n    const resource = resourcesManager.getResource(resourceName);\n    const url = resource.getFile();\n    if (isURL(url)) {\n      if (isBlobURL(url)) {\n        console.error('Unsupported blob URL for a resource - ignoring it.');\n      } else {\n        urlsToDownload.push({\n          url,\n          resourceName,\n        });\n      }\n    } else {\n      // This resource is a local file.\n      filesToRead.push({\n        localFilePath: url,\n        resourceName,\n      });\n    }\n  });\n\n  const downloadedBlobs: Array<\n    ItemResult<ResourceToDownload>\n  > = await downloadUrlsToBlobs({\n    urlContainers: urlsToDownload,\n    onProgress: (count, total) => {},\n  });\n\n  const resourcesToDataUrl = new Map<\n    string,\n    {|\n      dataUrl: string,\n      localFilePath?: string,\n    |}\n  >();\n  await Promise.all(\n    downloadedBlobs.map(async ({ error, blob, item }) => {\n      if (blob) {\n        try {\n          resourcesToDataUrl.set(item.resourceName, {\n            dataUrl: await convertBlobToDataURL(blob),\n          });\n        } catch (error) {\n          console.error(\n            `Unable to read data from resource \"${\n              item.resourceName\n            }\" - ignoring it.`,\n            error\n          );\n        }\n      }\n    })\n  );\n  await Promise.all(\n    filesToRead.map(async ({ localFilePath, resourceName }) => {\n      try {\n        const content = await fs.promises.readFile(\n          path.resolve(projectPath, localFilePath)\n        );\n\n        resourcesToDataUrl.set(resourceName, {\n          localFilePath,\n          dataUrl: 'data:text/plain;base64,' + content.toString('base64'),\n        });\n      } catch (error) {\n        console.error(\n          `Unable to read local file \"${localFilePath}\" - ignoring it.`,\n          error\n        );\n      }\n    })\n  );\n\n  return resourceNames.map(resourceName => {\n    const resourceData = resourcesToDataUrl.get(resourceName);\n    if (!resourceData)\n      return {\n        name: resourceName,\n        dataUrl: '',\n      };\n\n    const { localFilePath, dataUrl } = resourceData;\n    return {\n      name: resourceName,\n      dataUrl,\n      localFilePath,\n    };\n  });\n};\n\n/**\n * Edit one or more resources with the specified external editor.\n */\nconst editWithLocalExternalEditor = async ({\n  externalEditorName,\n  defaultName,\n  metadataKey,\n  resourceKind,\n  options,\n}: {|\n  externalEditorName: 'piskel' | 'yarn' | 'jfxr',\n  defaultName: string,\n  metadataKey: string,\n  resourceKind: ResourceKind,\n  options: EditWithExternalEditorOptions,\n|}) => {\n  const { project, resourceNames, resourceManagementProps } = options;\n\n  // Fetch all edited resources as base64 encoded \"data urls\" (`data:...`).\n  const resources = await downloadAndPrepareExternalEditorBase64Resources({\n    project,\n    resourceNames,\n  });\n\n  // Open the external editor, passing the resources with the data urls.\n  const externalEditorInput: ExternalEditorInput = {\n    singleFrame: options.extraOptions.singleFrame,\n    externalEditorData: readMetadata(\n      metadataKey,\n      options.extraOptions.existingMetadata\n    ),\n    fps: options.extraOptions.fps,\n    isLooping: options.extraOptions.isLooping,\n    name: options.extraOptions.name || resourceNames[0] || defaultName,\n    resources,\n  };\n  sendExternalEditorOpened(externalEditorName);\n  const externalEditorOutput: ?ExternalEditorOutput = await openAndWaitForExternalEditorWindow(\n    externalEditorName,\n    externalEditorInput\n  );\n  if (!externalEditorOutput) return null; // Changes cancelled.\n\n  // Save the edited files back to the GDevelop resources, as \"blob urls\" (blob:...)\n  // which can then uploaded or saved locally.\n  const modifiedResources = await saveBlobUrlsFromExternalEditorBase64Resources(\n    {\n      baseNameForNewResources: externalEditorOutput.baseNameForNewResources,\n      project,\n      resources: externalEditorOutput.resources,\n      resourceKind,\n    }\n  );\n\n  // Ask the project to persist the resources (\"blob urls\" will be either uploaded\n  // or saved locally).\n  try {\n    await resourceManagementProps.onFetchNewlyAddedResources();\n  } catch (error) {\n    console.error(\n      'An error happened while fetching the newly added resources:',\n      error\n    );\n  }\n\n  // Free the \"blob urls\" so that blobs don't stay in memory! They are only temporarily\n  // useful while waiting for an upload/local file save.\n  freeBlobsAndUpdateMetadata({\n    modifiedResources,\n    metadataKey,\n    metadata: options.extraOptions.singleFrame\n      ? externalEditorOutput.externalEditorData\n      : null,\n  });\n\n  const hasCreatedAnyResource = externalEditorOutput.resources.some(\n    resource => !resource.name\n  );\n  if (hasCreatedAnyResource) {\n    resourceManagementProps.onNewResourcesAdded();\n  }\n\n  // Some editors (Piskel) need to have resource names persisted.\n  patchExternalEditorMetadataWithResourcesNamesIfNecessary(\n    modifiedResources.map(({ resource }) => resource.getName()),\n    externalEditorOutput.externalEditorData\n  );\n\n  return {\n    resources: modifiedResources.map(({ resource, originalIndex }) => ({\n      name: resource.getName(),\n      originalIndex,\n    })),\n    newName: externalEditorOutput.baseNameForNewResources,\n    newMetadata: { [metadataKey]: externalEditorOutput.externalEditorData },\n  };\n};\n\n/**\n * This is the list of editors that can be used to edit resources\n * on Electron runtime.\n */\nconst editors: Array<ResourceExternalEditor> = [\n  {\n    name: 'piskel-app',\n    createDisplayName: t`Create with Piskel`,\n    editDisplayName: t`Edit with Piskel`,\n    kind: 'image',\n    edit: async options => {\n      return await editWithLocalExternalEditor({\n        options,\n        externalEditorName: 'piskel',\n        defaultName: 'New image',\n        metadataKey: 'pskl',\n        resourceKind: 'image',\n      });\n    },\n  },\n  {\n    name: 'Jfxr',\n    createDisplayName: t`Create with Jfxr`,\n    editDisplayName: t`Edit with Jfxr`,\n    kind: 'audio',\n    edit: async options => {\n      return await editWithLocalExternalEditor({\n        options,\n        externalEditorName: 'jfxr',\n        defaultName: 'New sound effect',\n        metadataKey: 'jfxr',\n        resourceKind: 'audio',\n      });\n    },\n  },\n  {\n    name: 'Yarn',\n    createDisplayName: t`Create with Yarn`,\n    editDisplayName: t`Edit with Yarn`,\n    kind: 'json',\n    edit: async options => {\n      return await editWithLocalExternalEditor({\n        options,\n        externalEditorName: 'yarn',\n        defaultName: 'New dialogue tree',\n        metadataKey: 'yarn',\n        resourceKind: 'json',\n      });\n    },\n  },\n];\n\nexport default editors;\n","// @flow\nimport optionalRequire from './OptionalRequire';\nconst os = optionalRequire('os');\n\nexport const getUID = () => {\n  try {\n    return os.userInfo().uid;\n  } catch (e) {\n    return '';\n  }\n};\n","// @flow\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport { getUID } from '../../Utils/LocalUserInfo';\nimport { isURL } from '../../ResourcesList/ResourceUtils';\nconst fs = optionalRequire('fs-extra');\nconst path = optionalRequire('path');\nconst os = optionalRequire('os');\n\nconst gd: libGDevelop = global.gd;\n\nexport type UrlFileDescriptor = {|\n  filePath: string,\n  url: string,\n|};\n\n// For some reason, `path.posix` is undefined when packaged\n// with webpack, so we're using `path` directly. As it's for the web-app,\n// it should always be the posix version. In tests on Windows,\n// it's necessary to use path.posix.\n// Search for \"pathPosix\" in the codebase for other places where this is used.\nconst pathPosix = path.posix || path;\n\n/**\n * Gives access to the local filesystem, but returns paths\n * that are using \"/\" as a path separator, even on Windows\n * (so that in exported games, paths are slashs, which is\n * supported everywhere).\n */\nclass LocalFileSystem {\n  /**\n   * True if URLs should be downloaded (useful for an export, but not for a preview).\n   * @private\n   */\n  _downloadUrlsToLocalFiles: boolean;\n\n  /**\n   * Store all the files that should be downloaded (filepath => url)\n   * @private\n   */\n  _filesToDownload: { [string]: string } = {};\n\n  constructor(\n    options: ?{|\n      downloadUrlsToLocalFiles: boolean,\n    |}\n  ) {\n    this._downloadUrlsToLocalFiles =\n      !!options && options.downloadUrlsToLocalFiles;\n  }\n\n  /**\n   * Returns all the files that should be downloaded from a URL, with the specified destination path prefix.\n   */\n  getAllUrlFilesIn = (pathPrefix: string): Array<UrlFileDescriptor> => {\n    // Ensure the path prefix we're searching the files in is normalized,\n    // because everything that we stored was normalized. If we don't do this,\n    // we risk missing files on Windows (as pathPrefix can contain backslashes).\n    const normalizedPathPrefix = pathPosix\n      .normalize(pathPrefix)\n      .replace(/\\\\/g, '/');\n\n    return Object.keys(this._filesToDownload)\n      .filter(filePath => filePath.indexOf(normalizedPathPrefix) === 0)\n      .map(filePath => ({\n        filePath,\n        url: this._filesToDownload[filePath],\n      }));\n  };\n\n  mkDir = (path: string) => {\n    if (isURL(path)) {\n      // URLs are always assumed to exist.\n      return;\n    }\n\n    try {\n      fs.mkdirsSync(path);\n    } catch (e) {\n      console.error('mkDir(' + path + ') failed: ' + e);\n      return false;\n    }\n    return true;\n  };\n  dirExists = (path: string) => {\n    if (isURL(path)) {\n      // URLs are always assumed to exist.\n      return true;\n    }\n\n    return fs.existsSync(path);\n  };\n  clearDir = (path: string) => {\n    try {\n      fs.emptyDirSync(path);\n    } catch (e) {\n      console.error('clearDir(' + path + ') failed: ' + e);\n    }\n  };\n  getTempDir = () => {\n    return path.join(os.tmpdir(), `GDTMP-${getUID()}`);\n  };\n  fileNameFrom = (fullPath: string) => {\n    // If URLs are not downloaded, then filenames are not changed.\n    if (!this._downloadUrlsToLocalFiles && isURL(fullPath)) return fullPath;\n\n    return path.basename(fullPath);\n  };\n  dirNameFrom = (fullPath: string) => {\n    return path.dirname(fullPath).replace(/\\\\/g, '/');\n  };\n  makeAbsolute = (filename: string, baseDirectory: string) => {\n    if (isURL(filename)) return filename;\n\n    if (!this.isAbsolute(baseDirectory))\n      baseDirectory = path.resolve(baseDirectory);\n\n    if (isURL(baseDirectory)) {\n      return baseDirectory + '/' + filename;\n    }\n\n    return path\n      .resolve(baseDirectory, path.normalize(filename))\n      .replace(/\\\\/g, '/');\n  };\n  makeRelative = (filename: string, baseDirectory: string) => {\n    if (isURL(filename)) return filename;\n\n    return path\n      .relative(baseDirectory, path.normalize(filename))\n      .replace(/\\\\/g, '/');\n  };\n  isAbsolute = (fullPath: string) => {\n    if (isURL(fullPath)) return true;\n\n    if (fullPath.length === 0) return true;\n    return (\n      (fullPath.length > 0 && fullPath.charAt(0) === '/') ||\n      (fullPath.length > 1 && fullPath.charAt(1) === ':')\n    );\n  };\n  copyFile = (source: string, dest: string) => {\n    if (isURL(source)) {\n      // If URLs are not downloaded, then there is nothing to copy.\n      if (!this._downloadUrlsToLocalFiles) return true;\n\n      if (isURL(dest)) {\n        console.error(\n          `Destination can't be a URL in copyFile (from ${source} to ${dest}).`\n        );\n        return false;\n      }\n\n      this._filesToDownload[pathPosix.normalize(dest)] = source;\n      return true;\n    }\n\n    try {\n      if (source !== dest) fs.copySync(source, dest);\n    } catch (e) {\n      if (e.code === 'ENOENT') {\n        // If the file does not exist, it's possible it is meant to be downloaded.\n        // In this case, consider the file copied by getting it to be downloaded in the new destination.\n        const existingDestToDownload = Object.keys(this._filesToDownload).find(\n          filePath => filePath === source\n        );\n        if (existingDestToDownload) {\n          const existingSourceToDownload = this._filesToDownload[\n            existingDestToDownload\n          ];\n          this._filesToDownload[\n            pathPosix.normalize(dest)\n          ] = existingSourceToDownload;\n          return true;\n        }\n      }\n\n      console.error('copyFile(' + source + ', ' + dest + ') failed: ' + e);\n      return false;\n    }\n    return true;\n  };\n  writeToFile = (file: string, contents: string) => {\n    try {\n      fs.outputFileSync(file, contents);\n    } catch (e) {\n      console.error('writeToFile(' + file + ', ...) failed: ' + e);\n      return false;\n    }\n    return true;\n  };\n  readFile = (file: string) => {\n    try {\n      var contents = fs.readFileSync(file);\n      return contents.toString();\n    } catch (e) {\n      console.error('readFile(' + file + ') failed: ' + e);\n      return '';\n    }\n  };\n  readDir = (path: string, ext: string) => {\n    ext = ext.toUpperCase();\n    var output = new gd.VectorString();\n    try {\n      var files = [];\n      if (fs.existsSync(path)) {\n        files = fs.readdirSync(path);\n        files.forEach(function(file) {\n          if (\n            ext.length === 0 ||\n            file.toUpperCase().indexOf(ext, file.length - ext.length) !== -1\n          ) {\n            output.push_back(path + '/' + file);\n          }\n        });\n      }\n    } catch (e) {\n      console.error('readDir(' + path + ',' + ext + ') failed: ' + e);\n    }\n\n    return output;\n  };\n  fileExists = (filePath: string) => {\n    // Check if a file WILL exists once downloaded.\n    const normalizedFilePath = pathPosix.normalize(filePath);\n    const shouldTheFileBeDownloaded = !!this._filesToDownload[\n      normalizedFilePath\n    ];\n    if (shouldTheFileBeDownloaded) {\n      return true;\n    }\n\n    // Check if a local file exists.\n    try {\n      const stat = fs.statSync(filePath);\n      return stat.isFile();\n    } catch (e) {\n      return false;\n    }\n  };\n}\n\nexport default LocalFileSystem;\n","// @flow\nimport { Trans } from '@lingui/macro';\n\nimport * as React from 'react';\nimport Dialog from '../../../UI/Dialog';\nimport FlatButton from '../../../UI/FlatButton';\nimport Text from '../../../UI/Text';\nimport { Line } from '../../../UI/Grid';\nimport PlaceholderLoader from '../../../UI/PlaceholderLoader';\nimport ShareLink from '../../../UI/ShareDialog/ShareLink';\nimport QrCode from '../../../UI/QrCode';\nimport { useResponsiveWindowSize } from '../../../UI/Responsive/ResponsiveWindowMeasurer';\n\ntype Props = {|\n  open: boolean,\n  /**\n   * url without protocol, for example '192.168.1.16:2929'\n   */\n  url: ?string,\n  onClose: () => void,\n  onExport: ?() => void,\n  onRunPreviewLocally: () => void,\n  error: ?any,\n|};\n\nconst LocalNetworkPreviewDialog = ({\n  url,\n  open,\n  error,\n  onExport,\n  onClose,\n  onRunPreviewLocally,\n}: Props) => {\n  const { isMobile } = useResponsiveWindowSize();\n  if (!open) return null;\n  const urlWithProtocol = url ? `http://${url}` : null;\n\n  return (\n    <Dialog\n      title={<Trans>Preview</Trans>}\n      actions={[\n        <FlatButton\n          key=\"close\"\n          label={<Trans>Close</Trans>}\n          primary\n          onClick={onClose}\n        />,\n      ]}\n      secondaryActions={[\n        onExport && (\n          <FlatButton\n            key=\"export\"\n            label={<Trans>Export game</Trans>}\n            onClick={onExport}\n          />\n        ),\n        <FlatButton\n          key=\"run-preview-locally\"\n          label={<Trans>Run on this computer</Trans>}\n          onClick={onRunPreviewLocally}\n        />,\n      ]}\n      open={open}\n      onRequestClose={onClose}\n      maxWidth=\"sm\"\n    >\n      {error && (\n        <Line>\n          <Text>\n            <Trans>\n              Unable to start the server for the preview! Make sure that you are\n              authorized to run servers on this computer. Otherwise, use classic\n              preview to test your game.\n            </Trans>\n          </Text>\n        </Line>\n      )}\n      {!error && !urlWithProtocol && <PlaceholderLoader />}\n      {!error && urlWithProtocol && (\n        <div>\n          <Line>\n            <Text>\n              <Trans>\n                Your preview is ready! On your mobile or tablet, open your\n                browser and enter in the address bar:\n              </Trans>\n            </Text>\n          </Line>\n          <ShareLink url={urlWithProtocol} />\n          {urlWithProtocol && (\n            <>\n              <Line>\n                <Text>\n                  <Trans>Or flash this QR code:</Trans>\n                </Text>\n              </Line>\n              <Line justifyContent=\"center\">\n                <QrCode url={urlWithProtocol} size={isMobile ? 100 : 150} />\n              </Line>\n            </>\n          )}\n          <Line>\n            <Text>\n              <Trans>\n                Please note that your device should be connected on the same\n                network as this computer.\n              </Trans>\n            </Text>\n          </Line>\n        </div>\n      )}\n    </Dialog>\n  );\n};\n\nexport default LocalNetworkPreviewDialog;\n","// @flow\nimport optionalRequire from '../../../Utils/OptionalRequire';\nimport {\n  type PreviewDebuggerServerCallbacks,\n  type PreviewDebuggerServer,\n  type DebuggerId,\n  type ServerAddress,\n} from '../../PreviewLauncher.flow';\nconst electron = optionalRequire('electron');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\n\nlet debuggerServerState: 'started' | 'stopped' = 'stopped';\nlet debuggerServerAddress: ?ServerAddress = null;\nconst callbacksList: Array<PreviewDebuggerServerCallbacks> = [];\nconst debuggerIds: Array<DebuggerId> = [];\nconst responseCallbacks = new Map<number, (value: Object) => void>();\nlet nextMessageWithResponseId = 1;\n\nlet embeddedGameFrameWindow: WindowProxy | null = null;\nlet isWindowMessageListenerRegistered = false;\n\nconst getExistingDebuggerIds = (): Array<DebuggerId> => [\n  ...debuggerIds,\n  ...(embeddedGameFrameWindow ? ['embedded-game-frame'] : []),\n];\n\nconst handleParsedMessage = (\n  id: DebuggerId,\n  parsedMessage: Object | null\n): void => {\n  if (!parsedMessage) return;\n\n  if (parsedMessage.messageId) {\n    const answerCallback = responseCallbacks.get(parsedMessage.messageId);\n    if (answerCallback) {\n      answerCallback(parsedMessage);\n      responseCallbacks.delete(parsedMessage.messageId);\n    } else {\n      console.warn(\n        `Discarding response for messageId=${\n          parsedMessage.messageId\n        } - already handled or invalid id.`\n      );\n    }\n  }\n\n  callbacksList.forEach(({ onHandleParsedMessage }) =>\n    onHandleParsedMessage({ id, parsedMessage })\n  );\n};\n\nconst notifyConnectionClosed = (id: DebuggerId) => {\n  callbacksList.forEach(({ onConnectionClosed }) =>\n    onConnectionClosed({\n      id,\n      debuggerIds: getExistingDebuggerIds(),\n    })\n  );\n};\n\nconst removeServerListeners = () => {\n  if (!ipcRenderer) return;\n\n  ipcRenderer.removeAllListeners('debugger-send-message-done');\n  ipcRenderer.removeAllListeners('debugger-error-received');\n  ipcRenderer.removeAllListeners('debugger-connection-closed');\n  ipcRenderer.removeAllListeners('debugger-connection-opened');\n  ipcRenderer.removeAllListeners('debugger-connection-errored');\n  ipcRenderer.removeAllListeners('debugger-start-server-done');\n  ipcRenderer.removeAllListeners('debugger-message-received');\n};\n\n/**\n * A debugger server implemented using Electron (this one is just a bridge to it,\n * communicating through events with it).\n */\nclass LocalPreviewDebuggerServer {\n  startServer() {\n    if (!ipcRenderer) return Promise.reject();\n    if (debuggerServerState === 'started') return Promise.resolve();\n\n    if (!isWindowMessageListenerRegistered) {\n      window.addEventListener('message', event => {\n        if (!embeddedGameFrameWindow) return;\n        if (event.source !== embeddedGameFrameWindow) return;\n\n        let parsedMessage = null;\n        try {\n          parsedMessage = JSON.parse(event.data);\n        } catch (error) {\n          console.warn(\n            'Error while parsing a message received from the embedded game frame:',\n            error\n          );\n        }\n\n        handleParsedMessage('embedded-game-frame', parsedMessage);\n      });\n      isWindowMessageListenerRegistered = true;\n    }\n\n    const serverStartPromise = new Promise((resolve, reject) => {\n      let serverStartPromiseCompleted = false;\n      debuggerServerState = 'stopped';\n      debuggerServerAddress = null;\n      removeServerListeners();\n\n      ipcRenderer.on('debugger-error-received', (event, err) => {\n        if (!serverStartPromiseCompleted) {\n          reject(err);\n          serverStartPromiseCompleted = true;\n        }\n\n        callbacksList.forEach(({ onErrorReceived }) => onErrorReceived(err));\n      });\n\n      ipcRenderer.on('debugger-connection-closed', (event, { id }) => {\n        const debuggerIdIndex = debuggerIds.indexOf(id);\n        if (debuggerIdIndex !== -1) debuggerIds.splice(debuggerIdIndex, 1);\n\n        notifyConnectionClosed(id);\n      });\n\n      ipcRenderer.on('debugger-connection-opened', (event, { id }) => {\n        debuggerIds.push(id);\n        callbacksList.forEach(({ onConnectionOpened }) =>\n          onConnectionOpened({\n            id,\n            debuggerIds: getExistingDebuggerIds(),\n          })\n        );\n      });\n\n      ipcRenderer.on(\n        'debugger-connection-errored',\n        (event, { id, errorMessage }) => {\n          callbacksList.forEach(({ onConnectionErrored }) =>\n            onConnectionErrored({\n              id,\n              errorMessage,\n            })\n          );\n        }\n      );\n\n      ipcRenderer.on('debugger-start-server-done', (event, { address }) => {\n        console.info('Local preview debugger started');\n        debuggerServerState = 'started';\n        debuggerServerAddress = address;\n        if (!serverStartPromiseCompleted) {\n          resolve();\n          serverStartPromiseCompleted = true;\n        }\n\n        callbacksList.forEach(({ onServerStateChanged }) =>\n          onServerStateChanged()\n        );\n      });\n\n      ipcRenderer.on('debugger-message-received', (event, { id, message }) => {\n        let parsedMessage = null;\n        try {\n          parsedMessage = JSON.parse(message);\n        } catch (e) {\n          console.warn(\n            'Error while parsing message received from debugger client:',\n            e\n          );\n        }\n\n        handleParsedMessage(id, parsedMessage);\n      });\n      ipcRenderer.send('debugger-start-server');\n    });\n\n    // Consider the start of the server as a failure if not completed/errored\n    // after 5s.\n    const serverStartTimeoutPromise = new Promise((resolve, reject) => {\n      setTimeout(() => {\n        reject(\n          new Error(\n            'Debugger server not started or errored after 5s - aborting.'\n          )\n        );\n      }, 5000);\n    });\n    return Promise.race([serverStartPromise, serverStartTimeoutPromise]);\n  }\n  sendMessage(id: DebuggerId, message: Object) {\n    if (id === 'embedded-game-frame') {\n      if (!embeddedGameFrameWindow) {\n        console.error(\n          'Cannot send message to the embedded game frame as it is not registered.'\n        );\n        return;\n      }\n\n      embeddedGameFrameWindow.postMessage(message, '*');\n      return;\n    }\n\n    if (!ipcRenderer) return;\n    if (debuggerServerState === 'stopped') {\n      console.error('Cannot send message when debugger server is stopped.');\n      return;\n    }\n\n    ipcRenderer.send('debugger-send-message', {\n      id,\n      message: JSON.stringify(message),\n    });\n  }\n  sendMessageWithResponse(message: Object): Promise<Object> {\n    const messageId = nextMessageWithResponseId;\n    nextMessageWithResponseId++;\n    for (const id of getExistingDebuggerIds()) {\n      this.sendMessage(id, { ...message, messageId });\n    }\n\n    const timeout = 1000;\n    const promise = new Promise<Object>((resolve, reject) => {\n      responseCallbacks.set(messageId, resolve);\n      setTimeout(() => {\n        reject(\n          new Error(\n            `Timeout while waiting for response from the debugger(s) for message with id ${messageId}.`\n          )\n        );\n        responseCallbacks.delete(messageId);\n      }, timeout);\n    });\n    return promise;\n  }\n  getServerState() {\n    return debuggerServerState;\n  }\n  getExistingDebuggerIds() {\n    return getExistingDebuggerIds();\n  }\n  registerCallbacks(callbacks: PreviewDebuggerServerCallbacks) {\n    callbacksList.push(callbacks);\n\n    return () => {\n      const callbacksIndex = callbacksList.indexOf(callbacks);\n      if (callbacksIndex !== -1) callbacksList.splice(callbacksIndex, 1);\n    };\n  }\n  registerEmbeddedGameFrame(embeddedWindow: WindowProxy) {\n    if (embeddedWindow === embeddedGameFrameWindow) return;\n\n    if (embeddedGameFrameWindow) {\n      console.warn(\n        'An embedded game frame window was already registered. It will be replaced by the new one.'\n      );\n    }\n\n    embeddedGameFrameWindow = embeddedWindow;\n    callbacksList.forEach(({ onConnectionOpened }) =>\n      onConnectionOpened({\n        id: 'embedded-game-frame',\n        debuggerIds: getExistingDebuggerIds(),\n      })\n    );\n  }\n  unregisterEmbeddedGameFrame(embeddedWindow: WindowProxy) {\n    if (embeddedGameFrameWindow !== embeddedWindow) {\n      if (!!embeddedGameFrameWindow) {\n        console.warn(\n          'The embedded game frame window to unregister is not the same as the one registered. Ignoring the unregistration.'\n        );\n      }\n      return;\n    }\n\n    embeddedGameFrameWindow = null;\n    notifyConnectionClosed('embedded-game-frame');\n  }\n  closeAllConnections() {\n    const previousDebuggerIds = [...debuggerIds];\n    debuggerIds.length = 0;\n\n    previousDebuggerIds.forEach(id => {\n      notifyConnectionClosed(id);\n    });\n\n    responseCallbacks.clear();\n\n    if (ipcRenderer && previousDebuggerIds.length) {\n      ipcRenderer.send('debugger-close-all-connections');\n    }\n\n    if (embeddedGameFrameWindow) {\n      embeddedGameFrameWindow = null;\n      notifyConnectionClosed('embedded-game-frame');\n    }\n  }\n}\n\nexport const localPreviewDebuggerServer: PreviewDebuggerServer = new LocalPreviewDebuggerServer();\n\nexport const getDebuggerServerAddress = (): ?ServerAddress =>\n  debuggerServerAddress;\n","// @flow\nimport { Trans } from '@lingui/macro';\n\nimport * as React from 'react';\nimport LocalFileSystem from '../LocalFileSystem';\nimport optionalRequire from '../../../Utils/OptionalRequire';\nimport { findGDJS } from '../../../GameEngineFinder/LocalGDJSFinder';\nimport LocalNetworkPreviewDialog from './LocalNetworkPreviewDialog';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type PreviewOptions,\n  type PreviewLauncherProps,\n  type CaptureOptions,\n} from '../../PreviewLauncher.flow';\nimport SubscriptionChecker, {\n  type SubscriptionCheckerInterface,\n} from '../../../Profile/Subscription/SubscriptionChecker';\nimport {\n  getDebuggerServerAddress,\n  localPreviewDebuggerServer,\n} from './LocalPreviewDebuggerServer';\nimport Window from '../../../Utils/Window';\nimport { getIDEVersionWithHash } from '../../../Version';\nimport { setEmbeddedGameFramePreviewLocation } from '../../../EmbeddedGame/EmbeddedGameFrame';\nconst electron = optionalRequire('electron');\nconst path = optionalRequire('path');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\nconst gd: libGDevelop = global.gd;\n\ntype State = {|\n  networkPreviewDialogOpen: boolean,\n  networkPreviewHost: ?string,\n  networkPreviewPort: ?number,\n  networkPreviewError: ?any,\n  hotReloadsCount: number,\n  previewGamePath: ?string,\n  previewBrowserWindowOptions: ?{\n    width: number,\n    height: number,\n    useContentSize: boolean,\n    title: string,\n    backgroundColor: string,\n  },\n  hideMenuBar: boolean,\n  alwaysOnTop: boolean,\n  numberOfWindows: number,\n  captureOptions: ?CaptureOptions,\n|};\n\nconst prepareExporter = async ({\n  isForInGameEdition,\n}: {\n  isForInGameEdition: boolean,\n}): Promise<{|\n  outputDir: string,\n  exporter: gdjsExporter,\n  gdjsRoot: string,\n|}> => {\n  const { gdjsRoot } = await findGDJS();\n  console.info('GDJS found in ', gdjsRoot);\n\n  const localFileSystem = new LocalFileSystem({\n    downloadUrlsToLocalFiles: false,\n  });\n  const fileSystem = assignIn(new gd.AbstractFileSystemJS(), localFileSystem);\n  const outputDir = path.join(\n    fileSystem.getTempDir(),\n    isForInGameEdition ? 'in-game-editor-preview' : 'preview'\n  );\n  const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n  return {\n    outputDir,\n    exporter,\n    gdjsRoot,\n  };\n};\n\nexport default class LocalPreviewLauncher extends React.Component<\n  PreviewLauncherProps,\n  State\n> {\n  canDoNetworkPreview = () => true;\n\n  state = {\n    networkPreviewDialogOpen: false,\n    networkPreviewHost: null,\n    networkPreviewPort: null,\n    networkPreviewError: null,\n    previewGamePath: null,\n    previewBrowserWindowOptions: null,\n    hotReloadsCount: 0,\n    hideMenuBar: true,\n    alwaysOnTop: true,\n    numberOfWindows: 1,\n    captureOptions: null,\n  };\n  _networkPreviewSubscriptionChecker: ?SubscriptionCheckerInterface = null;\n  _hotReloadSubscriptionChecker: ?SubscriptionCheckerInterface = null;\n\n  _openPreviewBrowserWindow = () => {\n    const {\n      previewGamePath,\n      previewBrowserWindowOptions,\n      captureOptions,\n      alwaysOnTop,\n      hideMenuBar,\n      numberOfWindows,\n    } = this.state;\n    if (!previewBrowserWindowOptions || !previewGamePath) return;\n\n    if (!ipcRenderer) return;\n\n    ipcRenderer.invoke('preview-open', {\n      previewBrowserWindowOptions,\n      previewGameIndexHtmlPath: `file://${previewGamePath}/index.html`,\n      alwaysOnTop,\n      hideMenuBar,\n      numberOfWindows,\n      captureOptions,\n    });\n\n    ipcRenderer.removeAllListeners('preview-window-closed');\n    ipcRenderer.on('preview-window-closed', async event => {\n      if (captureOptions) {\n        await this.props.onCaptureFinished(captureOptions);\n      }\n    });\n  };\n\n  closePreview = (windowId: number) => {\n    if (!ipcRenderer) return;\n    ipcRenderer.invoke('preview-close', { windowId });\n  };\n\n  closeAllPreviews = () => {\n    if (ipcRenderer) {\n      ipcRenderer.invoke('preview-close-all').catch(error => {\n        console.info('Unable to close all preview windows - ignoring.', error);\n      });\n    }\n\n    // This should be unnecessary since the preview windows are closed above.\n    const previewDebuggerServer = this.getPreviewDebuggerServer();\n    if (previewDebuggerServer) {\n      previewDebuggerServer.closeAllConnections();\n    }\n  };\n\n  _openPreviewWindow = (\n    project: gdProject,\n    gamePath: string,\n    options: PreviewOptions\n  ): void => {\n    this.setState(\n      {\n        previewBrowserWindowOptions: {\n          width: project.getGameResolutionWidth(),\n          height: project.getGameResolutionHeight(),\n          useContentSize: true,\n          title: `Preview of ${project.getName()}`,\n          backgroundColor: '#000000',\n          webPreferences: {\n            webSecurity: false, // Allow to access to local files,\n            // Allow Node.js API access in renderer process, as long\n            // as we've not removed dependency on it and on \"@electron/remote\".\n            nodeIntegration: true,\n            contextIsolation: false,\n          },\n        },\n        previewGamePath: gamePath,\n        hideMenuBar: !options.getIsMenuBarHiddenInPreview(),\n        alwaysOnTop: options.getIsAlwaysOnTopInPreview(),\n        numberOfWindows: options.numberOfWindows,\n        captureOptions: options.captureOptions,\n      },\n      () => {\n        if (!options.networkPreview) {\n          this._openPreviewBrowserWindow();\n        } else {\n          if (!ipcRenderer) return;\n\n          ipcRenderer.removeAllListeners('serve-folder-done');\n          ipcRenderer.removeAllListeners('local-network-ips');\n          ipcRenderer.on('serve-folder-done', (event, err, serverParams) => {\n            if (err) {\n              this.setState({\n                networkPreviewDialogOpen: true,\n                networkPreviewPort: null,\n                networkPreviewHost: null,\n                networkPreviewError: err,\n              });\n            } else {\n              this.setState({\n                networkPreviewDialogOpen: true,\n                networkPreviewPort: serverParams.port,\n              });\n            }\n\n            setTimeout(() => this._checkSubscriptionForNetworkPreview());\n          });\n          ipcRenderer.on('local-network-ip', (event, ipAddress) => {\n            this.setState({\n              networkPreviewHost: ipAddress,\n            });\n          });\n          ipcRenderer.send('serve-folder', {\n            root: gamePath,\n          });\n          ipcRenderer.send('get-local-network-ip');\n        }\n      }\n    );\n  };\n\n  launchPreview = async (previewOptions: PreviewOptions): Promise<any> => {\n    const {\n      project,\n      sceneName,\n      externalLayoutName,\n      eventsBasedObjectType,\n      eventsBasedObjectVariantName,\n    } = previewOptions;\n\n    // Start the debugger server for previews. Even if not used,\n    // useful if the user opens the Debugger editor later, or want to\n    // hot reload.\n    try {\n      await this.getPreviewDebuggerServer().startServer({});\n    } catch (err) {\n      console.error(\n        'Unable to start the Debugger Server for the preview:',\n        err\n      );\n    }\n\n    const { outputDir, exporter, gdjsRoot } = await prepareExporter({\n      isForInGameEdition: previewOptions.isForInGameEdition,\n    });\n\n    var previewStartTime = performance.now();\n\n    const previewExportOptions = new gd.PreviewExportOptions(\n      project,\n      outputDir\n    );\n    previewExportOptions.setIsDevelopmentEnvironment(Window.isDev());\n    previewExportOptions.setLayoutName(sceneName);\n    previewExportOptions.setIsInGameEdition(previewOptions.isForInGameEdition);\n    previewExportOptions.setEditorId(previewOptions.editorId || '');\n    if (externalLayoutName) {\n      previewExportOptions.setExternalLayoutName(externalLayoutName);\n    }\n    if (eventsBasedObjectType) {\n      previewExportOptions.setEventsBasedObjectType(eventsBasedObjectType);\n      previewExportOptions.setEventsBasedObjectVariantName(\n        eventsBasedObjectVariantName || ''\n      );\n    }\n\n    if (previewOptions.isForInGameEdition) {\n      previewExportOptions.useWindowMessageDebuggerClient();\n    } else {\n      const previewDebuggerServerAddress = getDebuggerServerAddress();\n      if (previewDebuggerServerAddress) {\n        previewExportOptions.useWebsocketDebuggerClientWithServerAddress(\n          previewDebuggerServerAddress.address,\n          '' + previewDebuggerServerAddress.port\n        );\n      }\n    }\n\n    const includeFileHashs = this.props.getIncludeFileHashs();\n    for (const includeFile in includeFileHashs) {\n      const hash = includeFileHashs[includeFile];\n      previewExportOptions.setIncludeFileHash(includeFile, hash);\n    }\n\n    // Give the preview the path to the \"@electron/remote\" module of the editor,\n    // as this is required by some features and we've not removed dependency\n    // on \"@electron/remote\" yet.\n    previewExportOptions.setElectronRemoteRequirePath(\n      path.join(\n        gdjsRoot,\n        '../preview_node_modules',\n        '@electron/remote',\n        'renderer/index.js'\n      )\n    );\n\n    // TODO Filter according to isForInGameEdition because the first game preview\n    // won't necessarily be the first debugger.\n    // It doesn't have any side effect because when it wont actually do an hot-reload\n    // since the game preview doesn't exist yet.\n    const debuggerIds = this.getPreviewDebuggerServer().getExistingDebuggerIds();\n    const shouldHotReload = previewOptions.hotReload && !!debuggerIds.length;\n    if (shouldHotReload) {\n      previewExportOptions.setShouldClearExportFolder(\n        previewOptions.shouldHardReload\n      );\n      // At hot-reload, the ProjectData are passed into the message.\n      // It means that we don't need to write them in a file.\n      previewExportOptions.setShouldReloadProjectData(false);\n      previewExportOptions.setShouldReloadLibraries(\n        previewOptions.shouldReloadLibraries ||\n          previewOptions.shouldGenerateScenesEventsCode\n      );\n      previewExportOptions.setShouldGenerateScenesEventsCode(\n        previewOptions.shouldGenerateScenesEventsCode\n      );\n    }\n\n    previewExportOptions.setFullLoadingScreen(previewOptions.fullLoadingScreen);\n    previewExportOptions.setGDevelopVersionWithHash(getIDEVersionWithHash());\n    previewExportOptions.setCrashReportUploadLevel(\n      this.props.crashReportUploadLevel\n    );\n    previewExportOptions.setPreviewContext(this.props.previewContext);\n    previewExportOptions.setProjectTemplateSlug(project.getTemplateSlug());\n    previewExportOptions.setSourceGameId(this.props.sourceGameId);\n\n    if (previewOptions.inAppTutorialMessageInPreview) {\n      previewExportOptions.setInAppTutorialMessageInPreview(\n        previewOptions.inAppTutorialMessageInPreview,\n        previewOptions.inAppTutorialMessagePositionInPreview\n      );\n    }\n\n    if (previewOptions.fallbackAuthor) {\n      previewExportOptions.setFallbackAuthor(\n        previewOptions.fallbackAuthor.id,\n        previewOptions.fallbackAuthor.username\n      );\n    }\n    if (previewOptions.authenticatedPlayer) {\n      previewExportOptions.setAuthenticatedPlayer(\n        previewOptions.authenticatedPlayer.playerId,\n        previewOptions.authenticatedPlayer.playerUsername,\n        previewOptions.authenticatedPlayer.playerToken\n      );\n    }\n    if (previewOptions.captureOptions) {\n      if (previewOptions.captureOptions.screenshots) {\n        previewOptions.captureOptions.screenshots.forEach(screenshot => {\n          previewExportOptions.addScreenshotCapture(\n            screenshot.delayTimeInSeconds,\n            screenshot.signedUrl,\n            screenshot.publicUrl\n          );\n        });\n      }\n    }\n    if (previewOptions.editorCameraState3D) {\n      previewExportOptions.setEditorCameraState3D(\n        previewOptions.editorCameraState3D.cameraMode,\n        previewOptions.editorCameraState3D.positionX,\n        previewOptions.editorCameraState3D.positionY,\n        previewOptions.editorCameraState3D.positionZ,\n        previewOptions.editorCameraState3D.rotationAngle,\n        previewOptions.editorCameraState3D.elevationAngle,\n        previewOptions.editorCameraState3D.distance\n      );\n    }\n    if (previewOptions.inGameEditorSettings) {\n      previewExportOptions.setInGameEditorSettingsJson(\n        JSON.stringify(previewOptions.inGameEditorSettings)\n      );\n    }\n\n    exporter.exportProjectForPixiPreview(previewExportOptions);\n\n    if (shouldHotReload) {\n      const projectDataElement = new gd.SerializerElement();\n      exporter.serializeProjectData(\n        project,\n        previewExportOptions,\n        projectDataElement\n      );\n      const projectData = JSON.parse(gd.Serializer.toJSON(projectDataElement));\n      projectDataElement.delete();\n\n      const runtimeGameOptionsElement = new gd.SerializerElement();\n      exporter.serializeRuntimeGameOptions(\n        previewExportOptions,\n        runtimeGameOptionsElement\n      );\n      const runtimeGameOptions = JSON.parse(\n        gd.Serializer.toJSON(runtimeGameOptionsElement)\n      );\n      runtimeGameOptionsElement.delete();\n\n      if (previewOptions.shouldHardReload) {\n        debuggerIds.forEach(debuggerId => {\n          this.getPreviewDebuggerServer().sendMessage(debuggerId, {\n            command: 'hardReload',\n          });\n        });\n      } else {\n        debuggerIds.forEach(debuggerId => {\n          this.getPreviewDebuggerServer().sendMessage(debuggerId, {\n            command: 'hotReload',\n            payload: {\n              shouldReloadResources: previewOptions.shouldReloadResources,\n              projectData,\n              runtimeGameOptions,\n            },\n          });\n        });\n      }\n      if (!previewOptions.isForInGameEdition) {\n        if (\n          this.state.hotReloadsCount % 16 === 0 &&\n          this._hotReloadSubscriptionChecker\n        ) {\n          this._hotReloadSubscriptionChecker.checkUserHasSubscription();\n        }\n        this.setState(state => ({\n          hotReloadsCount: state.hotReloadsCount + 1,\n        }));\n      }\n    } else {\n      if (previewOptions.isForInGameEdition) {\n        setEmbeddedGameFramePreviewLocation({\n          previewIndexHtmlLocation: `file://${outputDir}/index.html`,\n        });\n      }\n\n      if (previewOptions.numberOfWindows >= 1) {\n        this._openPreviewWindow(project, outputDir, previewOptions);\n      }\n    }\n\n    exporter.delete();\n    previewExportOptions.delete();\n\n    const previewStopTime = performance.now();\n    console.info(`Preview took ${previewStopTime - previewStartTime}ms`);\n  };\n\n  getPreviewDebuggerServer() {\n    return localPreviewDebuggerServer;\n  }\n\n  _checkSubscriptionForNetworkPreview = () => {\n    if (!this._networkPreviewSubscriptionChecker) return true;\n\n    return this._networkPreviewSubscriptionChecker.checkUserHasSubscription();\n  };\n\n  render() {\n    const {\n      networkPreviewDialogOpen,\n      networkPreviewHost,\n      networkPreviewPort,\n      networkPreviewError,\n    } = this.state;\n\n    return (\n      <React.Fragment>\n        <SubscriptionChecker\n          ref={subscriptionChecker =>\n            (this._networkPreviewSubscriptionChecker = subscriptionChecker)\n          }\n          onChangeSubscription={() =>\n            this.setState({ networkPreviewDialogOpen: false })\n          }\n          id=\"Preview over wifi\"\n          title={<Trans>Preview over wifi</Trans>}\n          placementId=\"preview-wifi\"\n          mode=\"try\"\n          isNotShownDuringInAppTutorial\n        />\n        <SubscriptionChecker\n          ref={subscriptionChecker =>\n            (this._hotReloadSubscriptionChecker = subscriptionChecker)\n          }\n          id=\"Hot reloading\"\n          title={\n            <Trans>Live preview (apply changes to the running preview)</Trans>\n          }\n          placementId=\"hot-reloading\"\n          mode=\"try\"\n          isNotShownDuringInAppTutorial\n        />\n        <LocalNetworkPreviewDialog\n          open={networkPreviewDialogOpen}\n          url={\n            networkPreviewHost && networkPreviewPort\n              ? `${networkPreviewHost}:${networkPreviewPort}`\n              : null\n          }\n          error={networkPreviewError}\n          onClose={() => this.setState({ networkPreviewDialogOpen: false })}\n          onExport={this.props.onExport}\n          onRunPreviewLocally={this._openPreviewBrowserWindow}\n        />\n      </React.Fragment>\n    );\n  }\n}\n","// @flow\nimport { Trans } from '@lingui/macro';\n\nimport React from 'react';\nimport RaisedButton from '../../UI/RaisedButton';\nimport { Column, Line } from '../../UI/Grid';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport LocalFolderPicker from '../../UI/LocalFolderPicker';\nimport assignIn from 'lodash/assignIn';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n  ExportFlow,\n} from '../GenericExporters/CordovaExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\n// It's important to use remote and not electron for folder actions,\n// otherwise they will be opened in the background.\n// See https://github.com/electron/electron/issues/4349#issuecomment-777475765\nconst remote = optionalRequire('@electron/remote');\nconst shell = remote ? remote.shell : null;\n\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = {\n  outputDir: string,\n};\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n|};\n\ntype ExportOutput = {|\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = null;\n\ntype CompressionOutput = null;\n\nconst exportPipelineName = 'local-cordova';\n\nexport const localCordovaExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n  packageNameWarningType: 'mobile',\n\n  getInitialExportState: (project: gdProject) => ({\n    outputDir: project.getLastCompilationDirectory(),\n  }),\n\n  canLaunchBuild: exportState => !!exportState.outputDir,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: ({ project, exportState, updateExportState, exportStep }) =>\n    exportStep !== 'done' ? (\n      <Column noMargin>\n        <Line>\n          <Column noMargin>\n            <ExplanationHeader />\n          </Column>\n        </Line>\n        <Line>\n          <LocalFolderPicker\n            type=\"export\"\n            value={exportState.outputDir}\n            defaultPath={project.getLastCompilationDirectory()}\n            onChange={outputDir => {\n              updateExportState(() => ({ outputDir }));\n              project.setLastCompilationDirectory(outputDir);\n            }}\n            fullWidth\n          />\n        </Line>\n      </Column>\n    ) : null,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      // TODO: Memory leak? Check for other exporters too.\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        localFileSystem,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      context.exportState.outputDir\n    );\n    exportOptions.setTarget('cordova');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      urlFiles: localFileSystem.getAllUrlFilesIn(context.exportState.outputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return null;\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    exportOutput: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    return Promise.resolve(null);\n  },\n\n  renderDoneFooter: ({ exportState }) => {\n    const openExportFolder = () => {\n      if (shell) shell.openPath(exportState.outputDir);\n    };\n\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <RaisedButton\n            key=\"open\"\n            label={<Trans>Open folder</Trans>}\n            primary={true}\n            onClick={openExportFolder}\n          />\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport { Trans } from '@lingui/macro';\n\nimport React from 'react';\nimport RaisedButton from '../../UI/RaisedButton';\nimport { Column, Line } from '../../UI/Grid';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport LocalFolderPicker from '../../UI/LocalFolderPicker';\nimport assignIn from 'lodash/assignIn';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n  ExportFlow,\n} from '../GenericExporters/ElectronExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\n// It's important to use remote and not electron for folder actions,\n// otherwise they will be opened in the background.\n// See https://github.com/electron/electron/issues/4349#issuecomment-777475765\nconst remote = optionalRequire('@electron/remote');\nconst shell = remote ? remote.shell : null;\n\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = {\n  outputDir: string,\n};\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n|};\n\ntype ExportOutput = {|\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = null;\n\ntype CompressionOutput = null;\n\nconst exportPipelineName = 'local-electron';\n\nexport const localElectronExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n  packageNameWarningType: 'desktop',\n\n  getInitialExportState: (project: gdProject) => ({\n    outputDir: project.getLastCompilationDirectory(),\n  }),\n\n  canLaunchBuild: exportState => !!exportState.outputDir,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: ({ project, exportState, updateExportState, exportStep }) =>\n    exportStep !== 'done' ? (\n      <Column noMargin expand>\n        <Line>\n          <Column noMargin>\n            <ExplanationHeader />\n          </Column>\n        </Line>\n        <Line>\n          <LocalFolderPicker\n            type=\"export\"\n            value={exportState.outputDir}\n            defaultPath={project.getLastCompilationDirectory()}\n            onChange={outputDir => {\n              updateExportState(() => ({ outputDir }));\n              project.setLastCompilationDirectory(outputDir);\n            }}\n            fullWidth\n          />\n        </Line>\n      </Column>\n    ) : null,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      // TODO: Memory leak? Check for other exporters too.\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        localFileSystem,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      context.exportState.outputDir\n    );\n    exportOptions.setTarget('electron');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      urlFiles: localFileSystem.getAllUrlFilesIn(context.exportState.outputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return null;\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    exportOutput: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    return Promise.resolve(null);\n  },\n\n  renderDoneFooter: ({ exportState }) => {\n    const openExportFolder = () => {\n      if (shell) shell.openPath(exportState.outputDir);\n    };\n\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <RaisedButton\n            key=\"open\"\n            label={<Trans>Open folder</Trans>}\n            primary={true}\n            onClick={openExportFolder}\n          />\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport { Trans } from '@lingui/macro';\n\nimport React from 'react';\nimport RaisedButton from '../../UI/RaisedButton';\nimport { Column, Line } from '../../UI/Grid';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport LocalFolderPicker from '../../UI/LocalFolderPicker';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n  ExportFlow,\n} from '../GenericExporters/HTML5Export';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\nimport DismissableTutorialMessage from '../../Hints/DismissableTutorialMessage';\n\n// It's important to use remote and not electron for folder actions,\n// otherwise they will be opened in the background.\n// See https://github.com/electron/electron/issues/4349#issuecomment-777475765\nconst remote = optionalRequire('@electron/remote');\nconst shell = remote ? remote.shell : null;\n\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = {\n  outputDir: string,\n};\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n|};\n\ntype ExportOutput = {|\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = null;\n\ntype CompressionOutput = null;\n\nconst exportPipelineName = 'local-html5';\n\nexport const localHTML5ExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n\n  getInitialExportState: (project: gdProject) => ({\n    outputDir: project.getLastCompilationDirectory(),\n  }),\n\n  canLaunchBuild: exportState => !!exportState.outputDir,\n\n  isNavigationDisabled: () => false,\n\n  renderTutorial: () => (\n    <DismissableTutorialMessage tutorialId=\"export-to-itch\" />\n  ),\n\n  renderHeader: ({ project, exportState, updateExportState, exportStep }) =>\n    exportStep !== 'done' ? (\n      <Column noMargin expand>\n        <Line>\n          <ExplanationHeader />\n        </Line>\n        <Line>\n          <LocalFolderPicker\n            type=\"export\"\n            value={exportState.outputDir}\n            defaultPath={project.getLastCompilationDirectory()}\n            onChange={outputDir => {\n              updateExportState(() => ({ outputDir }));\n              project.setLastCompilationDirectory(outputDir);\n            }}\n            fullWidth\n          />\n        </Line>\n      </Column>\n    ) : null,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      // TODO: Memory leak? Check for other exporters too.\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        localFileSystem,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      context.exportState.outputDir\n    );\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      urlFiles: localFileSystem.getAllUrlFilesIn(context.exportState.outputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return null;\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    exportOutput: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    return Promise.resolve(null);\n  },\n\n  renderDoneFooter: ({ exportState }) => {\n    const openExportFolder = () => {\n      if (shell) shell.openPath(exportState.outputDir);\n    };\n\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <RaisedButton\n            primary\n            onClick={() => openExportFolder()}\n            label={<Trans>Open the exported game folder</Trans>}\n          />\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport { Trans } from '@lingui/macro';\nimport { t } from '@lingui/macro';\n\nimport * as React from 'react';\nimport TextField from '../TextField';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport FlatButton from '../FlatButton';\nconst electron = optionalRequire('electron');\nconst remote = optionalRequire('@electron/remote');\nconst dialog = remote ? remote.dialog : null;\n\nconst styles = {\n  container: {\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'baseline',\n  },\n  button: {\n    marginLeft: 10,\n  },\n  textField: {\n    flex: 1,\n  },\n};\n\ntype Props = {|\n  value: string,\n  onChange: string => void,\n  title: string,\n  message: string,\n  defaultPath?: string,\n  fullWidth?: boolean,\n  filters: Array<{\n    name: string,\n    extensions: Array<string>,\n  }>,\n|};\n\nconst LocalFilePicker = ({\n  value,\n  onChange,\n  title,\n  message,\n  defaultPath,\n  fullWidth,\n  filters,\n}: Props) => {\n  const onChooseFolder = async () => {\n    if (!dialog || !electron) return;\n\n    const browserWindow = remote.getCurrentWindow();\n    const { filePath } = await dialog.showSaveDialog(browserWindow, {\n      title: title,\n      filters: filters,\n      message: message,\n      defaultPath: defaultPath,\n    });\n    onChange(filePath || '');\n  };\n\n  return (\n    <div\n      style={{\n        ...styles.container,\n        width: fullWidth ? '100%' : undefined,\n      }}\n    >\n      <TextField\n        margin=\"dense\"\n        style={styles.textField}\n        type=\"text\"\n        translatableHintText={t`Choose a file`}\n        value={value}\n        onChange={(event, value) => onChange(value)}\n      />\n      <FlatButton\n        label={<Trans>Choose</Trans>}\n        style={styles.button}\n        onClick={onChooseFolder}\n      />\n    </div>\n  );\n};\n\nexport default LocalFilePicker;\n","//@flow\nimport optionalRequire from './OptionalRequire';\n\n/**\n * Return a function that will load, only when called, the specified module name.\n *\n * As `optionalRequire`, this allows to require a Node.js/npm module without having it bundled by webpack.\n * This means that this module will only be available when running on Electron or Node.js.\n * When running without Electron or Node.js, `null` will be returned.\n */\nexport default function optionalLazyRequire(moduleName: string) {\n  let moduleLoaded = false;\n  let module = undefined;\n  return (): ?any => {\n    if (moduleLoaded) {\n      return module;\n    }\n\n    console.info(`Lazy loading ${moduleName}...`);\n    module = optionalRequire(moduleName);\n    moduleLoaded = true;\n    return module;\n  };\n}\n","// @flow\n\nimport optionalRequire from './OptionalRequire';\nimport optionalLazyRequire from '../Utils/OptionalLazyRequire';\nconst fs = optionalRequire('fs');\nconst lazyRequireArchiver = optionalLazyRequire('archiver');\n\n// TODO: Move in a Archiver folder?\n/**\n * Archive the given folder to a file. Only available when running on Electron runtime.\n */\nexport const archiveLocalFolder = ({\n  path,\n  outputFilename,\n  sizeLimit,\n}: {|\n  path: string,\n  outputFilename: string,\n  sizeLimit?: number,\n|}): Promise<string> => {\n  const archiver = lazyRequireArchiver();\n  return new Promise((resolve, reject) => {\n    if (!fs || !archiver) return reject(new Error('Archiver unavailable'));\n\n    const output = fs.createWriteStream(outputFilename);\n    const archive = archiver('zip', {\n      zlib: { level: 9 }, // Sets the compression level.\n    });\n\n    output.on('close', () => {\n      const fileSize = archive.pointer();\n      console.log(\n        `Archive written at ${outputFilename}, ${fileSize} total bytes.`\n      );\n      if (sizeLimit && fileSize > sizeLimit) {\n        const roundFileSizeInMb = Math.round(fileSize / (1000 * 1000));\n        reject(\n          new Error(\n            `Archive is of size ${roundFileSizeInMb} MB, which is above the limit allowed of ${sizeLimit /\n              (1000 * 1000)} MB.`\n          )\n        );\n      }\n      resolve(outputFilename);\n    });\n\n    archive.on('error', err => {\n      reject(err);\n    });\n\n    archive.pipe(output);\n\n    archive.directory(path, false);\n\n    archive.finalize();\n  });\n};\n","// @flow\nimport { Trans } from '@lingui/macro';\n\nimport React from 'react';\nimport RaisedButton from '../../UI/RaisedButton';\nimport { Column, Line } from '../../UI/Grid';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport assignIn from 'lodash/assignIn';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport LocalFilePicker from '../../UI/LocalFilePicker';\nimport { archiveLocalFolder } from '../../Utils/LocalArchiver';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n  ExportFlow,\n} from '../GenericExporters/FacebookInstantGamesExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\n\nconst path = optionalRequire('path');\n// It's important to use remote and not electron for folder actions,\n// otherwise they will be opened in the background.\n// See https://github.com/electron/electron/issues/4349#issuecomment-777475765\nconst remote = optionalRequire('@electron/remote');\nconst app = remote ? remote.app : null;\nconst shell = remote ? remote.shell : null;\n\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = {\n  archiveOutputFilename: string,\n};\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n  temporaryOutputDir: string,\n|};\n\ntype ExportOutput = {|\n  temporaryOutputDir: string,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  temporaryOutputDir: string,\n|};\n\ntype CompressionOutput = string;\n\nconst exportPipelineName = 'local-facebook-instant-games';\n\nexport const localFacebookInstantGamesExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n\n  getInitialExportState: (project: gdProject) => ({\n    archiveOutputFilename: app\n      ? path.join(app.getPath('documents'), 'fb-instant-game.zip')\n      : '',\n  }),\n\n  canLaunchBuild: exportState => !!exportState.archiveOutputFilename,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: ({ project, exportState, updateExportState, exportStep }) =>\n    exportStep !== 'done' ? (\n      <Column noMargin expand>\n        <Line>\n          <ExplanationHeader />\n        </Line>\n        <Line>\n          <LocalFilePicker\n            title={'Facebook Instant Games export zip file'}\n            message={\n              'Choose where to save the exported file for Facebook Instant Games'\n            }\n            filters={[\n              {\n                name: 'Compressed file for Facebook Instant Games',\n                extensions: ['zip'],\n              },\n            ]}\n            value={exportState.archiveOutputFilename}\n            defaultPath={app ? app.getPath('documents') : ''}\n            onChange={value =>\n              updateExportState(() => ({ archiveOutputFilename: value }))\n            }\n            fullWidth\n          />\n        </Line>\n      </Column>\n    ) : null,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      // TODO: Memory leak? Check for other exporters too.\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n      const temporaryOutputDir = path.join(\n        fileSystem.getTempDir(),\n        'FacebookInstantGamesExport'\n      );\n      fileSystem.mkDir(temporaryOutputDir);\n      fileSystem.clearDir(temporaryOutputDir);\n\n      return {\n        exporter,\n        localFileSystem,\n        temporaryOutputDir,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem, temporaryOutputDir }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      temporaryOutputDir\n    );\n    exportOptions.setTarget('facebookInstantGames');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      temporaryOutputDir,\n      urlFiles: localFileSystem.getAllUrlFilesIn(temporaryOutputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return { temporaryOutputDir };\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir }: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    return archiveLocalFolder({\n      path: temporaryOutputDir,\n      outputFilename: context.exportState.archiveOutputFilename,\n    });\n  },\n\n  renderDoneFooter: ({ exportState }) => {\n    const openExportFolder = () => {\n      if (shell && path)\n        shell.openPath(path.dirname(exportState.archiveOutputFilename));\n    };\n\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <RaisedButton\n            key=\"open\"\n            label={<Trans>Open folder</Trans>}\n            primary={true}\n            onClick={openExportFolder}\n          />\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport optionalRequire from '../../Utils/OptionalRequire';\nconst electron = optionalRequire('electron');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\n\ntype UploadOptions = {\n  signedUrl: string,\n  contentType: string,\n};\n\nexport const uploadLocalFile = (\n  localFilePath: string,\n  uploadOptions: UploadOptions,\n  onProgress: (progress: number, total: number) => void\n): Promise<void> => {\n  if (!ipcRenderer) return Promise.reject('No support for local file upload');\n\n  ipcRenderer.removeAllListeners('local-file-upload-progress');\n  ipcRenderer.removeAllListeners('local-file-upload-done');\n\n  return new Promise((resolve, reject) => {\n    ipcRenderer.on(\n      'local-file-upload-progress',\n      (event, stepCurrentProgress, stepMaxProgress) => {\n        onProgress(stepCurrentProgress, stepMaxProgress);\n      }\n    );\n    ipcRenderer.on('local-file-upload-done', (event, err) => {\n      if (err) return reject(err);\n      resolve();\n    });\n    ipcRenderer.send('local-file-upload', localFilePath, uploadOptions);\n  });\n};\n","// @flow\nimport * as React from 'react';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildCordovaAndroid,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { uploadLocalFile } from './LocalFileUploader';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport { archiveLocalFolder } from '../../Utils/LocalArchiver';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  type ExportState,\n  SetupExportHeader,\n  ExportFlow,\n} from '../GenericExporters/OnlineCordovaExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\n\nconst path = optionalRequire('path');\nconst os = optionalRequire('os');\nconst gd: libGDevelop = global.gd;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n  temporaryOutputDir: string,\n|};\n\ntype ExportOutput = {|\n  temporaryOutputDir: string,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  temporaryOutputDir: string,\n|};\n\ntype CompressionOutput = string;\n\nconst exportPipelineName = 'local-online-cordova';\n\nexport const localOnlineCordovaExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n  onlineBuildType: 'cordova-build',\n  limitedBuilds: true,\n  packageNameWarningType: 'mobile',\n\n  getInitialExportState: () => ({\n    targets: ['androidApk'],\n    keystore: 'new',\n    signingDialogOpen: false,\n  }),\n\n  // Build can be launched only if just opened the dialog or build errored.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    errored || exportStep === '',\n\n  // Navigation is enabled when the build is errored or whilst uploading.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored &&\n    ['register', 'export', 'resources-download', 'compress', 'upload'].includes(\n      exportStep\n    ),\n\n  renderHeader: props => <SetupExportHeader {...props} />,\n\n  shouldSuggestBumpingVersionNumber: () => true,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n      const temporaryOutputDir = path.join(\n        fileSystem.getTempDir(),\n        'OnlineCordovaExport'\n      );\n      fileSystem.mkDir(temporaryOutputDir);\n      fileSystem.clearDir(temporaryOutputDir);\n\n      return {\n        exporter,\n        localFileSystem,\n        temporaryOutputDir,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem, temporaryOutputDir }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      temporaryOutputDir\n    );\n    exportOptions.setTarget('cordova');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      temporaryOutputDir,\n      urlFiles: localFileSystem.getAllUrlFilesIn(temporaryOutputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return { temporaryOutputDir };\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir }: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    const archiveOutputDir = os.tmpdir();\n    return archiveLocalFolder({\n      path: temporaryOutputDir,\n      outputFilename: path.join(archiveOutputDir, 'game-archive.zip'),\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    outputFile: CompressionOutput\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadLocalFile(\n        outputFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |},\n    payWithCredits: boolean\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, firebaseUser } = authenticatedUser;\n    if (!firebaseUser)\n      return Promise.reject(new Error('User is not authenticated'));\n\n    return buildCordovaAndroid(\n      getAuthorizationHeader,\n      firebaseUser.uid,\n      uploadBucketKey,\n      exportState.targets,\n      exportState.keystore,\n      gameId,\n      options,\n      payWithCredits\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildCordovaIos,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { uploadLocalFile } from './LocalFileUploader';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport { archiveLocalFolder } from '../../Utils/LocalArchiver';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  type ExportState,\n  SetupExportHeader,\n  ExportFlow,\n} from '../GenericExporters/OnlineCordovaIosExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\n\nconst path = optionalRequire('path');\nconst os = optionalRequire('os');\nconst gd: libGDevelop = global.gd;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n  temporaryOutputDir: string,\n|};\n\ntype ExportOutput = {|\n  temporaryOutputDir: string,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  temporaryOutputDir: string,\n|};\n\ntype CompressionOutput = string;\n\nconst exportPipelineName = 'local-online-cordova-ios';\n\nexport const localOnlineCordovaIosExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n  onlineBuildType: 'cordova-ios-build',\n  limitedBuilds: true,\n  packageNameWarningType: 'mobile',\n\n  getInitialExportState: () => ({\n    targets: ['iosAppStore'],\n    signing: null,\n  }),\n\n  // Build can be launched only if just opened the dialog or build errored.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    (errored || exportStep === '') && !!exportState.signing,\n\n  // Navigation is enabled when the build is errored or whilst uploading.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored &&\n    ['register', 'export', 'resources-download', 'compress', 'upload'].includes(\n      exportStep\n    ),\n\n  renderHeader: props => <SetupExportHeader {...props} />,\n\n  shouldSuggestBumpingVersionNumber: () => true,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n      const temporaryOutputDir = path.join(\n        fileSystem.getTempDir(),\n        'OnlineCordovaExport'\n      );\n      fileSystem.mkDir(temporaryOutputDir);\n      fileSystem.clearDir(temporaryOutputDir);\n\n      return {\n        exporter,\n        localFileSystem,\n        temporaryOutputDir,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem, temporaryOutputDir }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      temporaryOutputDir\n    );\n    exportOptions.setTarget('cordova');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      temporaryOutputDir,\n      urlFiles: localFileSystem.getAllUrlFilesIn(temporaryOutputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return { temporaryOutputDir };\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir }: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    const archiveOutputDir = os.tmpdir();\n    return archiveLocalFolder({\n      path: temporaryOutputDir,\n      outputFilename: path.join(archiveOutputDir, 'game-archive.zip'),\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    outputFile: CompressionOutput\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadLocalFile(\n        outputFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |},\n    payWithCredits: boolean\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, profile } = authenticatedUser;\n    if (!profile) return Promise.reject(new Error('User is not authenticated'));\n    if (!exportState.signing)\n      return Promise.reject(new Error('Signing options not set up'));\n\n    return buildCordovaIos(\n      getAuthorizationHeader,\n      profile.id,\n      uploadBucketKey,\n      exportState.targets,\n      exportState.signing,\n      gameId,\n      options,\n      payWithCredits\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildElectron,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport { uploadLocalFile } from './LocalFileUploader';\nimport { archiveLocalFolder } from '../../Utils/LocalArchiver';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport {\n  type ExportFlowProps,\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  type ExportState,\n  SetupExportHeader,\n  ExportFlow,\n} from '../GenericExporters/OnlineElectronExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\n\nconst path = optionalRequire('path');\nconst os = optionalRequire('os');\nconst gd: libGDevelop = global.gd;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n  temporaryOutputDir: string,\n|};\n\ntype ExportOutput = {|\n  temporaryOutputDir: string,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  temporaryOutputDir: string,\n|};\n\ntype CompressionOutput = string;\n\nconst exportPipelineName = 'local-online-electron';\n\nexport const localOnlineElectronExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n  onlineBuildType: 'electron-build',\n  limitedBuilds: true,\n  packageNameWarningType: 'desktop',\n\n  getInitialExportState: () => ({\n    targets: ['winExe'],\n  }),\n\n  // Build can be launched only if just opened the dialog or build errored.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    !!exportState.targets.length && (errored || exportStep === ''),\n\n  // Navigation is enabled when the build is errored or whilst uploading.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored &&\n    ['register', 'export', 'resources-download', 'compress', 'upload'].includes(\n      exportStep\n    ),\n\n  renderHeader: props => <SetupExportHeader {...props} />,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <ExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n      const temporaryOutputDir = path.join(\n        fileSystem.getTempDir(),\n        'OnlineElectronExport'\n      );\n      fileSystem.mkDir(temporaryOutputDir);\n      fileSystem.clearDir(temporaryOutputDir);\n\n      return {\n        exporter,\n        localFileSystem,\n        temporaryOutputDir,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem, temporaryOutputDir }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      temporaryOutputDir\n    );\n    exportOptions.setTarget('electron');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      temporaryOutputDir,\n      urlFiles: localFileSystem.getAllUrlFilesIn(temporaryOutputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return { temporaryOutputDir };\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir }: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    const archiveOutputDir = os.tmpdir();\n    return archiveLocalFolder({\n      path: temporaryOutputDir,\n      outputFilename: path.join(archiveOutputDir, 'game-archive.zip'),\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    outputFile: CompressionOutput\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadLocalFile(\n        outputFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |},\n    payWithCredits: boolean\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, firebaseUser } = authenticatedUser;\n    if (!firebaseUser)\n      return Promise.reject(new Error('User is not authenticated'));\n\n    return buildElectron(\n      getAuthorizationHeader,\n      firebaseUser.uid,\n      uploadBucketKey,\n      exportState.targets,\n      gameId,\n      options,\n      payWithCredits\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildWeb,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { uploadLocalFile } from './LocalFileUploader';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/LocalGDJSFinder';\nimport { archiveLocalFolder } from '../../Utils/LocalArchiver';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport LocalFileSystem, { type UrlFileDescriptor } from './LocalFileSystem';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n  type ExportFlowProps,\n} from '../ExportPipeline.flow';\nimport { ExplanationHeader } from '../GenericExporters/OnlineWebExport';\nimport { downloadUrlsToLocalFiles } from '../../Utils/LocalFileDownloader';\nimport OnlineWebExportFlow from '../GenericExporters/OnlineWebExport/OnlineWebExportFlow';\n\nconst path = optionalRequire('path');\nconst os = optionalRequire('os');\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = null;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  localFileSystem: LocalFileSystem,\n  temporaryOutputDir: string,\n|};\n\ntype ExportOutput = {|\n  temporaryOutputDir: string,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  temporaryOutputDir: string,\n|};\n\ntype CompressionOutput = string;\n\nconst exportPipelineName = 'local-online-web';\n\nexport const localOnlineWebExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: exportPipelineName,\n  onlineBuildType: 'web-build',\n\n  getInitialExportState: () => null,\n\n  // Build can be launched if just opened the dialog or build errored, re-enabled when done.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    errored || exportStep === '' || exportStep === 'done',\n\n  // Navigation is enabled when the build is errored or if the build is not done.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored && !['', 'done'].includes(exportStep),\n\n  renderHeader: ({ uiMode }) => <ExplanationHeader uiMode={uiMode} />,\n\n  renderExportFlow: (props: ExportFlowProps) => (\n    <OnlineWebExportFlow {...props} exportPipelineName={exportPipelineName} />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS().then(({ gdjsRoot }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const localFileSystem = new LocalFileSystem({\n        downloadUrlsToLocalFiles: true,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        localFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n      const temporaryOutputDir = path.join(\n        fileSystem.getTempDir(),\n        'OnlineWebExport'\n      );\n      fileSystem.mkDir(temporaryOutputDir);\n      fileSystem.clearDir(temporaryOutputDir);\n\n      return {\n        exporter,\n        localFileSystem,\n        temporaryOutputDir,\n      };\n    });\n  },\n\n  launchExport: async (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, localFileSystem, temporaryOutputDir }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const exportOptions = new gd.ExportOptions(\n      context.project,\n      temporaryOutputDir\n    );\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return {\n      temporaryOutputDir,\n      urlFiles: localFileSystem.getAllUrlFilesIn(temporaryOutputDir),\n    };\n  },\n\n  launchResourcesDownload: async (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    await downloadUrlsToLocalFiles({\n      urlContainers: urlFiles,\n      onProgress: context.updateStepProgress,\n      throwIfAnyError: true,\n    });\n\n    return { temporaryOutputDir };\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { temporaryOutputDir }: ResourcesDownloadOutput\n  ): Promise<CompressionOutput> => {\n    const archiveOutputDir = os.tmpdir();\n    return archiveLocalFolder({\n      path: temporaryOutputDir,\n      outputFilename: path.join(archiveOutputDir, 'game-archive.zip'),\n      sizeLimit: 250 * 1000 * 1000,\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    outputFile: CompressionOutput\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadLocalFile(\n        outputFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |},\n    payWithCredits: boolean\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, firebaseUser } = authenticatedUser;\n    if (!firebaseUser)\n      return Promise.reject(new Error('User is not authenticated'));\n\n    return buildWeb(\n      getAuthorizationHeader,\n      firebaseUser.uid,\n      uploadBucketKey,\n      gameId,\n      options,\n      payWithCredits\n    );\n  },\n};\n","// @flow\nimport { type Exporter } from '../ShareDialog';\nimport { localCordovaExportPipeline } from './LocalCordovaExport';\nimport { localElectronExportPipeline } from './LocalElectronExport';\nimport { localHTML5ExportPipeline } from './LocalHTML5Export';\nimport { localFacebookInstantGamesExportPipeline } from './LocalFacebookInstantGamesExport';\nimport { localOnlineCordovaExportPipeline } from './LocalOnlineCordovaExport';\nimport { localOnlineCordovaIosExportPipeline } from './LocalOnlineCordovaIosExport';\nimport { localOnlineElectronExportPipeline } from './LocalOnlineElectronExport';\nimport { localOnlineWebExportPipeline } from './LocalOnlineWebExport';\nimport { cordovaExporter } from '../GenericExporters/CordovaExport';\nimport { onlineWebExporter } from '../GenericExporters/OnlineWebExport';\nimport { html5Exporter } from '../GenericExporters/HTML5Export';\nimport { facebookInstantGamesExporter } from '../GenericExporters/FacebookInstantGamesExport';\nimport { onlineCordovaExporter } from '../GenericExporters/OnlineCordovaExport';\nimport { onlineCordovaIosExporter } from '../GenericExporters/OnlineCordovaIosExport';\nimport { onlineElectronExporter } from '../GenericExporters/OnlineElectronExport';\nimport { electronExporter } from '../GenericExporters/ElectronExport';\n\nexport const localOnlineWebExporter: Exporter = {\n  ...onlineWebExporter,\n  exportPipeline: localOnlineWebExportPipeline,\n};\n\nexport const localAutomatedExporters: Array<Exporter> = [\n  {\n    ...html5Exporter,\n    exportPipeline: localHTML5ExportPipeline,\n  },\n  {\n    ...onlineCordovaExporter,\n    exportPipeline: localOnlineCordovaExportPipeline,\n  },\n  {\n    ...onlineCordovaIosExporter,\n    exportPipeline: localOnlineCordovaIosExportPipeline,\n  },\n  {\n    ...onlineElectronExporter,\n    exportPipeline: localOnlineElectronExportPipeline,\n  },\n  {\n    ...facebookInstantGamesExporter,\n    exportPipeline: localFacebookInstantGamesExportPipeline,\n  },\n];\n\nexport const localManualExporters: Array<Exporter> = [\n  {\n    ...html5Exporter,\n    exportPipeline: localHTML5ExportPipeline,\n  },\n  {\n    ...cordovaExporter,\n    exportPipeline: localCordovaExportPipeline,\n  },\n  {\n    ...electronExporter,\n    exportPipeline: localElectronExportPipeline,\n  },\n];\n","// @flow\nimport * as React from 'react';\nimport optionalRequire from '../Utils/OptionalRequire';\nimport { useCommandWithOptions } from '../CommandPalette/CommandHooks';\nimport {\n  buildMainMenuDeclarativeTemplate,\n  type BuildMainMenuProps,\n  type MainMenuCallbacks,\n  type MainMenuExtraCallbacks,\n  type MainMenuEvent,\n} from './MainMenu';\nimport PreferencesContext from './Preferences/PreferencesContext';\nimport AuthenticatedUserContext from '../Profile/AuthenticatedUserContext';\nconst electron = optionalRequire('electron');\nconst remote = optionalRequire('@electron/remote');\nconst app = remote ? remote.app : null;\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\n\n// Custom hook to register and deregister IPC listener\nconst useIPCEventListener = ({\n  ipcEvent,\n  callback,\n  shouldApply,\n}: {\n  ipcEvent: MainMenuEvent,\n  callback: Function,\n  shouldApply: boolean,\n}) => {\n  React.useEffect(\n    () => {\n      if (!ipcRenderer || !shouldApply) return;\n\n      const handler = (event, ...eventArgs) => callback(...eventArgs);\n      ipcRenderer.on(ipcEvent, handler);\n      return () => ipcRenderer.removeListener(ipcEvent, handler);\n    },\n    [ipcEvent, callback, shouldApply]\n  );\n};\n\nconst useAppEventListener = ({\n  event,\n  callback,\n}: {\n  event: string,\n  callback: Function,\n}) => {\n  React.useEffect(\n    () => {\n      if (!app) return;\n      const handler = (event, ...eventArgs) => callback(...eventArgs);\n      app.on(event, handler);\n      return () => app.removeListener(event, handler);\n    },\n    [event, callback]\n  );\n};\n\nconst isMainWindow = (windowTitle: string): boolean => {\n  if (!windowTitle) return false;\n  const lowercaseTitle = windowTitle.toLowerCase();\n  return (\n    lowercaseTitle.startsWith('gdevelop') &&\n    lowercaseTitle !== 'gdevelop dialogue tree editor (yarn)' &&\n    lowercaseTitle !== 'gdevelop sound effects editor (jfxr)' &&\n    lowercaseTitle !== 'gdevelop image editor (piskel)'\n  );\n};\n\n/**\n * Create and update the editor main menu using Electron APIs.\n */\nconst ElectronMainMenu = ({\n  props,\n  callbacks,\n  extraCallbacks,\n}: {|\n  props: BuildMainMenuProps,\n  callbacks: MainMenuCallbacks,\n  extraCallbacks: MainMenuExtraCallbacks,\n|}) => {\n  const {\n    i18n,\n    project,\n    canSaveProjectAs,\n    recentProjectFiles,\n    shortcutMap,\n    isApplicationTopLevelMenu,\n  } = props;\n  const { onClosePreview } = extraCallbacks;\n  const language = i18n.language;\n  const [\n    isFocusedOnMainWindow,\n    setIsFocusedOnMainWindow,\n  ] = React.useState<boolean>(true);\n  const [focusedWindowId, setFocusedWindowId] = React.useState<number>(\n    remote.getCurrentWindow().id\n  );\n  const closePreviewWindow =\n    !isFocusedOnMainWindow && onClosePreview\n      ? () => onClosePreview(focusedWindowId)\n      : null;\n  const {\n    values: { useShortcutToClosePreviewWindow },\n  } = React.useContext(PreferencesContext);\n  const { limits } = React.useContext(AuthenticatedUserContext);\n\n  const hideAskAi =\n    !!limits &&\n    !!limits.capabilities.classrooms &&\n    limits.capabilities.classrooms.hideAskAi;\n\n  useAppEventListener({\n    event: 'browser-window-focus',\n    callback: window => {\n      setFocusedWindowId(window.id);\n      setIsFocusedOnMainWindow(isMainWindow(window.title));\n    },\n  });\n  useAppEventListener({\n    event: 'browser-window-blur',\n    callback: window => {\n      setIsFocusedOnMainWindow(!isMainWindow(window.title));\n    },\n  });\n\n  // We could use a for loop, but for safety let's write every hook one by\n  // one to avoid any change at runtime which would break the rules of hooks.\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open',\n    callback: callbacks.onChooseProject,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-recent',\n    callback: callbacks.onOpenRecentFile,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-save',\n    callback: callbacks.onSaveProject,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-save-as',\n    callback: callbacks.onSaveProjectAs,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-show-version-history',\n    callback: callbacks.onShowVersionHistory,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-close',\n    callback:\n      useShortcutToClosePreviewWindow && closePreviewWindow\n        ? closePreviewWindow\n        : callbacks.onCloseProject,\n    shouldApply:\n      useShortcutToClosePreviewWindow && closePreviewWindow\n        ? true\n        : isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-close-app',\n    callback: callbacks.onCloseApp,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-export',\n    callback: callbacks.onExportProject,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-invite-collaborators',\n    callback: callbacks.onInviteCollaborators,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-create-project',\n    callback: callbacks.onCreateProject,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-project-manager',\n    callback: callbacks.onOpenProjectManager,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-home-page',\n    callback: callbacks.onOpenHomePage,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-debugger',\n    callback: callbacks.onOpenDebugger,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-about',\n    callback: callbacks.onOpenAbout,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-preferences',\n    callback: callbacks.onOpenPreferences,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-language',\n    callback: callbacks.onOpenLanguage,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-profile',\n    callback: callbacks.onOpenProfile,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'main-menu-open-ask-ai',\n    callback: callbacks.onOpenAskAi,\n    shouldApply: isFocusedOnMainWindow,\n  });\n  useIPCEventListener({\n    ipcEvent: 'update-status',\n    callback: callbacks.setElectronUpdateStatus,\n    shouldApply: true, // Keep logic around app update even if on preview window\n  });\n\n  React.useEffect(\n    () => {\n      if (ipcRenderer) {\n        ipcRenderer.send(\n          'set-main-menu',\n          buildMainMenuDeclarativeTemplate({\n            project,\n            canSaveProjectAs,\n            i18n,\n            recentProjectFiles,\n            shortcutMap,\n            isApplicationTopLevelMenu,\n            hideAskAi,\n          })\n        );\n      }\n    },\n    [\n      i18n,\n      language,\n      project,\n      canSaveProjectAs,\n      recentProjectFiles,\n      shortcutMap,\n      isApplicationTopLevelMenu,\n      hideAskAi,\n    ]\n  );\n\n  const { onOpenRecentFile } = callbacks;\n  useCommandWithOptions('OPEN_RECENT_PROJECT', true, {\n    generateOptions: React.useCallback(\n      () =>\n        recentProjectFiles.map(item => ({\n          text: item.fileMetadata.fileIdentifier,\n          handler: () => onOpenRecentFile(item),\n        })),\n      [onOpenRecentFile, recentProjectFiles]\n    ),\n  });\n\n  return null;\n};\n\nexport default ElectronMainMenu;\n","// @flow\nimport {\n  type EventsFunctionCodeWriter,\n  type EventsFunctionCodeWriterCallbacks,\n} from '..';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport { getUID } from '../../Utils/LocalUserInfo';\nimport slugs from 'slugs';\nconst path = optionalRequire('path');\nconst os = optionalRequire('os');\nconst fs = optionalRequire('fs');\n\n/**\n * Create the EventsFunctionCodeWriter that writes generated code for events functions\n * to local files.\n */\nexport const makeLocalEventsFunctionCodeWriter = ({\n  onWriteFile,\n}: EventsFunctionCodeWriterCallbacks): EventsFunctionCodeWriter => {\n  // The generated code for extensions will be stored in a temporary directory\n\n  const outputDir = path.join(\n    os.tmpdir(),\n    `GDGeneratedEventsFunctions-` + getUID()\n  );\n  fs.mkdir(outputDir, err => {\n    if (err && err.code !== 'EEXIST') {\n      console.error(\n        'Unable to create the directory where to output events functions generated code: ',\n        err\n      );\n      return;\n    }\n  });\n\n  const getPathFor = (codeNamespace: string) => {\n    return `${outputDir}/${slugs(codeNamespace)}.js`;\n  };\n\n  return {\n    getIncludeFileFor: (codeNamespace: string) => getPathFor(codeNamespace),\n    writeFunctionCode: (\n      functionCodeNamespace: string,\n      code: string\n    ): Promise<void> => {\n      return new Promise((resolve, reject) => {\n        const includeFile = getPathFor(functionCodeNamespace);\n        onWriteFile({ includeFile, content: code });\n        fs.writeFile(includeFile, code, err => {\n          if (err) return reject(err);\n\n          resolve();\n        });\n      });\n    },\n    writeBehaviorCode: (\n      behaviorCodeNamespace: string,\n      code: string\n    ): Promise<void> => {\n      return new Promise((resolve, reject) => {\n        const includeFile = getPathFor(behaviorCodeNamespace);\n        onWriteFile({ includeFile, content: code });\n        fs.writeFile(includeFile, code, err => {\n          if (err) return reject(err);\n\n          resolve();\n        });\n      });\n    },\n    writeObjectCode: (\n      objectCodeNamespace: string,\n      code: string\n    ): Promise<void> => {\n      return new Promise((resolve, reject) => {\n        const includeFile = getPathFor(objectCodeNamespace);\n        onWriteFile({ includeFile, content: code });\n        fs.writeFile(includeFile, code, err => {\n          if (err) return reject(err);\n\n          resolve();\n        });\n      });\n    },\n  };\n};\n","// @flow\nimport optionalRequire from '../../Utils/OptionalRequire';\nconst fs = optionalRequire('fs-extra');\nconst path = optionalRequire('path');\nconst remote = optionalRequire('@electron/remote');\nconst dialog = remote ? remote.dialog : null;\n\nconst writeJSONFile = (object: Object, filepath: string): Promise<void> => {\n  if (!fs) return Promise.reject(new Error('Filesystem is not supported.'));\n\n  try {\n    const content = JSON.stringify(object, null, 2);\n    return fs.ensureDir(path.dirname(filepath)).then(\n      () =>\n        new Promise((resolve, reject) => {\n          fs.writeFile(filepath, content, (err: ?Error) => {\n            if (err) {\n              return reject(err);\n            }\n\n            return resolve();\n          });\n        })\n    );\n  } catch (stringifyException) {\n    return Promise.reject(stringifyException);\n  }\n};\n\nexport default class LocalEventsFunctionsExtensionWriter {\n  static chooseEventsFunctionExtensionFile = (\n    extensionName?: string\n  ): Promise<?string> => {\n    if (!dialog) return Promise.reject('Not supported');\n    const browserWindow = remote.getCurrentWindow();\n\n    return dialog\n      .showSaveDialog(browserWindow, {\n        title: 'Export an extension of the project',\n        filters: [\n          {\n            name: 'GDevelop 5 \"events based\" extension',\n            extensions: ['json'],\n          },\n        ],\n        defaultPath: (extensionName || 'Extension') + '.json',\n      })\n      .then(({ filePath }) => {\n        if (!filePath) return null;\n        return filePath;\n      });\n  };\n\n  static writeSerializedObject = (\n    serializedObject: Object,\n    filepath: string\n  ): Promise<void> => {\n    return writeJSONFile(serializedObject, filepath).catch(err => {\n      console.error('Unable to write the events function extension:', err);\n      throw err;\n    });\n  };\n}\n","// @flow\nimport { openFilesPicker, readJSONFile } from '../../Utils/FileSystem';\nimport { type SerializedExtension } from '../../Utils/GDevelopServices/Extension';\n\nexport default class LocalEventsFunctionsExtensionOpener {\n  static chooseEventsFunctionExtensionFile = (): Promise<Array<string>> => {\n    return openFilesPicker({\n      title: 'Import extensions into the project',\n      properties: ['openFile', 'multiSelections'],\n      message: 'Choose extension files to import (.json file)',\n      filters: [\n        {\n          name: 'GDevelop 5 \"events based\" extension',\n          extensions: ['json'],\n        },\n      ],\n    }).then(filePaths => filePaths);\n  };\n\n  static readEventsFunctionExtensionFile = (\n    filepath: string\n  ): Promise<SerializedExtension> => {\n    return readJSONFile(filepath);\n  };\n}\n","// @flow\n// TODO: This module could be published on npm if useful.\nimport newNameGenerator from './NewNameGenerator';\nimport slugs from 'slugs';\n\ntype PartialObjectDescription = {|\n  reference: string,\n  object: Object,\n|};\n\ntype Reference = {\n  referenceTo: string,\n};\n\ntype SplitConfiguration = {|\n  pathSeparator: string,\n  getArrayItemReferenceName: (\n    object: Object,\n    currentReference: string\n  ) => string,\n  shouldSplit: (path: string) => boolean,\n  isReferenceMagicPropertyName: string,\n|};\n\ntype UnsplitConfiguration = {|\n  isReferenceMagicPropertyName: string,\n  getReferencePartialObject: (referencePath: string) => Promise<Object>,\n  maxUnsplitDepth?: number,\n|};\n\n/**\n * Mutate the given object to split it into multiple partial objects.\n * Partial objects will be replaced by references.\n *\n * @param object The object to be split.\n * @param configuration Configuration to be used to split the object.\n */\nexport const split = (\n  object: Object,\n  {\n    pathSeparator,\n    getArrayItemReferenceName,\n    shouldSplit,\n    isReferenceMagicPropertyName,\n  }: SplitConfiguration\n): Array<PartialObjectDescription> => {\n  const partialObjects = [];\n  const createReference = (reference, object): Reference => {\n    partialObjects.push({\n      reference,\n      object,\n    });\n\n    return {\n      [isReferenceMagicPropertyName]: true,\n      referenceTo: reference,\n    };\n  };\n\n  const splitObject = (\n    currentObject: Object,\n    currentPath: string,\n    currentReference: string\n  ) => {\n    if (currentObject !== null && typeof currentObject === 'object') {\n      if (Array.isArray(currentObject)) {\n        for (let index in currentObject) {\n          const itemPath = currentPath + pathSeparator + '*';\n          if (shouldSplit(itemPath)) {\n            const partialObject = currentObject[index];\n            const name = getArrayItemReferenceName(\n              partialObject,\n              currentReference\n            );\n            const itemReference = currentReference + pathSeparator + name;\n\n            currentObject[index] = createReference(\n              itemReference,\n              partialObject\n            );\n\n            splitObject(partialObject, itemPath, itemReference);\n          } else {\n            const itemReference = currentReference + pathSeparator + index;\n\n            splitObject(currentObject[index], itemPath, itemReference);\n          }\n        }\n      } else {\n        for (let propertyName in currentObject) {\n          const propertyPath = currentPath + pathSeparator + propertyName;\n          const propertyReference =\n            currentReference + pathSeparator + propertyName;\n          if (shouldSplit(propertyPath)) {\n            const partialObject = currentObject[propertyName];\n\n            currentObject[propertyName] = createReference(\n              propertyReference,\n              partialObject\n            );\n\n            splitObject(partialObject, propertyPath, propertyReference);\n          } else {\n            splitObject(\n              currentObject[propertyName],\n              propertyPath,\n              propertyReference\n            );\n          }\n        }\n      }\n    }\n  };\n\n  splitObject(object, '', '');\n  return partialObjects;\n};\n\n/**\n * Mutate the given object to recompose it from partial objects.\n * References to partial objects will be fetched as needed.\n *\n * @param object The object to be unsplit.\n * @param configuration Configuration to be used to unsplit the object.\n */\nexport const unsplit = (\n  object: Object,\n  {\n    isReferenceMagicPropertyName,\n    getReferencePartialObject,\n    maxUnsplitDepth,\n  }: UnsplitConfiguration\n): Promise<void> => {\n  const isReference = (object: Object): ?Reference => {\n    if (object[isReferenceMagicPropertyName] === true) {\n      return object;\n    }\n\n    return null;\n  };\n\n  const unsplitObject = (\n    currentObject: Object,\n    depth: number\n  ): Promise<void> => {\n    if (maxUnsplitDepth !== undefined && depth >= maxUnsplitDepth) {\n      return Promise.resolve();\n    }\n\n    if (currentObject !== null && typeof currentObject === 'object') {\n      const keys = Object.keys(currentObject);\n      if (keys) {\n        return Promise.all(\n          keys.map(indexOrPropertyName => {\n            const reference = isReference(currentObject[indexOrPropertyName]);\n            if (reference) {\n              return getReferencePartialObject(reference.referenceTo).then(\n                partialObject => {\n                  currentObject[indexOrPropertyName] = partialObject;\n\n                  return unsplitObject(\n                    currentObject[indexOrPropertyName],\n                    depth + 1\n                  );\n                }\n              );\n            }\n\n            return unsplitObject(currentObject[indexOrPropertyName], depth + 1);\n          })\n        ).then(() => {});\n      }\n    }\n\n    return Promise.resolve();\n  };\n\n  return unsplitObject(object, 0);\n};\n\n/**\n * A helper that can be used to split according to a list of hardcoded paths\n */\nexport const splitPaths = (paths: Set<string>) => {\n  return (path: string) => paths.has(path);\n};\n\n/**\n * A helper that can be used to get the name of items in array using an hardcoded property name.\n */\nexport const getNameFromProperty = (propertyName: string) => {\n  return (object: Object): string => {\n    const property = object[propertyName];\n    if (typeof property !== 'string') {\n      throw new Error(`Property ${propertyName} is not a string`);\n    }\n\n    return property;\n  };\n};\n\n/**\n * A helper that can be used to get the name of items in array using an hardcoded property name.\n */\nexport const getSlugifiedUniqueNameFromProperty = (propertyName: string) => {\n  const existingNamesForReference = {};\n\n  return (object: Object, currentReference: string): string => {\n    const property = object[propertyName];\n    if (typeof property !== 'string') {\n      throw new Error(`Property ${propertyName} is not a string`);\n    }\n\n    existingNamesForReference[currentReference] =\n      existingNamesForReference[currentReference] || {};\n    const newName = newNameGenerator(\n      slugs(property),\n      name => !!existingNamesForReference[currentReference][name]\n    );\n    existingNamesForReference[currentReference][newName] = true;\n    return newName;\n  };\n};\n","// @flow\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport { type FileMetadata } from '../index';\nimport { unsplit } from '../../Utils/ObjectSplitter';\nimport { openFilePicker, readJSONFile } from '../../Utils/FileSystem';\nconst fs = optionalRequire('fs');\nconst path = optionalRequire('path');\n\nexport const onOpenWithPicker = (): Promise<?FileMetadata> => {\n  return openFilePicker({\n    title: 'Open a project',\n    properties: ['openFile'],\n    message:\n      'If you want to open your GDevelop 4 project, be sure to save it as a .json file',\n    filters: [{ name: 'GDevelop 5 project', extensions: ['json'] }],\n  }).then(filePath => (filePath ? { fileIdentifier: filePath } : null));\n};\n\nexport const onOpen = (\n  fileMetadata: FileMetadata\n): Promise<{|\n  content: Object,\n|}> => {\n  const filePath = fileMetadata.fileIdentifier;\n  const projectPath = path.dirname(filePath);\n  return readJSONFile(filePath).then(object => {\n    return unsplit(object, {\n      getReferencePartialObject: referencePath => {\n        return readJSONFile(path.join(projectPath, referencePath) + '.json');\n      },\n      isReferenceMagicPropertyName: '__REFERENCE_TO_SPLIT_OBJECT',\n      // Limit unsplitting to depth 3 (which would allow properties of layouts/external layouts/external events\n      // to be un-splitted, but not the content of these properties), to avoid very slow processing\n      // of large game files.\n      maxUnsplitDepth: 3,\n    }).then(() => {\n      return { content: object };\n    });\n  });\n};\n\nexport const getAutoSaveCreationDate = async (\n  fileMetadata: FileMetadata,\n  compareLastModified: boolean\n): Promise<?number> => {\n  const filePath = fileMetadata.fileIdentifier;\n  const autoSavePath = filePath + '.autosave';\n  if (fs.existsSync(autoSavePath)) {\n    const autoSavedTime = fs.statSync(autoSavePath).mtime.getTime();\n    if (!compareLastModified) {\n      return autoSavedTime;\n    }\n    try {\n      const saveTime = fs.statSync(filePath).mtime.getTime();\n      // When comparing the last modified time, add a 5 seconds margin to avoid\n      // showing the warning if the user has just saved the project, or if the\n      // project has been decompressed from a zip file, causing the last modified\n      // time to be the time of decompression.\n      return autoSavedTime > saveTime + 5000 ? autoSavedTime : null;\n    } catch (err) {\n      console.error('Unable to compare *.autosave to project', err);\n      return null;\n    }\n  }\n  return null;\n};\n\nexport const onGetAutoSave = (fileMetadata: FileMetadata) => {\n  return Promise.resolve({\n    ...fileMetadata,\n    fileIdentifier: fileMetadata.fileIdentifier + '.autosave',\n  });\n};\n","// @flow\nimport { t, Trans } from '@lingui/macro';\nimport * as React from 'react';\nimport { serializeToJSObject, serializeToJSON } from '../../Utils/Serializer';\nimport {\n  type FileMetadata,\n  type SaveAsLocation,\n  type SaveAsOptions,\n} from '../index';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport {\n  split,\n  splitPaths,\n  getSlugifiedUniqueNameFromProperty,\n} from '../../Utils/ObjectSplitter';\nimport type { MessageDescriptor } from '../../Utils/i18n/MessageDescriptor.flow';\nimport LocalFolderPicker from '../../UI/LocalFolderPicker';\nimport SaveAsOptionsDialog from '../SaveAsOptionsDialog';\n\nconst fs = optionalRequire('fs-extra');\nconst path = optionalRequire('path');\nconst remote = optionalRequire('@electron/remote');\nconst dialog = remote ? remote.dialog : null;\n\nexport const splittedProjectFolderNames = [\n  'layouts',\n  'externalLayouts',\n  'externalEvents',\n  'eventsFunctionsExtensions',\n];\n\nconst deleteExistingFilesFromDirs = (\n  project: gdProject,\n  projectPath: string\n) => {\n  //If multiFile is not enabled in settings and directories do not exist.\n  if (!project.isFolderProject()) return;\n\n  const entries = fs.readdirSync(projectPath);\n  entries.forEach(entry => {\n    if (!splittedProjectFolderNames.includes(entry)) return;\n\n    const dirPath = path.join(projectPath, entry);\n    if (!fs.statSync(dirPath).isDirectory()) return;\n\n    const filenames = fs.readdirSync(dirPath);\n    filenames.forEach(file => {\n      const fileToRemovePath = path.join(dirPath, file);\n      try {\n        fs.unlinkSync(fileToRemovePath);\n      } catch (e) {\n        throw new Error(`Unable to remove file ${file}: ${e.message}`);\n      }\n    });\n  });\n};\n\nconst checkFileContent = (filePath: string, expectedContent: string) => {\n  const time = performance.now();\n  return new Promise((resolve, reject) => {\n    fs.readFile(filePath, { encoding: 'utf8' }, (err, content) => {\n      if (err) return reject(err);\n\n      if (content === '') {\n        reject(new Error(`Written file is empty, did the write fail?`));\n      }\n      if (content !== expectedContent) {\n        reject(\n          new Error(\n            `Written file is not containing the expected content, did the write fail?`\n          )\n        );\n      }\n      const verificationTime = performance.now() - time;\n      console.info(\n        `Verified ${filePath} content in ${verificationTime.toFixed()}ms.`\n      );\n      resolve();\n    });\n  });\n};\n\nconst writeAndCheckFile = async (\n  content: string,\n  filePath: string\n): Promise<void> => {\n  if (!fs) throw new Error('Filesystem is not supported.');\n  if (content === '')\n    throw new Error('The content to save on disk is empty. Aborting.');\n\n  await fs.ensureDir(path.dirname(filePath));\n\n  await fs.writeFile(filePath, content);\n  await checkFileContent(filePath, content);\n};\n\nconst writeAndCheckFormattedJSONFile = async (\n  object: Object,\n  filePath: string\n): Promise<void> => {\n  const content = JSON.stringify(object, null, 2);\n  await writeAndCheckFile(content, filePath);\n};\n\nconst writeProjectFiles = (\n  project: gdProject,\n  filePath: string,\n  projectPath: string\n): Promise<void> => {\n  const serializedProjectObject = serializeToJSObject(project);\n  if (project.isFolderProject()) {\n    const partialObjects = split(serializedProjectObject, {\n      pathSeparator: '/',\n      getArrayItemReferenceName: getSlugifiedUniqueNameFromProperty('name'),\n      shouldSplit: splitPaths(\n        new Set(\n          splittedProjectFolderNames.map(folderName => `/${folderName}/*`)\n        )\n      ),\n      isReferenceMagicPropertyName: '__REFERENCE_TO_SPLIT_OBJECT',\n    });\n\n    return Promise.all(\n      partialObjects.map(partialObject => {\n        return writeAndCheckFormattedJSONFile(\n          partialObject.object,\n          path.join(projectPath, partialObject.reference) + '.json'\n        ).catch(err => {\n          console.error('Unable to write a partial file:', err);\n          throw err;\n        });\n      })\n    ).then(() => {\n      return writeAndCheckFormattedJSONFile(\n        serializedProjectObject,\n        filePath\n      ).catch(err => {\n        console.error('Unable to write the split project:', err);\n        throw err;\n      });\n    });\n  } else {\n    return writeAndCheckFormattedJSONFile(\n      serializedProjectObject,\n      filePath\n    ).catch(err => {\n      console.error('Unable to write the project:', err);\n      throw err;\n    });\n  }\n};\n\nexport const onSaveProject = async (\n  project: gdProject,\n  fileMetadata: FileMetadata\n): Promise<{|\n  wasSaved: boolean,\n  fileMetadata: FileMetadata,\n|}> => {\n  const filePath = fileMetadata.fileIdentifier;\n  const now = Date.now();\n  if (!filePath) {\n    throw new Error('Unable to find file path before saving.');\n  }\n  // Ensure we always pick the latest name and gameId.\n  const newFileMetadata = {\n    ...fileMetadata,\n    name: project.getName(),\n    gameId: project.getProjectUuid(),\n    lastModifiedDate: now,\n  };\n\n  const projectPath = path.dirname(filePath);\n\n  try {\n    deleteExistingFilesFromDirs(project, projectPath);\n  } catch (e) {\n    console.warn('Unable to clean project folder before saving project: ', e);\n  }\n\n  await writeProjectFiles(project, filePath, projectPath);\n  return {\n    wasSaved: true,\n    fileMetadata: newFileMetadata,\n  };\n};\n\nexport const generateOnChooseSaveProjectAsLocation = ({\n  setDialog,\n  closeDialog,\n}: {\n  setDialog: (() => React.Node) => void,\n  closeDialog: () => void,\n}) => async ({\n  project,\n  fileMetadata,\n  displayOptionToGenerateNewProjectUuid,\n}: {|\n  project: gdProject,\n  fileMetadata: ?FileMetadata, // This is the current location.\n  displayOptionToGenerateNewProjectUuid: boolean,\n|}): Promise<{|\n  saveAsLocation: ?SaveAsLocation, // This is the newly chosen location (or null if cancelled).\n  saveAsOptions: ?SaveAsOptions,\n|}> => {\n  const options = await new Promise(resolve => {\n    setDialog(() => (\n      <SaveAsOptionsDialog\n        onCancel={() => {\n          closeDialog();\n          resolve(null);\n        }}\n        nameSuggestion={\n          fileMetadata ? `${project.getName()} - Copy` : project.getName()\n        }\n        mainActionLabel={<Trans>Continue</Trans>}\n        displayOptionToGenerateNewProjectUuid={\n          displayOptionToGenerateNewProjectUuid\n        }\n        onSave={options => {\n          closeDialog();\n          resolve(options);\n        }}\n      />\n    ));\n  });\n\n  if (!options) return { saveAsLocation: null, saveAsOptions: null }; // Save was cancelled.\n\n  let defaultPath = fileMetadata ? fileMetadata.fileIdentifier : '';\n  const { name } = options;\n  if (path && defaultPath && name) {\n    const safeFilename = name.replace(/[<>:\"/\\\\|?*]/g, '_');\n    defaultPath = path.join(path.dirname(defaultPath), `${safeFilename}.json`);\n  }\n\n  const browserWindow = remote.getCurrentWindow();\n  const saveDialogOptions = {\n    defaultPath,\n    filters: [{ name: 'GDevelop 5 project', extensions: ['json'] }],\n  };\n\n  if (!dialog) {\n    throw new Error('Unsupported');\n  }\n  const filePath = dialog.showSaveDialogSync(browserWindow, saveDialogOptions);\n  if (!filePath) {\n    return { saveAsLocation: null, saveAsOptions: null };\n  }\n\n  return {\n    saveAsLocation: {\n      name: options.name,\n      fileIdentifier: filePath,\n    },\n    saveAsOptions: {\n      generateNewProjectUuid: options.generateNewProjectUuid,\n    },\n  };\n};\n\nexport const onSaveProjectAs = async (\n  project: gdProject,\n  saveAsLocation: ?SaveAsLocation,\n  options: {|\n    onStartSaving: () => void,\n    onMoveResources: ({|\n      newFileMetadata: FileMetadata,\n    |}) => Promise<void>,\n  |}\n): Promise<{|\n  wasSaved: boolean,\n  fileMetadata: ?FileMetadata,\n|}> => {\n  if (!saveAsLocation)\n    throw new Error('A location was not chosen before saving as.');\n  const filePath = saveAsLocation.fileIdentifier;\n  if (!filePath)\n    throw new Error('A file path was not chosen before saving as.');\n\n  options.onStartSaving();\n\n  // Ensure we always pick the latest name and gameId.\n  const newFileMetadata = {\n    fileIdentifier: filePath,\n    name: project.getName(),\n    gameId: project.getProjectUuid(),\n    lastModifiedDate: Date.now(),\n  };\n\n  // Move (copy or download, etc...) the resources first.\n  await options.onMoveResources({ newFileMetadata });\n\n  // Save the project when resources have been copied.\n  const projectPath = path.dirname(filePath);\n  project.setProjectFile(filePath);\n\n  await writeProjectFiles(project, filePath, projectPath);\n  return {\n    wasSaved: true,\n    fileMetadata: newFileMetadata,\n  };\n};\n\nexport const onAutoSaveProject = (\n  project: gdProject,\n  fileMetadata: FileMetadata\n): Promise<void> => {\n  const autoSavePath = fileMetadata.fileIdentifier + '.autosave';\n  return writeAndCheckFile(serializeToJSON(project), autoSavePath).catch(\n    err => {\n      console.error(`Unable to write ${autoSavePath}:`, err);\n      throw err;\n    }\n  );\n};\n\nexport const getWriteErrorMessage = (error: Error): MessageDescriptor =>\n  t`An error occurred when saving the project. Please try again by choosing another location.`;\n\n// See https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file\nconst forbiddenCharacterRegex = /\\\\ | \\/ | : | \\* | \\? | \" | < | > | \\|/g;\nconst consecutiveSpacesRegex = /\\s+/g;\nconst cleanUpProjectFileName = (projectFileName: string) =>\n  (projectFileName.length > 200\n    ? projectFileName.substring(0, 200)\n    : projectFileName\n  )\n    .replace(forbiddenCharacterRegex, ' ')\n    .replace(consecutiveSpacesRegex, ' ')\n    .trim();\n\nexport const getProjectLocation = ({\n  projectName,\n  saveAsLocation,\n  newProjectsDefaultFolder,\n}: {\n  projectName: string,\n  saveAsLocation: ?SaveAsLocation,\n  newProjectsDefaultFolder?: string,\n}): SaveAsLocation => {\n  const outputPath = saveAsLocation\n    ? path.dirname(saveAsLocation.fileIdentifier)\n    : newProjectsDefaultFolder\n    ? newProjectsDefaultFolder\n    : '';\n  const projectFileName = projectName\n    ? cleanUpProjectFileName(projectName) + '.json'\n    : 'game.json';\n  return {\n    fileIdentifier: path.join(outputPath, projectFileName),\n  };\n};\n\nexport const renderNewProjectSaveAsLocationChooser = ({\n  projectName,\n  saveAsLocation,\n  setSaveAsLocation,\n  newProjectsDefaultFolder,\n}: {|\n  projectName: string,\n  saveAsLocation: ?SaveAsLocation,\n  setSaveAsLocation: (?SaveAsLocation) => void,\n  newProjectsDefaultFolder?: string,\n|}) => {\n  const projectLocation = getProjectLocation({\n    projectName,\n    saveAsLocation,\n    newProjectsDefaultFolder,\n  });\n  return (\n    <LocalFolderPicker\n      fullWidth\n      value={path.dirname(projectLocation.fileIdentifier)}\n      onChange={newOutputPath => {\n        const newOutputFileIdentifier = path.join(\n          newOutputPath,\n          path.basename(projectLocation.fileIdentifier)\n        );\n        setSaveAsLocation(\n          getProjectLocation({\n            projectName,\n            saveAsLocation: {\n              fileIdentifier: newOutputFileIdentifier,\n            },\n            newProjectsDefaultFolder,\n          })\n        );\n      }}\n      type=\"create-game\"\n    />\n  );\n};\n\nexport const isTryingToSaveInForbiddenPath = (filePath: string): boolean => {\n  if (!remote) return false; // This should not happen, but let's be safe.\n  // If the user is saving locally and chose the same location as where the\n  // executable is running, prevent this, as it will be deleted when the app is updated.\n  const exePath = remote.app.getPath('exe');\n  if (!exePath) return false; // This should not happen, but let's be safe.\n  const gdevelopDirectory = path.dirname(exePath);\n  return filePath.startsWith(gdevelopDirectory);\n};\n","// @flow\n\nimport {\n  applyResourceDefaults,\n  getLocalResourceFullPath,\n  getResourceFilePathStatus,\n} from '../../ResourcesList/ResourceUtils';\nimport { mapVector } from '../../Utils/MapFor';\nimport newNameGenerator from '../../Utils/NewNameGenerator';\nimport optionalLazyRequire from '../../Utils/OptionalLazyRequire';\nimport optionalRequire from '../../Utils/OptionalRequire';\n\nconst gd: libGDevelop = global.gd;\n\nconst lazyRequireGlob = optionalLazyRequire('glob');\nconst path = optionalRequire('path');\n\n// It's important to use remote and not electron for folder actions,\n// otherwise they will be opened in the background.\n// See https://github.com/electron/electron/issues/4349#issuecomment-777475765\nconst remote = optionalRequire('@electron/remote');\nconst shell = remote ? remote.shell : null;\n\nexport const locateResourceFile = ({\n  project,\n  resource,\n}: {|\n  project: gdProject,\n  resource: gdResource,\n|}) => {\n  const resourceFilePath = getLocalResourceFullPath(\n    project,\n    resource.getName()\n  );\n\n  if (shell) shell.showItemInFolder(path.resolve(resourceFilePath));\n};\n\nexport const openResourceFile = ({\n  project,\n  resource,\n}: {|\n  project: gdProject,\n  resource: gdResource,\n|}) => {\n  const resourceFilePath = getLocalResourceFullPath(\n    project,\n    resource.getName()\n  );\n  if (shell) shell.openPath(path.resolve(resourceFilePath));\n};\n\nexport const copyResourceFilePath = ({\n  project,\n  resource,\n}: {|\n  project: gdProject,\n  resource: gdResource,\n|}) => {\n  const resourceFilePath = getLocalResourceFullPath(\n    project,\n    resource.getName()\n  );\n  remote.clipboard.writeText(path.resolve(resourceFilePath));\n};\n\nexport const scanForNewResources = async ({\n  project,\n  extensions,\n  createResource,\n}: {|\n  project: gdProject,\n  extensions: Array<string>,\n  createResource: () => gdResource,\n|}) => {\n  const glob = lazyRequireGlob();\n  if (!glob) return;\n\n  const resourcesManager = project.getResourcesManager();\n  const projectPath = path.dirname(project.getProjectFile());\n\n  const allExtensions = [\n    ...extensions,\n    ...extensions.map(extension => extension.toUpperCase()),\n  ];\n\n  try {\n    const allFiles = await new Promise((resolve, reject) => {\n      glob(\n        projectPath + '/**/*.{' + allExtensions.join(',') + '}',\n        (error, files) => {\n          if (error) reject(error);\n          else resolve(files);\n        }\n      );\n    });\n\n    const filesToCheck = new gd.VectorString();\n    allFiles.forEach(filePath =>\n      filesToCheck.push_back(path.relative(projectPath, filePath))\n    );\n    const filePathsNotInResources = project\n      .getResourcesManager()\n      .findFilesNotInResources(filesToCheck);\n    filesToCheck.delete();\n\n    mapVector(filePathsNotInResources, (relativeFilePath: string) => {\n      const resourceName = newNameGenerator(relativeFilePath, name =>\n        resourcesManager.hasResource(name)\n      );\n\n      const resource = createResource();\n      resource.setFile(relativeFilePath);\n      resource.setName(resourceName);\n      applyResourceDefaults(project, resource);\n      resourcesManager.addResource(resource);\n      resource.delete();\n\n      console.info(\n        `\"${relativeFilePath}\" added to project as resource named \"${resourceName}\".`\n      );\n    });\n  } catch (error) {\n    console.error(`Error finding files inside ${projectPath}:`, error);\n    return;\n  }\n};\n\nexport const removeAllResourcesWithInvalidPath = ({\n  project,\n}: {|\n  project: gdProject,\n|}) => {\n  const resourcesManager = project.getResourcesManager();\n  const removedResourceNames = resourcesManager\n    .getAllResourceNames()\n    .toJSArray()\n    .filter(resourceName => {\n      return getResourceFilePathStatus(project, resourceName) === 'error';\n    });\n\n  removedResourceNames.forEach(resourceName => {\n    resourcesManager.removeResource(resourceName);\n    console.info('Removed due to invalid path: ' + resourceName);\n  });\n};\n","// @flow\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport debounce from 'lodash/debounce';\nimport wrap from 'lodash/wrap';\nimport memoize from 'lodash/memoize';\nimport { splittedProjectFolderNames } from './LocalProjectWriter';\n\nconst path = optionalRequire('path');\nconst electron = optionalRequire('electron');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\n\nexport const setupResourcesWatcher =\n  ipcRenderer && path\n    ? ({\n        fileIdentifier,\n        callback,\n        options,\n      }: {\n        fileIdentifier: string,\n        callback: ({| identifier: string |}) => void,\n        options?: {| isProjectSplitInMultipleFiles: boolean |},\n      }) => {\n        // We can't just debounce the whole callback, it has to be done file-wise,\n        // otherwise we would miss all the debounced calls but the last one.\n        // See https://stackoverflow.com/questions/28787436/debounce-a-function-with-argument\n        const debouncedCallback = wrap(\n          memoize(() =>\n            debounce(\n              filePath => {\n                const relativePath = path\n                  .relative(folderPath, filePath)\n                  .replace(/\\\\/g, '/');\n\n                callback({ identifier: relativePath });\n              },\n              200,\n              { leading: false, trailing: true }\n            )\n          ),\n          (getMemoizedFunc, obj) => getMemoizedFunc(obj)(obj)\n        );\n        const folderPath = path.dirname(fileIdentifier);\n        const gameFile = path.basename(fileIdentifier);\n        const autosaveFile = gameFile + '.autosave';\n        ipcRenderer.on('project-file-changed', (event, path) => {\n          // TODO: Is it safe to let it like that since the OS could for some reason\n          // do never-ending operations on the folder or its children, making the debounce\n          // never ending.\n          debouncedCallback(path);\n        });\n        const ignore = [\n          path.sep + '.DS_Store', // macOS folder attributes file\n          path.sep + '.git', // For projects using git as a versioning tool.\n          path.sep + 'node_modules', // For projects using npm (node_modules has way too many files and would crash the watcher on macOS)\n          path.join(folderPath, gameFile),\n          path.join(folderPath, autosaveFile),\n        ];\n        if (options && options.isProjectSplitInMultipleFiles) {\n          ignore.push(\n            ...splittedProjectFolderNames.map(folderName =>\n              path.join(folderPath, folderName, '*.json')\n            )\n          );\n        }\n        const subscriptionIdPromise = ipcRenderer.invoke(\n          'local-filesystem-watcher-setup',\n          folderPath,\n          JSON.stringify({\n            ignore,\n          })\n        );\n\n        return () => {\n          ipcRenderer.removeAllListeners('project-file-changed');\n          subscriptionIdPromise.then(subscriptionId => {\n            ipcRenderer.invoke(\n              'local-filesystem-watcher-disable',\n              subscriptionId\n            );\n          });\n        };\n      }\n    : undefined;\n","// @flow\nimport * as React from 'react';\nimport { Trans, t } from '@lingui/macro';\nimport { type StorageProvider, type FileMetadata } from '../index';\nimport {\n  onOpenWithPicker,\n  onOpen,\n  getAutoSaveCreationDate,\n  onGetAutoSave,\n} from './LocalProjectOpener';\nimport {\n  onSaveProject,\n  generateOnChooseSaveProjectAsLocation,\n  onSaveProjectAs,\n  onAutoSaveProject,\n  getWriteErrorMessage,\n  renderNewProjectSaveAsLocationChooser,\n  getProjectLocation,\n  isTryingToSaveInForbiddenPath,\n} from './LocalProjectWriter';\nimport {\n  type AppArguments,\n  POSITIONAL_ARGUMENTS_KEY,\n} from '../../Utils/Window';\nimport { type MessageDescriptor } from '../../Utils/i18n/MessageDescriptor.flow';\nimport Computer from '../../UI/CustomSvgIcons/Computer';\nimport {\n  copyResourceFilePath,\n  locateResourceFile,\n  openResourceFile,\n  removeAllResourcesWithInvalidPath,\n  scanForNewResources,\n} from './LocalProjectResourcesHandler';\nimport { allResourceKindsAndMetadata } from '../../ResourcesList/ResourceSource';\nimport {\n  type ShowAlertFunction,\n  type ShowConfirmFunction,\n} from '../../UI/Alert/AlertContext';\nimport { setupResourcesWatcher } from './LocalFileResourcesWatcher';\n\n/**\n * Use the Electron APIs to provide access to the native\n * file system (with native save/open dialogs).\n */\nexport default ({\n  internalName: 'LocalFile',\n  name: t`Your computer`,\n  renderIcon: props => <Computer fontSize={props.size} />,\n  getFileMetadataFromAppArguments: (appArguments: AppArguments) => {\n    if (!appArguments[POSITIONAL_ARGUMENTS_KEY]) return null;\n    if (!appArguments[POSITIONAL_ARGUMENTS_KEY].length) return null;\n\n    return {\n      fileIdentifier: appArguments[POSITIONAL_ARGUMENTS_KEY][0],\n    };\n  },\n  getProjectLocation: getProjectLocation,\n  renderNewProjectSaveAsLocationChooser: renderNewProjectSaveAsLocationChooser,\n  setupResourcesWatcher,\n  createOperations: ({ setDialog, closeDialog }) => ({\n    onOpenWithPicker,\n    onOpen,\n    getAutoSaveCreationDate,\n    onSaveProject,\n    onChooseSaveProjectAsLocation: generateOnChooseSaveProjectAsLocation({\n      setDialog,\n      closeDialog,\n    }),\n    onSaveProjectAs,\n    onAutoSaveProject,\n    onGetAutoSave,\n    getOpenErrorMessage: (error: Error): MessageDescriptor => {\n      return t`Check that the file exists, that this file is a proper game created with GDevelop and that you have the authorization to open it.`;\n    },\n    getWriteErrorMessage,\n    canFileMetadataBeSafelySaved: async (\n      fileMetadata: FileMetadata,\n      actions: {|\n        showAlert: ShowAlertFunction,\n        showConfirmation: ShowConfirmFunction,\n      |}\n    ) => {\n      const path = fileMetadata.fileIdentifier;\n      if (isTryingToSaveInForbiddenPath(path)) {\n        await actions.showAlert({\n          title: t`Choose another location`,\n          message: t`Your project is saved in the same folder as the application. This folder will be deleted when the application is updated. Please choose another location if you don't want to lose your project.`,\n        });\n      }\n\n      // We don't block the save, in case the user wants to save anyway.\n      return true;\n    },\n    canFileMetadataBeSafelySavedAs: async (\n      fileMetadata: FileMetadata,\n      actions: {|\n        showAlert: ShowAlertFunction,\n        showConfirmation: ShowConfirmFunction,\n      |}\n    ) => {\n      const path = fileMetadata.fileIdentifier;\n      if (isTryingToSaveInForbiddenPath(path)) {\n        await actions.showAlert({\n          title: t`Choose another location`,\n          message: t`Your project is saved in the same folder as the application. This folder will be deleted when the application is updated. Please choose another location if you don't want to lose your project.`,\n        });\n\n        // We block the save as we don't want new projects to be saved there.\n        return false;\n      }\n\n      return true;\n    },\n  }),\n  createResourceOperations: () => ({\n    project,\n    resource,\n    i18n,\n    updateInterface,\n    cleanUserSelectionOfResources,\n    informUser,\n  }) => [\n    {\n      label: i18n._(t`Locate file`),\n      click: () => locateResourceFile({ project, resource }),\n    },\n    {\n      label: i18n._(t`Open file`),\n      click: () => openResourceFile({ project, resource }),\n    },\n    {\n      label: i18n._(t`Copy file path`),\n      click: () => {\n        copyResourceFilePath({ project, resource });\n        informUser({\n          message: <Trans>Resource file path copied to clipboard</Trans>,\n        });\n      },\n    },\n    { type: 'separator' },\n    {\n      label: i18n._(t`Scan in the project folder for...`),\n      submenu: allResourceKindsAndMetadata.map(\n        ({ displayName, fileExtensions, createNewResource }) => ({\n          label: i18n._(displayName),\n          click: async () => {\n            await scanForNewResources({\n              project,\n              extensions: fileExtensions,\n              createResource: createNewResource,\n            });\n            updateInterface();\n          },\n        })\n      ),\n    },\n    {\n      label: i18n._(t`Remove resources with invalid path`),\n      click: () => {\n        removeAllResourcesWithInvalidPath({ project });\n        // Remove user selection in case the user selected a resource\n        // that was just removed.\n        cleanUserSelectionOfResources();\n        // Force update of the resources list as otherwise it could render\n        // resources that were just deleted.\n        updateInterface();\n      },\n    },\n  ],\n}: StorageProvider);\n","// @flow\nimport * as React from 'react';\nimport optionalRequire from '../Utils/OptionalRequire';\nimport PreferencesContext from '../MainFrame/Preferences/PreferencesContext';\nconst electron = optionalRequire('electron');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\n\ntype Props = {\n  onGDJSUpdated: () => Promise<void> | void,\n};\n\n/**\n * Set up some watchers for GDJS and Extensions sources.\n * Stop the watchers when the component is unmounted or `shouldWatch` prop is false.\n */\nexport const LocalGDJSDevelopmentWatcher = ({ onGDJSUpdated }: Props) => {\n  const preferences = React.useContext(PreferencesContext);\n  const shouldWatch = preferences.values.useGDJSDevelopmentWatcher;\n\n  React.useEffect(\n    () => {\n      if (!shouldWatch) {\n        // Nothing to set up in the effect if watch is deactivated.\n        return;\n      }\n\n      if (!ipcRenderer) {\n        console.error(\n          'Unable to find ipcRenderer to set up GDJS development watchers'\n        );\n        return;\n      }\n\n      ipcRenderer.send('setup-local-gdjs-development-watcher');\n      return () => {\n        ipcRenderer.send('close-local-gdjs-development-watcher');\n      };\n    },\n    [shouldWatch]\n  );\n\n  React.useEffect(\n    () => {\n      if (!shouldWatch) {\n        // Nothing to set up in the effect if watch is deactivated.\n        return;\n      }\n\n      if (!ipcRenderer) {\n        return;\n      }\n\n      ipcRenderer.removeAllListeners(\n        'local-gdjs-development-watcher-runtime-updated'\n      );\n      ipcRenderer.on(\n        'local-gdjs-development-watcher-runtime-updated',\n        (event, err) => {\n          onGDJSUpdated();\n        }\n      );\n\n      return () => {\n        ipcRenderer.removeAllListeners(\n          'local-gdjs-development-watcher-runtime-updated'\n        );\n      };\n    },\n    [shouldWatch, onGDJSUpdated]\n  );\n\n  return null;\n};\n","// @flow\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport PromisePool from '@supercharge/promise-pool';\nimport { retryIfFailed } from '../../Utils/RetryIfFailed';\nimport newNameGenerator from '../../Utils/NewNameGenerator';\nimport { type FileMetadata } from '../index';\nimport {\n  extractDecodedFilenameWithExtensionFromProductAuthorizedUrl,\n  fetchTokenForPrivateGameTemplateAuthorizationIfNeeded,\n  isPrivateGameTemplateResourceAuthorizedUrl,\n  isProductAuthorizedResourceUrl,\n} from '../../Utils/GDevelopServices/Shop';\nimport {\n  extractDecodedFilenameWithExtensionFromPublicAssetResourceUrl,\n  isPublicAssetResourceUrl,\n} from '../../Utils/GDevelopServices/Asset';\nimport {\n  isBlobURL,\n  isURL,\n  parseLocalFilePathOrExtensionFromMetadata,\n} from '../../ResourcesList/ResourceUtils';\nimport { sanitizeFilename } from '../../Utils/Filename';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { extractDecodedFilenameFromProjectResourceUrl } from '../../Utils/GDevelopServices/Project';\nimport axios from 'axios';\nconst electron = optionalRequire('electron');\nconst ipcRenderer = electron ? electron.ipcRenderer : null;\nconst fs = optionalRequire('fs-extra');\nconst path = optionalRequire('path');\n\ntype Options = {|\n  project: gdProject,\n  fileMetadata: FileMetadata,\n  onProgress: (number, number) => void,\n  authenticatedUser: AuthenticatedUser,\n|};\n\nconst generateUnusedFilepath = (\n  basePath: string,\n  alreadyUsedFilePaths: Set<string>,\n  filename: string\n) => {\n  const extension = path.extname(filename);\n  const filenameWithoutExtension = path.basename(filename, extension);\n  const name = newNameGenerator(filenameWithoutExtension, name => {\n    const tentativePath = path.join(basePath, name) + extension;\n    return (\n      fs.existsSync(tentativePath) || alreadyUsedFilePaths.has(tentativePath)\n    );\n  });\n  return path.join(basePath, name) + extension;\n};\n\nconst downloadBlobToLocalFile = async (\n  blobUrl: string,\n  filePath: string\n): Promise<void> => {\n  if (!ipcRenderer) throw new Error('Not supported');\n\n  const response = await axios.get(blobUrl, {\n    responseType: 'arraybuffer',\n  });\n  const arrayBuffer = response.data;\n\n  await ipcRenderer.invoke(\n    'local-file-save-from-arraybuffer',\n    arrayBuffer,\n    filePath\n  );\n};\n\n// This mover can be used for both public URLs and Cloud project resources.\nexport const moveUrlResourcesToLocalFiles = async ({\n  project,\n  fileMetadata,\n  onProgress,\n  authenticatedUser,\n}: Options) => {\n  if (!fs || !ipcRenderer) throw new Error('Unsupported');\n\n  // Get all resources to download.\n  const resourcesManager = project.getResourcesManager();\n  const allResourceNames = resourcesManager.getAllResourceNames().toJSArray();\n  const resourcesToFetchNames = allResourceNames.filter(resourceName => {\n    const resource = resourcesManager.getResource(resourceName);\n    const resourceFile = resource.getFile();\n    return isURL(resourceFile);\n  });\n  const tokenForPrivateGameTemplateAuthorization = await fetchTokenForPrivateGameTemplateAuthorizationIfNeeded(\n    {\n      authenticatedUser,\n      allResourcePaths: resourcesToFetchNames.map(resourceName => {\n        const resource = resourcesManager.getResource(resourceName);\n        return resource.getFile();\n      }),\n    }\n  );\n\n  const projectPath = path.dirname(fileMetadata.fileIdentifier);\n  const baseAssetsPath = path.join(projectPath, 'assets');\n  const downloadedFilePaths = new Set<string>();\n  const erroredResources = [];\n\n  let fetchedResourcesCount = 0;\n\n  await PromisePool.withConcurrency(50)\n    .for(resourcesToFetchNames) // It's important not to loop on allResourceNames, as calling the onProgress can be costly on the UI.\n    .process(async resourceName => {\n      const resource = resourcesManager.getResource(resourceName);\n\n      const resourceFile = resource.getFile();\n      if (isURL(resourceFile)) {\n        if (isBlobURL(resourceFile)) {\n          try {\n            const {\n              localFilePath,\n              extension,\n            } = parseLocalFilePathOrExtensionFromMetadata(resource);\n            const downloadedFilePath = localFilePath\n              ? path.resolve(projectPath, localFilePath)\n              : generateUnusedFilepath(\n                  baseAssetsPath,\n                  downloadedFilePaths,\n                  sanitizeFilename(resource.getName() + (extension || ''))\n                );\n\n            await fs.ensureDir(baseAssetsPath);\n            await downloadBlobToLocalFile(resourceFile, downloadedFilePath);\n            resource.setFile(\n              path.relative(projectPath, downloadedFilePath).replace(/\\\\/g, '/')\n            );\n          } catch (error) {\n            erroredResources.push({ resourceName, error });\n          }\n        } else {\n          let filename;\n          if (isProductAuthorizedResourceUrl(resourceFile)) {\n            // Resource is coming from a private asset or private game template.\n            filename = extractDecodedFilenameWithExtensionFromProductAuthorizedUrl(\n              resourceFile\n            );\n          } else if (isPublicAssetResourceUrl(resourceFile)) {\n            // Resource is coming from a public asset.\n            filename = extractDecodedFilenameWithExtensionFromPublicAssetResourceUrl(\n              resourceFile\n            );\n          } else {\n            // Resource is a project resource or a generic url.\n            filename = extractDecodedFilenameFromProjectResourceUrl(\n              resourceFile\n            );\n          }\n\n          // Find a new file for the resource to download.\n          const downloadedFilePath = generateUnusedFilepath(\n            baseAssetsPath,\n            downloadedFilePaths,\n            filename\n          );\n          downloadedFilePaths.add(downloadedFilePath);\n\n          try {\n            await retryIfFailed({ times: 2 }, async () => {\n              await fs.ensureDir(baseAssetsPath);\n              const resourceUrl = new URL(resourceFile);\n              if (\n                isPrivateGameTemplateResourceAuthorizedUrl(resourceUrl.href) &&\n                tokenForPrivateGameTemplateAuthorization\n              ) {\n                resourceUrl.searchParams.set(\n                  'token',\n                  tokenForPrivateGameTemplateAuthorization\n                );\n              }\n              const encodedUrl = resourceUrl.href; // Encode the URL to support special characters in file names.\n              await ipcRenderer.invoke(\n                'local-file-download',\n                encodedUrl,\n                downloadedFilePath\n              );\n              resource.setFile(\n                path\n                  .relative(projectPath, downloadedFilePath)\n                  .replace(/\\\\/g, '/')\n              );\n            });\n          } catch (error) {\n            erroredResources.push({ resourceName, error });\n          }\n        }\n      }\n\n      onProgress(fetchedResourcesCount++, resourcesToFetchNames.length);\n    });\n\n  return {\n    erroredResources,\n  };\n};\n","// @flow\n\nexport const processByChunk = async <Item, MappedItem>(\n  array: Array<Item>,\n  {\n    transformItem,\n    isChunkTooBig,\n    processChunk,\n  }: {|\n    transformItem: Item => Promise<MappedItem>,\n    isChunkTooBig: (MappedItem[]) => boolean,\n    processChunk: (MappedItem[]) => Promise<void>,\n  |}\n): Promise<void> => {\n  let currentItemIndex = 0;\n  const nextChunk: Array<MappedItem> = [];\n\n  while (currentItemIndex < array.length) {\n    const mappedItem = await transformItem(array[currentItemIndex]);\n\n    if (!nextChunk.length) {\n      // Existing chunk is empty - let the new item be added to it.\n    } else {\n      if (!isChunkTooBig([...nextChunk, mappedItem])) {\n        // Item can be added to the existing chunk - let's add it.\n      } else {\n        // Item can't be added to the existing chunk - process the existing chunk\n        await processChunk(nextChunk);\n        nextChunk.length = 0;\n      }\n    }\n\n    nextChunk.push(mappedItem);\n    currentItemIndex++;\n  }\n\n  if (nextChunk.length) {\n    await processChunk(nextChunk);\n    nextChunk.length = 0;\n  }\n\n  return;\n};\n","// @flow\r\nimport optionalRequire from './OptionalRequire';\r\nconst path = optionalRequire('path');\r\nconst fs = optionalRequire('fs');\r\n\r\nconst readLocalFileToArrayBuffer = async (\r\n  filePath: string\r\n): Promise<ArrayBuffer> => {\r\n  const buffer: Buffer = await new Promise((resolve, reject) => {\r\n    fs.readFile(filePath, function(err, buffer) {\r\n      if (err) {\r\n        reject(err);\r\n        return;\r\n      }\r\n\r\n      resolve(buffer);\r\n    });\r\n  });\r\n\r\n  // See https://stackoverflow.com/questions/8609289/convert-a-binary-nodejs-buffer-to-javascript-arraybuffer:\r\n  // The slice and offset stuff is required because small Buffers (less than 4 kB by default, half the pool size)\r\n  // can be views on a shared ArrayBuffer. Without slicing, you can end up with an ArrayBuffer containing data from another Buffer.\r\n  const arrayBuffer = buffer.buffer.slice(\r\n    buffer.byteOffset,\r\n    buffer.byteOffset + buffer.byteLength\r\n  );\r\n  return arrayBuffer;\r\n};\r\n\r\n// See https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types.\r\nconst extensionToMimeType = {\r\n  // Common audio extensions:\r\n  aac: 'audio/aac',\r\n  wav: 'audio/wav',\r\n  mp3: 'audio/mp3',\r\n  ogg: 'audio/ogg',\r\n\r\n  // Common image extensions:\r\n  png: 'image/png',\r\n  jpg: 'image/jpeg',\r\n  jpeg: 'image/jpeg',\r\n  webp: 'image/webp',\r\n\r\n  // Common font extensions:\r\n  ttf: 'font/ttf',\r\n  otf: 'font/otf',\r\n\r\n  // Common video extensions:\r\n  mp4: 'video/mp4',\r\n  webm: 'video/webm',\r\n\r\n  // Other common extensions:\r\n  json: 'application/json',\r\n  xml: 'application/xml',\r\n  gz: 'application/gzip',\r\n  js: 'application/javascript',\r\n};\r\n\r\nexport const readLocalFileToFile = async (filePath: string): Promise<File> => {\r\n  const arrayBuffer = await readLocalFileToArrayBuffer(filePath);\r\n  const extensionWithoutLeadingDot = path.extname(filePath).replace(/^\\./, '');\r\n  return new File([arrayBuffer], path.basename(filePath), {\r\n    type:\r\n      extensionToMimeType[extensionWithoutLeadingDot] ||\r\n      'application/octet-stream',\r\n  });\r\n};\r\n","// @flow\nimport {\n  type MoveAllProjectResourcesOptions,\n  type MoveAllProjectResourcesResult,\n  type MoveAllProjectResourcesFunction,\n} from './index';\nimport LocalFileStorageProvider from '../LocalFileStorageProvider';\nimport { moveUrlResourcesToLocalFiles } from '../LocalFileStorageProvider/LocalFileResourceMover';\nimport UrlStorageProvider from '../UrlStorageProvider';\nimport CloudStorageProvider from '../CloudStorageProvider';\nimport LocalFileSystem from '../../ExportAndShare/LocalExporters/LocalFileSystem';\nimport assignIn from 'lodash/assignIn';\nimport optionalRequire from '../../Utils/OptionalRequire';\nimport { moveUrlResourcesToCloudProject } from '../CloudStorageProvider/CloudResourceMover';\nimport { checkIfIsGDevelopCloudBucketUrl } from '../../Utils/CrossOrigin';\nimport {\n  getCredentialsForCloudProject,\n  uploadProjectResourceFiles,\n  type UploadedProjectResourceFiles,\n} from '../../Utils/GDevelopServices/Project';\nimport { processByChunk } from '../../Utils/ProcessByChunk';\nimport { readLocalFileToFile } from '../../Utils/LocalFileUploader';\nimport { isURL, isBlobURL } from '../../ResourcesList/ResourceUtils';\nconst path = optionalRequire('path');\n\nconst gd: libGDevelop = global.gd;\n\ntype ResourceAndFile = {|\n  resource: gdResource,\n  file: File,\n|};\n\nexport const moveAllLocalResourcesToCloudResources = async ({\n  project,\n  authenticatedUser,\n  oldFileMetadata,\n  newFileMetadata,\n  onProgress,\n}: MoveAllProjectResourcesOptions): Promise<MoveAllProjectResourcesResult> => {\n  const result: MoveAllProjectResourcesResult = {\n    erroredResources: [],\n  };\n\n  const newCloudProjectId = newFileMetadata.fileIdentifier;\n\n  const resourcesManager = project.getResourcesManager();\n\n  /**\n   * Find the local resources that must be\n   * uploaded into the new project.\n   */\n  const getResourcesToUpload = (project: gdProject): Array<gdResource> => {\n    const allResourceNames = resourcesManager.getAllResourceNames().toJSArray();\n    return allResourceNames\n      .map(\n        (resourceName: string): ?gdResource => {\n          const resource = resourcesManager.getResource(resourceName);\n          const resourceFile = resource.getFile();\n\n          if (isURL(resourceFile)) {\n            if (checkIfIsGDevelopCloudBucketUrl(resourceFile)) {\n              // URL from a cloud project: this is unlikely and would not work\n              // (as the project is a local project). Still, ignore this.\n              return null;\n            } else if (isBlobURL(resourceFile)) {\n              result.erroredResources.push({\n                resourceName: resource.getName(),\n                error: new Error('Unsupported blob URL.'),\n              });\n              return null;\n            } else {\n              // Public URL resource: nothing to do.\n              return null;\n            }\n          } else {\n            // Local resource to be downloaded.\n            return resource;\n          }\n        }\n      )\n      .filter(Boolean);\n  };\n\n  const allResourcesToUpload = getResourcesToUpload(project);\n\n  const projectPath = path.dirname(oldFileMetadata.fileIdentifier);\n\n  let alreadyDoneCount = 0;\n  // Read all files as Files.\n  await processByChunk(allResourcesToUpload, {\n    transformItem: async (resource): Promise<ResourceAndFile | null> => {\n      const resourceAbsolutePath = path.resolve(\n        projectPath,\n        resource.getFile()\n      );\n\n      try {\n        const file = await readLocalFileToFile(resourceAbsolutePath);\n        return {\n          resource,\n          file,\n        };\n      } catch (error) {\n        result.erroredResources.push({\n          resourceName: resource.getName(),\n          error: new Error(\n            `Unable to open the file (${resourceAbsolutePath}).`\n          ),\n        });\n        return null;\n      }\n    },\n    isChunkTooBig: (resourceAndFilesChunk: Array<ResourceAndFile | null>) => {\n      if (resourceAndFilesChunk.length > 70) return true;\n\n      const allBufferSize = resourceAndFilesChunk\n        .filter(Boolean)\n        .reduce((size, { file }) => size + file.size, 0);\n\n      // Stop a chunk when more than 150MB are read to be uploaded. This is\n      // to avoid loading all resources in memory at once. This don't give an exact\n      // guarantee on the upper bound (a single file could be more than 150MB), but\n      // this limits the risks of running out of memory.\n      return allBufferSize > 150 * 1000 * 1000;\n    },\n    processChunk: async (\n      resourceAndFilesChunk: Array<ResourceAndFile | null>\n    ) => {\n      const resourceAndFilesToUpload: ResourceAndFile[] = resourceAndFilesChunk.filter(\n        Boolean\n      );\n\n      // Upload the files just read, for the new project.\n      await getCredentialsForCloudProject(authenticatedUser, newCloudProjectId);\n      const uploadedProjectResourceFiles: UploadedProjectResourceFiles = await uploadProjectResourceFiles(\n        authenticatedUser,\n        newCloudProjectId,\n        resourceAndFilesToUpload.map(({ file }) => file),\n        (count, total) => {\n          onProgress(alreadyDoneCount + count, allResourcesToUpload.length);\n        }\n      );\n      alreadyDoneCount += resourceAndFilesChunk.length;\n\n      // Update resources with the newly created URLs.\n      uploadedProjectResourceFiles.forEach(({ url, error }, index) => {\n        const resource = resourceAndFilesToUpload[index].resource;\n        if (error || !url) {\n          result.erroredResources.push({\n            resourceName: resource.getName(),\n            error: error || new Error('Unknown error during upload.'),\n          });\n          return;\n        }\n\n        resource.setFile(url);\n      });\n    },\n  });\n\n  return result;\n};\n\nconst movers: {\n  [string]: MoveAllProjectResourcesFunction,\n} = {\n  [`${LocalFileStorageProvider.internalName}=>${\n    LocalFileStorageProvider.internalName\n  }`]: async ({ project, newFileMetadata }: MoveAllProjectResourcesOptions) => {\n    // TODO: Ideally, errors while copying resources should be reported.\n    // TODO: Report progress.\n    const projectPath = path.dirname(newFileMetadata.fileIdentifier);\n    const fileSystem = assignIn(\n      new gd.AbstractFileSystemJS(),\n      new LocalFileSystem()\n    );\n    gd.ProjectResourcesCopier.copyAllResourcesTo(\n      project,\n      // $FlowFixMe - fileSystem is a gdAbstractFileSystem, despite the assignIn.\n      fileSystem,\n      projectPath,\n      true, // Update the project with the new resource paths\n      false, // Don't move absolute files\n      true // Keep relative files folders structure.\n    );\n    return {\n      erroredResources: [],\n    };\n  },\n  // When saving a Cloud project locally, all resources are downloaded (including\n  // the ones on GDevelop Cloud or private game templates).\n  [`${CloudStorageProvider.internalName}=>${\n    LocalFileStorageProvider.internalName\n  }`]: ({ project, newFileMetadata, onProgress, authenticatedUser }) =>\n    moveUrlResourcesToLocalFiles({\n      project,\n      fileMetadata: newFileMetadata,\n      onProgress,\n      authenticatedUser,\n    }),\n  // On the desktop app, try to download all URLs into local files, put\n  // next to the project file (in a \"assets\" directory). This is helpful\n  // to continue working on a game started on the web-app (using public URLs\n  // for resources).\n  // This is also helpful to download private game templates resources so that\n  // the game can be opened offline.\n  [`${UrlStorageProvider.internalName}=>${\n    LocalFileStorageProvider.internalName\n  }`]: ({ project, newFileMetadata, onProgress, authenticatedUser }) =>\n    moveUrlResourcesToLocalFiles({\n      project,\n      fileMetadata: newFileMetadata,\n      onProgress,\n      authenticatedUser,\n    }),\n\n  // Moving to GDevelop \"Cloud\" storage:\n\n  // From a local project to a Cloud project, all resources are uploaded.\n  [`${LocalFileStorageProvider.internalName}=>${\n    CloudStorageProvider.internalName\n  }`]: moveAllLocalResourcesToCloudResources,\n  // From a Cloud project to another, resources need to be copied\n  // (unless they are public URLs).\n  [`${CloudStorageProvider.internalName}=>${\n    CloudStorageProvider.internalName\n  }`]: moveUrlResourcesToCloudProject,\n  // Nothing to move around when going from a project on a public URL\n  // to a cloud project (we could offer an option one day though to download\n  // and upload the URL resources on GDevelop Cloud).\n  [`${UrlStorageProvider.internalName}=>${\n    CloudStorageProvider.internalName\n  }`]: moveUrlResourcesToCloudProject,\n};\n\nconst LocalResourceMover = {\n  moveAllProjectResources: async (\n    options: MoveAllProjectResourcesOptions\n  ): Promise<MoveAllProjectResourcesResult> => {\n    const { oldStorageProvider, newStorageProvider } = options;\n    const mover =\n      movers[\n        `${oldStorageProvider.internalName}=>${newStorageProvider.internalName}`\n      ];\n    if (!mover)\n      throw new Error(\n        `Can't find a ResourceMover for ${oldStorageProvider.internalName} to ${\n          newStorageProvider.internalName\n        }.`\n      );\n\n    return mover(options);\n  },\n};\n\nexport default LocalResourceMover;\n","// @flow\nimport {\n  type ResourceFetcher,\n  type FetchAllProjectResourcesOptions,\n  type FetchAllProjectResourcesResult,\n  type FetchAllProjectResourcesFunction,\n} from './index';\nimport LocalFileStorageProvider from '../LocalFileStorageProvider';\nimport { moveUrlResourcesToLocalFiles } from '../LocalFileStorageProvider/LocalFileResourceMover';\nimport UrlStorageProvider from '../UrlStorageProvider';\nimport CloudStorageProvider from '../CloudStorageProvider';\nimport { fetchRelativeResourcesToFullUrls } from '../UrlStorageProvider/UrlResourceFetcher';\nimport { moveUrlResourcesToCloudFilesIfPrivate } from '../CloudStorageProvider/CloudResourceFetcher';\n\nconst fetchers: {\n  [string]: FetchAllProjectResourcesFunction,\n} = {\n  // The Cloud file storage provider fetches the resources that are\n  // private URLs by downloading them and reuploading them to the cloud.\n  [CloudStorageProvider.internalName]: moveUrlResourcesToCloudFilesIfPrivate,\n  // The local file storage provider fetches the resources that are URLs\n  // by downloading them locally.\n  [LocalFileStorageProvider.internalName]: moveUrlResourcesToLocalFiles,\n  // The URL storage consider relative resources to be relative to the project\n  // URL. This allows to open local projects uploaded to GitHub for example.\n  [UrlStorageProvider.internalName]: fetchRelativeResourcesToFullUrls,\n};\n\nconst LocalResourceFetcher: ResourceFetcher = {\n  fetchAllProjectResources: async (\n    options: FetchAllProjectResourcesOptions\n  ): Promise<FetchAllProjectResourcesResult> => {\n    const { storageProvider } = options;\n    const fetcher = fetchers[storageProvider.internalName];\n    if (!fetcher)\n      throw new Error(\n        `Can't find a ResourceFetcher for ${\n          storageProvider.internalName\n        } - have you registered the storage provider here?`\n      );\n\n    return fetcher(options);\n  },\n};\n\nexport default LocalResourceFetcher;\n","// @flow\nimport {\n  signInWithEmailAndPassword,\n  type Auth,\n  signInWithCredential,\n  GoogleAuthProvider,\n  OAuthProvider,\n  GithubAuthProvider,\n} from 'firebase/auth';\nimport type { LoginProvider, FirebaseBasedLoginProvider } from '.';\nimport type { IdentityProvider } from '../Utils/GDevelopServices/Authentication';\nimport {\n  setupAuthenticationWebSocket,\n  terminateWebSocket,\n} from '../Utils/GDevelopServices/Authorization';\nimport Window from '../Utils/Window';\nimport { UserCancellationError } from './Utils';\n\nconst isDev = Window.isDev();\n\nconst authenticationPortalUrl = 'https://auth.gdevelop.io';\n\nclass LocalLoginProvider implements LoginProvider, FirebaseBasedLoginProvider {\n  auth: Auth;\n  constructor(auth: Auth) {\n    this.auth = auth;\n  }\n\n  async loginWithEmailAndPassword({\n    email,\n    password,\n  }: {|\n    email: string,\n    password: string,\n  |}) {\n    try {\n      await signInWithEmailAndPassword(this.auth, email, password);\n      // The user is now stored in `this.auth`.\n    } catch (error) {\n      console.error('Error while login:', error);\n      throw error;\n    }\n  }\n\n  async loginOrSignupWithProvider({\n    provider,\n    signal,\n  }: {|\n    provider: IdentityProvider,\n    signal?: AbortSignal,\n  |}) {\n    if (signal && signal.aborted) {\n      return Promise.reject(\n        new UserCancellationError(\n          'Login or Signup with provider already aborted.'\n        )\n      );\n    }\n    const promise = new Promise((resolve, reject) => {\n      // Listen for abort event on signal\n      if (signal) {\n        signal.addEventListener('abort', () => {\n          terminateWebSocket();\n          reject(\n            new UserCancellationError(\n              'Login or Signup with provider already aborted.'\n            )\n          );\n        });\n      }\n      setupAuthenticationWebSocket({\n        onConnectionEstablished: connectionId => {\n          if (signal && signal.aborted) return;\n          const url = new URL(authenticationPortalUrl);\n          url.searchParams.set('connection-id', connectionId);\n          url.searchParams.set('provider', provider);\n          url.searchParams.set('env', isDev ? 'dev' : 'live');\n          Window.openExternalURL(url.toString());\n        },\n        onTokenReceived: async ({\n          provider,\n          data,\n        }: {|\n          provider: 'apple' | 'google' | 'github',\n          data: any,\n        |}) => {\n          if (signal && signal.aborted) return;\n          try {\n            const credential =\n              provider === 'google'\n                ? GoogleAuthProvider.credential(data.credential)\n                : provider === 'github'\n                ? GithubAuthProvider.credential(data.accessToken)\n                : new OAuthProvider('apple.com').credential({\n                    idToken: data.id_token,\n                    // Typescript types declaration indicates the parameter `rawNonce` should be\n                    // set but it only works with `nonce`.\n                    nonce: data.raw_nonce,\n                  });\n            await signInWithCredential(this.auth, credential);\n            resolve();\n            terminateWebSocket();\n          } catch (error) {\n            console.error(\n              `An error occurred while logging in with ${provider} token:`,\n              error\n            );\n            reject(error);\n          }\n        },\n        onError: error => {\n          if (signal && signal.aborted) return;\n          terminateWebSocket();\n          console.error(\n            'An error occurred while setting up authentication web socket:',\n            error\n          );\n          reject(\n            new Error(\n              'An error occurred while setting up authentication web socket.'\n            )\n          );\n        },\n        onTimeout: () => {\n          if (signal && signal.aborted) return;\n          terminateWebSocket();\n          console.error('Connection to authorization websocket timed out.');\n          reject(new Error('Connection to authorization websocket timed out.'));\n        },\n      });\n    });\n    return promise;\n  }\n}\n\nexport default LocalLoginProvider;\n","// @flow\nimport React from 'react';\nimport MainFrame from './MainFrame';\nimport Window from './Utils/Window';\nimport ShareDialog from './ExportAndShare/ShareDialog';\nimport Authentication from './Utils/GDevelopServices/Authentication';\nimport './UI/icomoon-font.css'; // Styles for Icomoon font.\n\n// Import for Electron powered IDE.\nimport localResourceSources from './ResourcesList/LocalResourceSources';\nimport localResourceExternalEditors from './ResourcesList/LocalResourceExternalEditors';\nimport LocalPreviewLauncher from './ExportAndShare/LocalExporters/LocalPreviewLauncher';\nimport {\n  localAutomatedExporters,\n  localManualExporters,\n  localOnlineWebExporter,\n} from './ExportAndShare/LocalExporters';\nimport ElectronMainMenu from './MainFrame/ElectronMainMenu';\nimport makeExtensionsLoader from './JsExtensionsLoader/LocalJsExtensionsLoader';\nimport { makeLocalEventsFunctionCodeWriter } from './EventsFunctionsExtensionsLoader/CodeWriters/LocalEventsFunctionCodeWriter';\nimport ObjectsEditorService from './ObjectEditor/ObjectsEditorService';\nimport ObjectsRenderingService from './ObjectsRendering/ObjectsRenderingService';\nimport Providers from './MainFrame/Providers';\nimport LocalEventsFunctionsExtensionWriter from './EventsFunctionsExtensionsLoader/Storage/LocalEventsFunctionsExtensionWriter';\nimport LocalEventsFunctionsExtensionOpener from './EventsFunctionsExtensionsLoader/Storage/LocalEventsFunctionsExtensionOpener';\nimport ProjectStorageProviders from './ProjectsStorage/ProjectStorageProviders';\nimport LocalFileStorageProvider from './ProjectsStorage/LocalFileStorageProvider';\nimport { LocalGDJSDevelopmentWatcher } from './GameEngineFinder/LocalGDJSDevelopmentWatcher';\nimport CloudStorageProvider from './ProjectsStorage/CloudStorageProvider';\nimport UrlStorageProvider from './ProjectsStorage/UrlStorageProvider';\nimport LocalResourceMover from './ProjectsStorage/ResourceMover/LocalResourceMover';\nimport LocalResourceFetcher from './ProjectsStorage/ResourceFetcher/LocalResourceFetcher';\nimport LocalLoginProvider from './LoginProvider/LocalLoginProvider';\n\nconst gd: libGDevelop = global.gd;\n\nexport const create = (authentication: Authentication) => {\n  Window.setUpContextMenu();\n  const loginProvider = new LocalLoginProvider(authentication.auth);\n  authentication.setLoginProvider(loginProvider);\n\n  const appArguments = Window.getArguments();\n  const isDev = Window.isDev();\n\n  return (\n    <Providers\n      authentication={authentication}\n      disableCheckForUpdates={!!appArguments['disable-update-check']}\n      makeEventsFunctionCodeWriter={makeLocalEventsFunctionCodeWriter}\n      eventsFunctionsExtensionWriter={LocalEventsFunctionsExtensionWriter}\n      eventsFunctionsExtensionOpener={LocalEventsFunctionsExtensionOpener}\n    >\n      {({ i18n }) => (\n        <ProjectStorageProviders\n          appArguments={appArguments}\n          storageProviders={[\n            LocalFileStorageProvider,\n            UrlStorageProvider,\n            CloudStorageProvider,\n          ]}\n          defaultStorageProvider={LocalFileStorageProvider}\n        >\n          {({\n            getStorageProviderOperations,\n            getStorageProviderResourceOperations,\n            storageProviders,\n            initialFileMetadataToOpen,\n            getStorageProvider,\n          }) => (\n            <MainFrame\n              i18n={i18n}\n              renderMainMenu={(props, callbacks, extraCallbacks) => (\n                <ElectronMainMenu\n                  props={props}\n                  callbacks={callbacks}\n                  extraCallbacks={extraCallbacks}\n                />\n              )}\n              renderPreviewLauncher={(props, ref) => (\n                <LocalPreviewLauncher {...props} ref={ref} />\n              )}\n              renderShareDialog={props => (\n                <ShareDialog\n                  project={props.project}\n                  onSaveProject={props.onSaveProject}\n                  isSavingProject={props.isSavingProject}\n                  onChangeSubscription={props.onChangeSubscription}\n                  onClose={props.onClose}\n                  automatedExporters={localAutomatedExporters}\n                  manualExporters={localManualExporters}\n                  onlineWebExporter={localOnlineWebExporter}\n                  fileMetadata={props.fileMetadata}\n                  storageProvider={props.storageProvider}\n                  initialTab={props.initialTab}\n                  gamesList={props.gamesList}\n                />\n              )}\n              quickPublishOnlineWebExporter={localOnlineWebExporter}\n              renderGDJSDevelopmentWatcher={\n                isDev ? ({ onGDJSUpdated }) => <LocalGDJSDevelopmentWatcher onGDJSUpdated={onGDJSUpdated} /> : null\n              }\n              storageProviders={storageProviders}\n              resourceMover={LocalResourceMover}\n              resourceFetcher={LocalResourceFetcher}\n              getStorageProviderOperations={getStorageProviderOperations}\n              getStorageProviderResourceOperations={\n                getStorageProviderResourceOperations\n              }\n              getStorageProvider={getStorageProvider}\n              resourceSources={localResourceSources}\n              resourceExternalEditors={localResourceExternalEditors}\n              extensionsLoader={makeExtensionsLoader({\n                gd,\n                objectsEditorService: ObjectsEditorService,\n                objectsRenderingService: ObjectsRenderingService,\n                filterExamples: !isDev,\n              })}\n              initialFileMetadataToOpen={initialFileMetadataToOpen}\n              initialExampleSlugToOpen={\n                appArguments['create-from-example'] || null\n              }\n            />\n          )}\n        </ProjectStorageProviders>\n      )}\n    </Providers>\n  );\n};\n"],"names":["findGDJS","require","optionalRequire","path","fs","module","exports","findJsExtensionModules","_ref","filterExamples","onFindGDJS","then","_ref2","gdjsRoot","extensionsRoot","join","console","info","concat","Promise","resolve","reject","readdir","error","extensionFolders","filteredExtensionFolders","filter","folder","indexOf","all","map","extensionFolder","extensionFolderPath","jsExtensionModulePath","stat","err","stats","isFile","modulePaths","modulePath","loadExtension","gd","objectsEditorService","objectsRenderingService","loadAllExtensions","_","extensionModulePaths","extensionModulePath","extensionModule","rethrowException","ex","result","message","rawError","registerEditorConfigurations","registerInstanceRenderers","registerClearCache","JsPlatform","get","results","expectedNumberOfJSExtensionModulesLoaded","copyAllEmbeddedResourcesToProjectFolder","_x","_x2","_copyAllEmbeddedResourcesToProjectFolder","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","project","filesWithEmbeddedResources","projectPath","copies","_iterator3","_step3","_step3$value","hasAnyEmbeddedResourceOutsideProjectFolder","embeddedResources","_iterator4","_step4","_loop","wrap","_context2","prev","next","abrupt","dirname","getProjectFile","_createForOfIteratorHelper","values","s","n","done","value","embedded","resourceBasename","fileExtension","fileNameWithoutExtension","newFileNameWithoutExtension","resourceNewPath","_context","isOutsideProjectFolder","basename","fullPath","extname","newNameGenerator","tentativeFileName","tentativePath","existsSync","resourceName","push","promises","copyFile","stop","delegateYield","t0","t1","e","f","finish","t2","createAndMapEmbeddedResources","_step","filesWithMappedResources","Map","_iterator","_step2","_step$value","_slicedToArray","filePath","mapping","_iterator2","_step2$value","resourceKind","relPath","relative","theEmbeddedResource","createNewResource","setName","setFile","has","mappedResources","setMetadata","JSON","stringify","embeddedResourcesMapping","delete","getResourcesManager","addResource","set","listTileMapEmbeddedResources","_x3","_x4","_listTileMapEmbeddedResources","_callee2","data","tileMap","dir","_iterator5","_step5","tileset","resource","_iterator6","_step6","level","_relPath","_fullPath","_isOutsideProjectFolder","_resource","_context3","readFile","sent","parse","__header__","app","defs","tilesets","isPathInProjectFolder","levels","bgRelPath","_listSpineEmbeddedResources","_callee3","atlasPath","atlasFileName","_context4","replace","access","constants","F_OK","catch","_listSpineTextureAtlasEmbeddedResources","_callee4","atlasContent","atlasImageRegex","imageDependencies","_iterator7","_step7","relatedImagePath","_context5","match","embeddedResourcesParsers","tilemap","json","spine","_x5","_x6","atlas","_x7","_x8","remote","dialog","ResourceStoreChooser","options","selectedResourceIndex","onSelectResource","resourcesKindSupportedByResourceStore","includes","_jsx","ResourceStore","localResourceSources","_toConsumableArray","allResourceKindsAndMetadata","kind","fileExtensions","displayName","selectLocalFileResources","_ref4","_ref3","i18n","getLastUsedPath","setLastUsedPath","resourcesImporationBehavior","properties","latestPath","browserWindow","_yield$dialog$showOpe","filePaths","lastUsedPath","hasFilesOutsideProjectFolder","parseEmbeddedResources","recursivelyParseEmbeddedResources","newToOldFilePaths","Error","multiSelection","getCurrentWindow","showOpenDialog","title","id","filters","name","extensions","defaultPath","length","some","_ref5","initialEmbeddedResources","initialEmbeddedResource","embeddedResourseParser","newDependentResources","Window","showConfirmDialog","copyAllToProjectFolder","newResource","filePathWithMapping","sourceName","displayTab","onlyForStorageProvider","shouldCreateResource","shouldGuessAnimationsFromName","selectResourcesHeadless","renderComponent","props","Line","justifyContent","children","RaisedButton","primary","label","Trans","onClick","selectedResources","fileMetadata","getStorageProvider","onChooseResources","selectedSourceName","_ref7","FileToCloudProjectResourceUploader","resources","automaticallyOpenInput","automaticallyOpenIfPossible","source","find","resourceSource","renderPrimaryAction","_ref8","DialogPrimaryButton","disabled","chosenResourceUrl","url","setOrigin","Boolean","_ref9","hideInResourceEditor","ProjectResourcesChooser","onResourcesSelected","_ref10","electron","ipcRenderer","openAndWaitForExternalEditorWindow","editorName","externalEditorInput","externalEditorOutput","invoke","downloadAndPrepareExternalEditorBase64Resources","resourceNames","urlsToDownload","filesToRead","resourcesManager","downloadedBlobs","resourcesToDataUrl","forEach","hasResource","getResource","getFile","isURL","isBlobURL","localFilePath","downloadUrlsToBlobs","urlContainers","onProgress","count","total","blob","item","convertBlobToDataURL","t3","dataUrl","call","t4","_ref6","content","toString","resourceData","editWithLocalExternalEditor","_callee5","externalEditorName","defaultName","metadataKey","resourceManagementProps","modifiedResources","singleFrame","extraOptions","externalEditorData","readMetadata","existingMetadata","fps","isLooping","sendExternalEditorOpened","saveBlobUrlsFromExternalEditorBase64Resources","baseNameForNewResources","onFetchNewlyAddedResources","freeBlobsAndUpdateMetadata","metadata","onNewResourcesAdded","patchExternalEditorMetadataWithResourcesNamesIfNecessary","getName","_ref11","originalIndex","newName","newMetadata","_defineProperty","editors","createDisplayName","editDisplayName","edit","_edit","_callee6","_context6","_edit2","_callee7","_context7","_edit3","_callee8","_context8","_x9","os","getUID","userInfo","uid","global","pathPosix","posix","LocalFileSystem","_createClass","_this","_classCallCheck","_filesToDownload","getAllUrlFilesIn","pathPrefix","normalizedPathPrefix","normalize","Object","keys","mkDir","mkdirsSync","dirExists","clearDir","emptyDirSync","getTempDir","tmpdir","fileNameFrom","_downloadUrlsToLocalFiles","dirNameFrom","makeAbsolute","filename","baseDirectory","isAbsolute","makeRelative","charAt","dest","copySync","code","existingDestToDownload","existingSourceToDownload","writeToFile","file","contents","outputFileSync","readFileSync","readDir","ext","toUpperCase","output","VectorString","readdirSync","push_back","fileExists","normalizedFilePath","statSync","this","downloadUrlsToLocalFiles","open","onExport","onClose","onRunPreviewLocally","isMobile","useResponsiveWindowSize","urlWithProtocol","_jsxs","Dialog","actions","FlatButton","secondaryActions","onRequestClose","maxWidth","Text","PlaceholderLoader","ShareLink","_Fragment","QrCode","size","debuggerServerState","debuggerServerAddress","callbacksList","debuggerIds","responseCallbacks","nextMessageWithResponseId","embeddedGameFrameWindow","isWindowMessageListenerRegistered","getExistingDebuggerIds","handleParsedMessage","parsedMessage","messageId","answerCallback","warn","onHandleParsedMessage","notifyConnectionClosed","onConnectionClosed","localPreviewDebuggerServer","LocalPreviewDebuggerServer","key","window","addEventListener","event","serverStartPromise","serverStartPromiseCompleted","removeAllListeners","on","onErrorReceived","debuggerIdIndex","splice","onConnectionOpened","errorMessage","onConnectionErrored","address","onServerStateChanged","send","serverStartTimeoutPromise","setTimeout","race","postMessage","sendMessage","_objectSpread","callbacks","callbacksIndex","embeddedWindow","_ref12","previousDebuggerIds","clear","prepareExporter","isForInGameEdition","_yield$findGDJS","localFileSystem","fileSystem","outputDir","exporter","assignIn","AbstractFileSystemJS","Exporter","LocalPreviewLauncher","_React$Component","_inherits","_super","_createSuper","_len","args","Array","_key","canDoNetworkPreview","state","networkPreviewDialogOpen","networkPreviewHost","networkPreviewPort","networkPreviewError","previewGamePath","previewBrowserWindowOptions","hotReloadsCount","hideMenuBar","alwaysOnTop","numberOfWindows","captureOptions","_networkPreviewSubscriptionChecker","_hotReloadSubscriptionChecker","_openPreviewBrowserWindow","_this$state","previewGameIndexHtmlPath","onCaptureFinished","closePreview","windowId","closeAllPreviews","previewDebuggerServer","getPreviewDebuggerServer","closeAllConnections","_openPreviewWindow","gamePath","setState","width","getGameResolutionWidth","height","getGameResolutionHeight","useContentSize","backgroundColor","webPreferences","webSecurity","nodeIntegration","contextIsolation","getIsMenuBarHiddenInPreview","getIsAlwaysOnTopInPreview","networkPreview","serverParams","port","_checkSubscriptionForNetworkPreview","ipAddress","root","launchPreview","previewOptions","sceneName","externalLayoutName","eventsBasedObjectType","eventsBasedObjectVariantName","_yield$prepareExporte","previewStartTime","previewExportOptions","previewDebuggerServerAddress","includeFileHashs","includeFile","hash","shouldHotReload","projectDataElement","projectData","runtimeGameOptionsElement","runtimeGameOptions","previewStopTime","startServer","performance","now","PreviewExportOptions","setIsDevelopmentEnvironment","isDev","setLayoutName","setIsInGameEdition","setEditorId","editorId","setExternalLayoutName","setEventsBasedObjectType","setEventsBasedObjectVariantName","useWindowMessageDebuggerClient","useWebsocketDebuggerClientWithServerAddress","getIncludeFileHashs","setIncludeFileHash","setElectronRemoteRequirePath","hotReload","setShouldClearExportFolder","shouldHardReload","setShouldReloadProjectData","setShouldReloadLibraries","shouldReloadLibraries","shouldGenerateScenesEventsCode","setShouldGenerateScenesEventsCode","setFullLoadingScreen","fullLoadingScreen","setGDevelopVersionWithHash","getIDEVersionWithHash","setCrashReportUploadLevel","crashReportUploadLevel","setPreviewContext","previewContext","setProjectTemplateSlug","getTemplateSlug","setSourceGameId","sourceGameId","inAppTutorialMessageInPreview","setInAppTutorialMessageInPreview","inAppTutorialMessagePositionInPreview","fallbackAuthor","setFallbackAuthor","username","authenticatedPlayer","setAuthenticatedPlayer","playerId","playerUsername","playerToken","screenshots","screenshot","addScreenshotCapture","delayTimeInSeconds","signedUrl","publicUrl","editorCameraState3D","setEditorCameraState3D","cameraMode","positionX","positionY","positionZ","rotationAngle","elevationAngle","distance","inGameEditorSettings","setInGameEditorSettingsJson","exportProjectForPixiPreview","SerializerElement","serializeProjectData","Serializer","toJSON","serializeRuntimeGameOptions","debuggerId","command","payload","shouldReloadResources","checkUserHasSubscription","setEmbeddedGameFramePreviewLocation","previewIndexHtmlLocation","_this2","_this$state2","React","SubscriptionChecker","ref","subscriptionChecker","onChangeSubscription","placementId","mode","isNotShownDuringInAppTutorial","LocalNetworkPreviewDialog","shell","exportPipelineName","localCordovaExportPipeline","packageNameWarningType","getInitialExportState","getLastCompilationDirectory","canLaunchBuild","exportState","isNavigationDisabled","renderHeader","updateExportState","exportStep","Column","noMargin","ExplanationHeader","LocalFolderPicker","type","onChange","setLastCompilationDirectory","fullWidth","renderExportFlow","ExportFlow","context","launchExport","_launchExport","exportOptions","ExportOptions","setTarget","exportWholePixiProject","urlFiles","launchResourcesDownload","_launchResourcesDownload","updateStepProgress","throwIfAnyError","launchCompression","exportOutput","renderDoneFooter","openExportFolder","openPath","DoneFooter","renderGameButton","localElectronExportPipeline","expand","localHTML5ExportPipeline","renderTutorial","DismissableTutorialMessage","tutorialId","styles","container","position","display","alignItems","button","marginLeft","textField","flex","onChooseFolder","_yield$dialog$showSav","showSaveDialog","style","undefined","TextField","margin","translatableHintText","optionalLazyRequire","moduleName","moduleLoaded","lazyRequireArchiver","archiveLocalFolder","outputFilename","sizeLimit","archiver","createWriteStream","archive","zlib","fileSize","pointer","log","roundFileSizeInMb","Math","round","pipe","directory","finalize","localFacebookInstantGamesExportPipeline","archiveOutputFilename","getPath","LocalFilePicker","temporaryOutputDir","uploadLocalFile","uploadOptions","stepCurrentProgress","stepMaxProgress","localOnlineCordovaExportPipeline","onlineBuildType","limitedBuilds","targets","keystore","signingDialogOpen","errored","SetupExportHeader","shouldSuggestBumpingVersionNumber","archiveOutputDir","launchUpload","outputFile","getBuildFileUploadOptions","launchOnlineBuild","authenticatedUser","uploadBucketKey","gameId","payWithCredits","getAuthorizationHeader","firebaseUser","buildCordovaAndroid","localOnlineCordovaIosExportPipeline","signing","profile","buildCordovaIos","localOnlineElectronExportPipeline","buildElectron","localOnlineWebExportPipeline","uiMode","OnlineWebExportFlow","buildWeb","localOnlineWebExporter","onlineWebExporter","exportPipeline","localAutomatedExporters","html5Exporter","onlineCordovaExporter","onlineCordovaIosExporter","onlineElectronExporter","facebookInstantGamesExporter","localManualExporters","cordovaExporter","electronExporter","useIPCEventListener","ipcEvent","callback","shouldApply","handler","eventArgs","removeListener","useAppEventListener","_len2","_key2","isMainWindow","windowTitle","lowercaseTitle","toLowerCase","startsWith","extraCallbacks","canSaveProjectAs","recentProjectFiles","shortcutMap","isApplicationTopLevelMenu","onClosePreview","language","_React$useState","_React$useState2","isFocusedOnMainWindow","setIsFocusedOnMainWindow","_React$useState3","_React$useState4","focusedWindowId","setFocusedWindowId","closePreviewWindow","useShortcutToClosePreviewWindow","PreferencesContext","limits","AuthenticatedUserContext","hideAskAi","capabilities","classrooms","onChooseProject","onOpenRecentFile","onSaveProject","onSaveProjectAs","onShowVersionHistory","onCloseProject","onCloseApp","onExportProject","onInviteCollaborators","onCreateProject","onOpenProjectManager","onOpenHomePage","onOpenDebugger","onOpenAbout","onOpenPreferences","onOpenLanguage","onOpenProfile","onOpenAskAi","setElectronUpdateStatus","buildMainMenuDeclarativeTemplate","useCommandWithOptions","generateOptions","text","fileIdentifier","makeLocalEventsFunctionCodeWriter","onWriteFile","mkdir","getPathFor","codeNamespace","slugs","getIncludeFileFor","writeFunctionCode","functionCodeNamespace","writeFile","writeBehaviorCode","behaviorCodeNamespace","writeObjectCode","objectCodeNamespace","LocalEventsFunctionsExtensionWriter","chooseEventsFunctionExtensionFile","extensionName","writeSerializedObject","serializedObject","filepath","object","ensureDir","stringifyException","writeJSONFile","LocalEventsFunctionsExtensionOpener","openFilesPicker","readEventsFunctionExtensionFile","readJSONFile","unsplit","isReferenceMagicPropertyName","getReferencePartialObject","maxUnsplitDepth","unsplitObject","currentObject","depth","indexOrPropertyName","reference","isReference","referenceTo","partialObject","getSlugifiedUniqueNameFromProperty","propertyName","existingNamesForReference","currentReference","property","onOpenWithPicker","openFilePicker","onOpen","referencePath","getAutoSaveCreationDate","compareLastModified","autoSavePath","autoSavedTime","saveTime","mtime","getTime","onGetAutoSave","splittedProjectFolderNames","deleteExistingFilesFromDirs","isFolderProject","entry","dirPath","isDirectory","fileToRemovePath","unlinkSync","checkFileContent","expectedContent","time","encoding","verificationTime","toFixed","writeAndCheckFile","writeAndCheckFormattedJSONFile","writeProjectFiles","paths","serializedProjectObject","serializeToJSObject","partialObjects","pathSeparator","getArrayItemReferenceName","shouldSplit","createReference","splitObject","currentPath","isArray","index","itemPath","itemReference","propertyPath","propertyReference","split","Set","folderName","newFileMetadata","Date","getProjectUuid","lastModifiedDate","wasSaved","generateOnChooseSaveProjectAsLocation","setDialog","closeDialog","displayOptionToGenerateNewProjectUuid","safeFilename","saveDialogOptions","SaveAsOptionsDialog","onCancel","nameSuggestion","mainActionLabel","onSave","saveAsLocation","saveAsOptions","showSaveDialogSync","generateNewProjectUuid","onStartSaving","onMoveResources","setProjectFile","_x10","onAutoSaveProject","serializeToJSON","getWriteErrorMessage","forbiddenCharacterRegex","consecutiveSpacesRegex","getProjectLocation","projectName","newProjectsDefaultFolder","outputPath","projectFileName","substring","trim","cleanUpProjectFileName","isTryingToSaveInForbiddenPath","exePath","gdevelopDirectory","lazyRequireGlob","scanForNewResources","createResource","glob","allExtensions","allFiles","filesToCheck","filePathsNotInResources","extension","files","findFilesNotInResources","mapVector","relativeFilePath","applyResourceDefaults","setupResourcesWatcher","debouncedCallback","memoize","debounce","relativePath","folderPath","identifier","leading","trailing","getMemoizedFunc","obj","gameFile","autosaveFile","ignore","sep","isProjectSplitInMultipleFiles","subscriptionIdPromise","subscriptionId","internalName","renderIcon","Computer","fontSize","getFileMetadataFromAppArguments","appArguments","POSITIONAL_ARGUMENTS_KEY","renderNewProjectSaveAsLocationChooser","setSaveAsLocation","projectLocation","newOutputPath","newOutputFileIdentifier","createOperations","onChooseSaveProjectAsLocation","getOpenErrorMessage","canFileMetadataBeSafelySaved","_canFileMetadataBeSafelySaved","showAlert","canFileMetadataBeSafelySavedAs","_canFileMetadataBeSafelySavedAs","createResourceOperations","updateInterface","cleanUserSelectionOfResources","informUser","click","resourceFilePath","getLocalResourceFullPath","showItemInFolder","locateResourceFile","openResourceFile","clipboard","writeText","copyResourceFilePath","submenu","_click","getAllResourceNames","toJSArray","getResourceFilePathStatus","removeResource","removeAllResourcesWithInvalidPath","LocalGDJSDevelopmentWatcher","onGDJSUpdated","shouldWatch","useGDJSDevelopmentWatcher","generateUnusedFilepath","basePath","alreadyUsedFilePaths","filenameWithoutExtension","downloadBlobToLocalFile","blobUrl","response","arrayBuffer","axios","responseType","moveUrlResourcesToLocalFiles","allResourceNames","resourcesToFetchNames","tokenForPrivateGameTemplateAuthorization","baseAssetsPath","downloadedFilePaths","erroredResources","fetchedResourcesCount","resourceFile","fetchTokenForPrivateGameTemplateAuthorizationIfNeeded","allResourcePaths","PromisePool","for","process","_parseLocalFilePathOr","downloadedFilePath","_downloadedFilePath","parseLocalFilePathOrExtensionFromMetadata","sanitizeFilename","isProductAuthorizedResourceUrl","extractDecodedFilenameWithExtensionFromProductAuthorizedUrl","isPublicAssetResourceUrl","extractDecodedFilenameWithExtensionFromPublicAssetResourceUrl","extractDecodedFilenameFromProjectResourceUrl","add","retryIfFailed","times","resourceUrl","encodedUrl","URL","isPrivateGameTemplateResourceAuthorizedUrl","href","searchParams","processByChunk","array","transformItem","isChunkTooBig","processChunk","currentItemIndex","nextChunk","mappedItem","readLocalFileToArrayBuffer","buffer","slice","byteOffset","byteLength","extensionToMimeType","aac","wav","mp3","ogg","png","jpg","jpeg","webp","ttf","otf","mp4","webm","xml","gz","js","readLocalFileToFile","extensionWithoutLeadingDot","File","moveAllLocalResourcesToCloudResources","oldFileMetadata","newCloudProjectId","allResourcesToUpload","alreadyDoneCount","checkIfIsGDevelopCloudBucketUrl","getResourcesToUpload","_transformItem","resourceAbsolutePath","resourceAndFilesChunk","reduce","_processChunk","resourceAndFilesToUpload","uploadedProjectResourceFiles","getCredentialsForCloudProject","uploadProjectResourceFiles","movers","_movers","LocalFileStorageProvider","_2","ProjectResourcesCopier","copyAllResourcesTo","CloudStorageProvider","UrlStorageProvider","moveUrlResourcesToCloudProject","LocalResourceMover","moveAllProjectResources","_moveAllProjectResources","oldStorageProvider","newStorageProvider","mover","fetchers","_fetchers","moveUrlResourcesToCloudFilesIfPrivate","fetchRelativeResourcesToFullUrls","LocalResourceFetcher","fetchAllProjectResources","_fetchAllProjectResources","storageProvider","fetcher","LocalLoginProvider","auth","_loginWithEmailAndPassword","email","password","signInWithEmailAndPassword","_loginOrSignupWithProvider","provider","signal","promise","aborted","UserCancellationError","terminateWebSocket","setupAuthenticationWebSocket","onConnectionEstablished","connectionId","openExternalURL","onTokenReceived","_onTokenReceived","credential","GoogleAuthProvider","GithubAuthProvider","accessToken","OAuthProvider","idToken","id_token","nonce","raw_nonce","signInWithCredential","onError","onTimeout","create","authentication","setUpContextMenu","loginProvider","setLoginProvider","getArguments","Providers","disableCheckForUpdates","makeEventsFunctionCodeWriter","eventsFunctionsExtensionWriter","eventsFunctionsExtensionOpener","ProjectStorageProviders","storageProviders","defaultStorageProvider","getStorageProviderOperations","getStorageProviderResourceOperations","initialFileMetadataToOpen","MainFrame","renderMainMenu","ElectronMainMenu","renderPreviewLauncher","renderShareDialog","ShareDialog","isSavingProject","automatedExporters","manualExporters","initialTab","gamesList","quickPublishOnlineWebExporter","renderGDJSDevelopmentWatcher","resourceMover","resourceFetcher","resourceSources","resourceExternalEditors","localResourceExternalEditors","extensionsLoader","makeExtensionsLoader","ObjectsEditorService","ObjectsRenderingService","initialExampleSlugToOpen"],"sourceRoot":""}